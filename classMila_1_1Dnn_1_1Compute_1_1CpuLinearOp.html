<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mila: Mila::Dnn::Compute::CpuLinearOp Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mila
   </div>
   <div id="projectbrief">Deep Neural Network Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Mila::Dnn::Compute::CpuLinearOp Class Reference<span class="mlabels"><span class="mlabel">export</span></span><div class="ingroups">module <a class="el" href="module_Compute_8CpuLinearOp.html">Compute.CpuLinearOp</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>CPU implementation of the Fully Connected operation for neural networks.  
 <a href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for Mila::Dnn::Compute::CpuLinearOp:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp__inherit__graph.png" border="0" usemap="#aMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_inherit__map" alt="Inheritance graph"/></div>
<map name="aMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_inherit__map" id="aMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_inherit__map">
<area shape="rect" title="CPU implementation of the Fully Connected operation for neural networks." alt="" coords="44,211,195,251"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html" title=" " alt="" coords="8,108,231,163"/>
<area shape="poly" title=" " alt="" coords="122,176,122,211,117,211,117,176"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html" title="Base class for all compute operations in the Mila neural network framework." alt="" coords="5,5,233,60"/>
<area shape="poly" title=" " alt="" coords="122,74,122,108,117,108,117,74"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Mila::Dnn::Compute::CpuLinearOp:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp__coll__graph.png" border="0" usemap="#aMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_coll__map" alt="Collaboration graph"/></div>
<map name="aMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_coll__map" id="aMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_coll__map">
<area shape="rect" title="CPU implementation of the Fully Connected operation for neural networks." alt="" coords="604,45,755,85"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html" title=" " alt="" coords="283,5,505,60"/>
<area shape="poly" title=" " alt="" coords="519,44,604,54,604,59,518,49"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html" title="Base class for all compute operations in the Mila neural network framework." alt="" coords="5,5,233,60"/>
<area shape="poly" title=" " alt="" coords="247,30,283,30,283,35,247,35"/>
<area shape="rect" href="classMila_1_1Dnn_1_1LinearConfig.html" title="Configuration class for Linear module." alt="" coords="307,84,481,109"/>
<area shape="poly" title=" " alt="" coords="494,83,603,70,604,76,495,88"/>
<area shape="rect" href="classMila_1_1Dnn_1_1ComponentConfig.html" title="Base configuration class for all neural network components." alt="" coords="15,84,223,109"/>
<area shape="poly" title=" " alt="" coords="237,94,307,94,307,99,237,99"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ab7082f149acdd91d6f60a2c01d28a939" id="r_ab7082f149acdd91d6f60a2c01d28a939"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> = typename <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuDevice.html#a3cabd4703fa67c537525787f84d14d9b">CpuDevice::MR</a></td></tr>
<tr class="separator:ab7082f149acdd91d6f60a2c01d28a939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1b349a0051c002338a1333dd20250e0" id="r_ab1b349a0051c002338a1333dd20250e0"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab1b349a0051c002338a1333dd20250e0">OperationBase</a> = <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html">UnaryOperation</a>&lt; <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4a54c82ef76ecbbd4c2293e09bae01b54e">DeviceType::Cpu</a>, float &gt;</td></tr>
<tr class="separator:ab1b349a0051c002338a1333dd20250e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_types_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html">Mila::Dnn::Compute::UnaryOperation&lt; DeviceType::Cpu, float &gt;</a></td></tr>
<tr class="memitem:a29cec114d4190ca3c40dd936c7b43f48 inherit pub_types_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation" id="r_a29cec114d4190ca3c40dd936c7b43f48"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> = std::conditional_t&lt; TDeviceType==DeviceType::Cuda, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaMemoryResource.html">CudaMemoryResource</a>, <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a8c32f3f7cc6e4ef70be850a0cf5b9a62">HostMemoryResource</a> &gt;</td></tr>
<tr class="memdesc:a29cec114d4190ca3c40dd936c7b43f48 inherit pub_types_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory resource type based on device type.  <br /></td></tr>
<tr class="separator:a29cec114d4190ca3c40dd936c7b43f48 inherit pub_types_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3b6c3cbe07c0f82513b02e0f5bed70d7" id="r_a3b6c3cbe07c0f82513b02e0f5bed70d7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#a3b6c3cbe07c0f82513b02e0f5bed70d7">CpuLinearOp</a> (const <a class="el" href="classMila_1_1Dnn_1_1LinearConfig.html">LinearConfig</a> &amp;config)</td></tr>
<tr class="memdesc:a3b6c3cbe07c0f82513b02e0f5bed70d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new CPU Fully Connected operation with the default device context.  <br /></td></tr>
<tr class="separator:a3b6c3cbe07c0f82513b02e0f5bed70d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc58b4cc66b3b96a039878255aad3e7c" id="r_acc58b4cc66b3b96a039878255aad3e7c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#acc58b4cc66b3b96a039878255aad3e7c">CpuLinearOp</a> (std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt; context, const <a class="el" href="classMila_1_1Dnn_1_1LinearConfig.html">LinearConfig</a> &amp;config)</td></tr>
<tr class="memdesc:acc58b4cc66b3b96a039878255aad3e7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new CPU Fully Connected operation with a specific device context.  <br /></td></tr>
<tr class="separator:acc58b4cc66b3b96a039878255aad3e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946db14f1b05d8ff3429fbb812a3d095" id="r_a946db14f1b05d8ff3429fbb812a3d095"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#a946db14f1b05d8ff3429fbb812a3d095">backward</a> (<a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;input_grad, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &gt; &gt; &amp;parameter_grads, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;output_grad, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; input, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; weight, int B, int T, int C, int OC)</td></tr>
<tr class="memdesc:a946db14f1b05d8ff3429fbb812a3d095"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the backward pass of the Fully Connected operation.  <br /></td></tr>
<tr class="separator:a946db14f1b05d8ff3429fbb812a3d095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af867c7dd9729b6333f475d409b9979dc" id="r_af867c7dd9729b6333f475d409b9979dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#af867c7dd9729b6333f475d409b9979dc">forward</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;input, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &gt; &gt; &amp;parameters, const <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html">OperationAttributes</a> &amp;properties, <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;output, std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &gt; &gt; &amp;output_state) const override</td></tr>
<tr class="memdesc:af867c7dd9729b6333f475d409b9979dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the forward pass of the <a class="el" href="classMila_1_1Dnn_1_1Linear.html" title="A class representing a linear transformation module.">Linear</a> operation.  <br /></td></tr>
<tr class="separator:af867c7dd9729b6333f475d409b9979dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7fcd04710901c0f75e4699302b81f2d" id="r_ad7fcd04710901c0f75e4699302b81f2d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ad7fcd04710901c0f75e4699302b81f2d">getName</a> () const override</td></tr>
<tr class="memdesc:ad7fcd04710901c0f75e4699302b81f2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the name of this operation.  <br /></td></tr>
<tr class="separator:ad7fcd04710901c0f75e4699302b81f2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html">Mila::Dnn::Compute::UnaryOperation&lt; DeviceType::Cpu, float &gt;</a></td></tr>
<tr class="memitem:a797829b04561c6fce3cdedc20a149774 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation" id="r_a797829b04561c6fce3cdedc20a149774"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a797829b04561c6fce3cdedc20a149774">UnaryOperation</a> (<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a> operation_type)</td></tr>
<tr class="memdesc:a797829b04561c6fce3cdedc20a149774 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html" title="Abstract base class for unary operations in the compute framework.">UnaryOperation</a> with the specified operation type.  <br /></td></tr>
<tr class="separator:a797829b04561c6fce3cdedc20a149774 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70d91c0514aff7c524796bbe1079c066 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation" id="r_a70d91c0514aff7c524796bbe1079c066"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a70d91c0514aff7c524796bbe1079c066">UnaryOperation</a> (<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a> operation_type, std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt; context)</td></tr>
<tr class="memdesc:a70d91c0514aff7c524796bbe1079c066 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html" title="Abstract base class for unary operations in the compute framework.">UnaryOperation</a> with the specified operation type and device context.  <br /></td></tr>
<tr class="separator:a70d91c0514aff7c524796bbe1079c066 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a513e471701cdbb0513bbb8d90ebda077 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation" id="r_a513e471701cdbb0513bbb8d90ebda077"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a513e471701cdbb0513bbb8d90ebda077">~UnaryOperation</a> ()=default</td></tr>
<tr class="memdesc:a513e471701cdbb0513bbb8d90ebda077 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor for proper cleanup of derived classes.  <br /></td></tr>
<tr class="separator:a513e471701cdbb0513bbb8d90ebda077 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a039beab0eb7c7812b61f81de72b31a31 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation" id="r_a039beab0eb7c7812b61f81de72b31a31"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a039beab0eb7c7812b61f81de72b31a31">backward</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &amp;grad, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &gt; &gt; &amp;parameters, std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &gt; &gt; &amp;output_grads) const</td></tr>
<tr class="memdesc:a039beab0eb7c7812b61f81de72b31a31 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the backward pass of a unary operation.  <br /></td></tr>
<tr class="separator:a039beab0eb7c7812b61f81de72b31a31 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afab87c226cf9d0bd983b8f9359730b65 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation" id="r_afab87c226cf9d0bd983b8f9359730b65"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#afab87c226cf9d0bd983b8f9359730b65">backward</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &amp;input, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &amp;output_grad, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &gt; &gt; &amp;parameters, std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &gt; &gt; &amp;parameter_grads, <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &amp;input_grad, const <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html">OperationAttributes</a> &amp;properties, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &gt; &gt; &amp;output_state) const</td></tr>
<tr class="memdesc:afab87c226cf9d0bd983b8f9359730b65 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the comprehensive backward pass of a unary operation.  <br /></td></tr>
<tr class="separator:afab87c226cf9d0bd983b8f9359730b65 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a275d5ff59b9c865a0e9bef26deabb058 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation" id="r_a275d5ff59b9c865a0e9bef26deabb058"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a275d5ff59b9c865a0e9bef26deabb058">forward</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &amp;input, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &gt; &gt; &amp;parameters, const <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html">OperationAttributes</a> &amp;properties, <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &amp;output, std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html#a29cec114d4190ca3c40dd936c7b43f48">MR</a> &gt; &gt; &gt; &amp;output_state) const=0</td></tr>
<tr class="memdesc:a275d5ff59b9c865a0e9bef26deabb058 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the forward pass of a unary operation.  <br /></td></tr>
<tr class="separator:a275d5ff59b9c865a0e9bef26deabb058 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1UnaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html">Mila::Dnn::Compute::OperationBase&lt; TDeviceType, TInput1, TInput2, TOutput &gt;</a></td></tr>
<tr class="memitem:aa04b0c9dbbb8618926b38f9f72866f9c inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase" id="r_aa04b0c9dbbb8618926b38f9f72866f9c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#aa04b0c9dbbb8618926b38f9f72866f9c">OperationBase</a> (<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a> operation_type, std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt; context)</td></tr>
<tr class="memdesc:aa04b0c9dbbb8618926b38f9f72866f9c inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs an <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html" title="Base class for all compute operations in the Mila neural network framework.">OperationBase</a> object with a specific device context and compute precision.  <br /></td></tr>
<tr class="separator:aa04b0c9dbbb8618926b38f9f72866f9c inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c5dc486a89b9f74303c7c5314e014c8 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase" id="r_a3c5dc486a89b9f74303c7c5314e014c8"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a3c5dc486a89b9f74303c7c5314e014c8">~OperationBase</a> ()=default</td></tr>
<tr class="memdesc:a3c5dc486a89b9f74303c7c5314e014c8 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor for the <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html" title="Base class for all compute operations in the Mila neural network framework.">OperationBase</a> class.  <br /></td></tr>
<tr class="separator:a3c5dc486a89b9f74303c7c5314e014c8 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89f65f9750a87e52fdc8f8095f18ba9a inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase" id="r_a89f65f9750a87e52fdc8f8095f18ba9a"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a89f65f9750a87e52fdc8f8095f18ba9a">getDeviceContext</a> () const</td></tr>
<tr class="memdesc:a89f65f9750a87e52fdc8f8095f18ba9a inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the device context associated with this operation.  <br /></td></tr>
<tr class="separator:a89f65f9750a87e52fdc8f8095f18ba9a inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14eb1f77c85ff4fc2f53300500d65185 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase" id="r_a14eb1f77c85ff4fc2f53300500d65185"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a14eb1f77c85ff4fc2f53300500d65185">getDeviceType</a> () const</td></tr>
<tr class="memdesc:a14eb1f77c85ff4fc2f53300500d65185 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the device type for this operation.  <br /></td></tr>
<tr class="separator:a14eb1f77c85ff4fc2f53300500d65185 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb4008133679e313261a2096af05499 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase" id="r_a9fb4008133679e313261a2096af05499"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a9fb4008133679e313261a2096af05499">getOperationType</a> () const</td></tr>
<tr class="memdesc:a9fb4008133679e313261a2096af05499 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the operation type enumeration value.  <br /></td></tr>
<tr class="separator:a9fb4008133679e313261a2096af05499 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a91636f5dd01a394a908870378462bc46" id="r_a91636f5dd01a394a908870378462bc46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#a91636f5dd01a394a908870378462bc46">forward_naive</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;input, const std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &gt; &amp;weight, const std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &gt; &amp;bias, <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;output, int outer_size, int C, int OC) const</td></tr>
<tr class="memdesc:a91636f5dd01a394a908870378462bc46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Naive implementation of the forward pass for the Fully Connected operation.  <br /></td></tr>
<tr class="separator:a91636f5dd01a394a908870378462bc46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a24070f3216f451150a6b7f9177b38bc3" id="r_a24070f3216f451150a6b7f9177b38bc3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMila_1_1Dnn_1_1LinearConfig.html">LinearConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#a24070f3216f451150a6b7f9177b38bc3">config_</a></td></tr>
<tr class="memdesc:a24070f3216f451150a6b7f9177b38bc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration for the linear operation.  <br /></td></tr>
<tr class="separator:a24070f3216f451150a6b7f9177b38bc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>CPU implementation of the Fully Connected operation for neural networks. </p>
<p>This class provides a CPU-based implementation of the Fully Connected operation, which performs a matrix multiplication between the input and a weight matrix, optionally adds a bias, and produces an output. This operation implements the standard linear layer commonly used in neural networks.</p>
<p>The implementation includes both a performance-optimized version with loop unrolling and a naive fallback implementation for special cases.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">float</td><td>The data type of the input tensor elements. </td></tr>
    <tr><td class="paramname">TDataType</td><td>The data type used for computation and output (defaults to the input type). </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="ab7082f149acdd91d6f60a2c01d28a939" name="ab7082f149acdd91d6f60a2c01d28a939"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7082f149acdd91d6f60a2c01d28a939">&#9670;&#160;</a></span>MR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">Mila::Dnn::Compute::CpuLinearOp::MR</a> =  typename <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuDevice.html#a3cabd4703fa67c537525787f84d14d9b">CpuDevice::MR</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab1b349a0051c002338a1333dd20250e0" name="ab1b349a0051c002338a1333dd20250e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1b349a0051c002338a1333dd20250e0">&#9670;&#160;</a></span>OperationBase</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab1b349a0051c002338a1333dd20250e0">Mila::Dnn::Compute::CpuLinearOp::OperationBase</a> =  <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html">UnaryOperation</a>&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4a54c82ef76ecbbd4c2293e09bae01b54e">DeviceType::Cpu</a>, float&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3b6c3cbe07c0f82513b02e0f5bed70d7" name="a3b6c3cbe07c0f82513b02e0f5bed70d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b6c3cbe07c0f82513b02e0f5bed70d7">&#9670;&#160;</a></span>CpuLinearOp() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Compute::CpuLinearOp::CpuLinearOp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1LinearConfig.html">LinearConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new CPU Fully Connected operation with the default device context. </p>
<p>CPU operations always use full precision regardless of policy settings.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">precision_policy</td><td>Ignored for CPU operations, as they always use full precision. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acc58b4cc66b3b96a039878255aad3e7c" name="acc58b4cc66b3b96a039878255aad3e7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc58b4cc66b3b96a039878255aad3e7c">&#9670;&#160;</a></span>CpuLinearOp() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Compute::CpuLinearOp::CpuLinearOp </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1LinearConfig.html">LinearConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new CPU Fully Connected operation with a specific device context. </p>
<p>CPU operations always use full precision regardless of policy settings.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>The device context to use for this operation. </td></tr>
    <tr><td class="paramname">precision_policy</td><td>Ignored for CPU operations, as they always use full precision. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If the context is not for a CPU device. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a946db14f1b05d8ff3429fbb812a3d095" name="a946db14f1b05d8ff3429fbb812a3d095"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a946db14f1b05d8ff3429fbb812a3d095">&#9670;&#160;</a></span>backward()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::CpuLinearOp::backward </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input_grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameter_grads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output_grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt;&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>OC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the backward pass of the Fully Connected operation. </p>
<p>Computes gradients with respect to inputs, weights, and biases based on the output gradient.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dinp</td><td>Pointer to the gradient buffer for input. </td></tr>
    <tr><td class="paramname">dweight</td><td>Pointer to the gradient buffer for weight parameters. </td></tr>
    <tr><td class="paramname">dbias</td><td>Pointer to the gradient buffer for bias parameters (can be NULL if no bias is used). </td></tr>
    <tr><td class="paramname">dout</td><td>Pointer to the gradient buffer from the output. </td></tr>
    <tr><td class="paramname">inp</td><td>Pointer to the original input values. </td></tr>
    <tr><td class="paramname">weight</td><td>Pointer to the weight parameters. </td></tr>
    <tr><td class="paramname">B</td><td>Batch size. </td></tr>
    <tr><td class="paramname">TDataType</td><td>Sequence length. </td></tr>
    <tr><td class="paramname">C</td><td>Input feature dimension. </td></tr>
    <tr><td class="paramname">OC</td><td>Output feature dimension. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a946db14f1b05d8ff3429fbb812a3d095_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a946db14f1b05d8ff3429fbb812a3d095_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a946db14f1b05d8ff3429fbb812a3d095_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a946db14f1b05d8ff3429fbb812a3d095_cgraph">
<area shape="rect" title="Performs the backward pass of the Fully Connected operation." alt="" coords="5,49,189,89"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a89f65f9750a87e52fdc8f8095f18ba9a" title="Gets the device context associated with this operation." alt="" coords="253,5,453,60"/>
<area shape="poly" title=" " alt="" coords="189,53,239,46,239,51,190,58"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a14eb1f77c85ff4fc2f53300500d65185" title="Gets the device type for this operation." alt="" coords="237,85,468,125"/>
<area shape="poly" title=" " alt="" coords="190,79,224,84,223,89,189,84"/>
</map>
</div>

</div>
</div>
<a id="af867c7dd9729b6333f475d409b9979dc" name="af867c7dd9729b6333f475d409b9979dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af867c7dd9729b6333f475d409b9979dc">&#9670;&#160;</a></span>forward()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::CpuLinearOp::forward </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html">OperationAttributes</a> &amp;&#160;</td>
          <td class="paramname"><em>properties</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>output_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the forward pass of the <a class="el" href="classMila_1_1Dnn_1_1Linear.html" title="A class representing a linear transformation module.">Linear</a> operation. </p>
<p>Computes the matrix multiplication between input and weights, adds bias if provided, and stores the result in the output tensor. Uses loop unrolling for performance optimization when possible, otherwise falls back to a naive implementation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Input tensor of shape [B, TDataType, C] where B is batch size, TDataType is sequence length, and C is input feature dimension. </td></tr>
    <tr><td class="paramname">parameters</td><td>Vector of parameter tensors [weight, bias] where weight is of shape [OC, C] and bias (optional) is of shape [OC]. </td></tr>
    <tr><td class="paramname">properties</td><td>Additional attributes for the operation. </td></tr>
    <tr><td class="paramname">output</td><td>Output tensor of shape [B, TDataType, OC] where OC is output feature dimension. </td></tr>
    <tr><td class="paramname">output_state</td><td>Cache for intermediate results (not used in this operation). </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_af867c7dd9729b6333f475d409b9979dc_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_af867c7dd9729b6333f475d409b9979dc_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_af867c7dd9729b6333f475d409b9979dc_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_af867c7dd9729b6333f475d409b9979dc_cgraph">
<area shape="rect" title="Performs the forward pass of the Linear operation." alt="" coords="5,164,176,204"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#a91636f5dd01a394a908870378462bc46" title="Naive implementation of the forward pass for the Fully Connected operation." alt="" coords="232,5,447,45"/>
<area shape="poly" title=" " alt="" coords="107,162,156,112,188,85,223,62,250,48,252,53,225,66,191,90,160,116,111,166"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html#a4f707ea4c0f00aab58189071fa1c11fd" title="Gets a raw pointer to the tensor data for use in CUDA kernels." alt="" coords="503,35,645,75"/>
<area shape="poly" title=" " alt="" coords="118,162,166,132,223,106,291,86,362,71,489,56,489,61,363,77,293,91,225,110,168,137,121,166"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a89f65f9750a87e52fdc8f8095f18ba9a" title="Gets the device context associated with this operation." alt="" coords="239,121,439,175"/>
<area shape="poly" title=" " alt="" coords="176,169,225,162,226,167,177,174"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a14eb1f77c85ff4fc2f53300500d65185" title="Gets the device type for this operation." alt="" coords="224,200,455,240"/>
<area shape="poly" title=" " alt="" coords="177,194,211,199,210,204,176,199"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html#a6a75cbf90898bc3d40a01121b3bb8921" title=" " alt="" coords="254,265,425,290"/>
<area shape="poly" title=" " alt="" coords="126,202,172,227,225,249,255,259,253,264,223,255,170,231,124,206"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html#a294130f763b905cf0125c9bd4fba4970" title=" " alt="" coords="268,315,411,355"/>
<area shape="poly" title=" " alt="" coords="111,202,160,251,191,277,225,299,256,313,254,318,223,304,188,281,156,255,107,206"/>
<area shape="poly" title=" " alt="" coords="447,36,489,41,489,47,446,41"/>
</map>
</div>

</div>
</div>
<a id="a91636f5dd01a394a908870378462bc46" name="a91636f5dd01a394a908870378462bc46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91636f5dd01a394a908870378462bc46">&#9670;&#160;</a></span>forward_naive()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::CpuLinearOp::forward_naive </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; float, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#ab7082f149acdd91d6f60a2c01d28a939">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outer_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>OC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Naive implementation of the forward pass for the Fully Connected operation. </p>
<p>This is a simple implementation without optimizations that serves as a fallback for cases where the optimized implementation cannot be used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Input tensor. </td></tr>
    <tr><td class="paramname">weight</td><td>Weight tensor. </td></tr>
    <tr><td class="paramname">bias</td><td>Bias tensor (optional). </td></tr>
    <tr><td class="paramname">output</td><td>Output tensor. </td></tr>
    <tr><td class="paramname">B</td><td>Batch size. </td></tr>
    <tr><td class="paramname">TDataType</td><td>Sequence length. </td></tr>
    <tr><td class="paramname">C</td><td>Input feature dimension. </td></tr>
    <tr><td class="paramname">OC</td><td>Output feature dimension. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a91636f5dd01a394a908870378462bc46_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a91636f5dd01a394a908870378462bc46_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a91636f5dd01a394a908870378462bc46_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a91636f5dd01a394a908870378462bc46_cgraph">
<area shape="rect" title="Naive implementation of the forward pass for the Fully Connected operation." alt="" coords="5,5,220,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html#a4f707ea4c0f00aab58189071fa1c11fd" title="Gets a raw pointer to the tensor data for use in CUDA kernels." alt="" coords="268,5,411,45"/>
<area shape="poly" title=" " alt="" coords="220,23,254,23,254,28,220,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a91636f5dd01a394a908870378462bc46_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a91636f5dd01a394a908870378462bc46_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a91636f5dd01a394a908870378462bc46_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1CpuLinearOp_a91636f5dd01a394a908870378462bc46_icgraph">
<area shape="rect" title="Naive implementation of the forward pass for the Fully Connected operation." alt="" coords="224,5,439,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html#af867c7dd9729b6333f475d409b9979dc" title="Performs the forward pass of the Linear operation." alt="" coords="5,5,176,45"/>
<area shape="poly" title=" " alt="" coords="210,28,176,28,176,23,210,23"/>
</map>
</div>

</div>
</div>
<a id="ad7fcd04710901c0f75e4699302b81f2d" name="ad7fcd04710901c0f75e4699302b81f2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7fcd04710901c0f75e4699302b81f2d">&#9670;&#160;</a></span>getName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Mila::Dnn::Compute::CpuLinearOp::getName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the name of this operation. </p>
<dl class="section return"><dt>Returns</dt><dd>std::string The name of the operation ("Cpu::LinearOp"). </dd></dl>

<p>Implements <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a63a8c032751878a9259ecd4335e629b4">Mila::Dnn::Compute::OperationBase&lt; TDeviceType, TInput1, TInput2, TOutput &gt;</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a24070f3216f451150a6b7f9177b38bc3" name="a24070f3216f451150a6b7f9177b38bc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24070f3216f451150a6b7f9177b38bc3">&#9670;&#160;</a></span>config_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1LinearConfig.html">LinearConfig</a> Mila::Dnn::Compute::CpuLinearOp::config_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configuration for the linear operation. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/runner/work/Mila/Mila/Mila/Src/Dnn/Compute/Operations/Cpu/<a class="el" href="CpuLinearOp_8ixx.html">CpuLinearOp.ixx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceMila.html">Mila</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn.html">Dnn</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html">Compute</a></li><li class="navelem"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOp.html">CpuLinearOp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
