<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mila: Mila::Dnn::Compute::DeviceContext Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mila
   </div>
   <div id="projectbrief">Deep Neural Network Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Mila::Dnn::Compute::DeviceContext Class Reference<span class="mlabels"><span class="mlabel">export</span></span><div class="ingroups">module <a class="el" href="module_Compute_8DeviceContext.html">Compute.DeviceContext</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a> class manages device contexts for module and tensor computations.  
 <a href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6f44384ca21e685f62cefe14e717fb7a" id="r_a6f44384ca21e685f62cefe14e717fb7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a6f44384ca21e685f62cefe14e717fb7a">DeviceContext</a> (const <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;)=delete</td></tr>
<tr class="memdesc:a6f44384ca21e685f62cefe14e717fb7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy constructor (deleted).  <br /></td></tr>
<tr class="separator:a6f44384ca21e685f62cefe14e717fb7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66052215400fe2b037fc7e490722ebf0" id="r_a66052215400fe2b037fc7e490722ebf0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a66052215400fe2b037fc7e490722ebf0">DeviceContext</a> (const std::string &amp;device_name)</td></tr>
<tr class="memdesc:a66052215400fe2b037fc7e490722ebf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor with a specific device.  <br /></td></tr>
<tr class="separator:a66052215400fe2b037fc7e490722ebf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a25b92fbd26db5f10fa4bec8d611e2" id="r_a22a25b92fbd26db5f10fa4bec8d611e2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a22a25b92fbd26db5f10fa4bec8d611e2">DeviceContext</a> (<a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;other) noexcept</td></tr>
<tr class="memdesc:a22a25b92fbd26db5f10fa4bec8d611e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move constructor.  <br /></td></tr>
<tr class="separator:a22a25b92fbd26db5f10fa4bec8d611e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab38f3619ed2c3c117a833b21d3223b61" id="r_ab38f3619ed2c3c117a833b21d3223b61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab38f3619ed2c3c117a833b21d3223b61">~DeviceContext</a> ()</td></tr>
<tr class="memdesc:ab38f3619ed2c3c117a833b21d3223b61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="separator:ab38f3619ed2c3c117a833b21d3223b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4620f615ff3dae0d121c68d1c5af77b6" id="r_a4620f615ff3dae0d121c68d1c5af77b6"><td class="memItemLeft" align="right" valign="top">std::pair&lt; int, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4620f615ff3dae0d121c68d1c5af77b6">getComputeCapability</a> () const</td></tr>
<tr class="memdesc:a4620f615ff3dae0d121c68d1c5af77b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the compute capability of the current CUDA device.  <br /></td></tr>
<tr class="separator:a4620f615ff3dae0d121c68d1c5af77b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77f02b7b4dc653665c239c61bbe6cee0" id="r_a77f02b7b4dc653665c239c61bbe6cee0"><td class="memItemLeft" align="right" valign="top">cublasLtHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a77f02b7b4dc653665c239c61bbe6cee0">getCublasLtHandle</a> ()</td></tr>
<tr class="memdesc:a77f02b7b4dc653665c239c61bbe6cee0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the cuBLASLt handle, initializing it if necessary.  <br /></td></tr>
<tr class="separator:a77f02b7b4dc653665c239c61bbe6cee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cbfe23abf282a478ca3333b11cbc576" id="r_a6cbfe23abf282a478ca3333b11cbc576"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputeDevice.html">ComputeDevice</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a6cbfe23abf282a478ca3333b11cbc576">getDevice</a> () const</td></tr>
<tr class="memdesc:a6cbfe23abf282a478ca3333b11cbc576"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current device.  <br /></td></tr>
<tr class="separator:a6cbfe23abf282a478ca3333b11cbc576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a246898ffabcabadcf96a22c974d5b87c" id="r_a246898ffabcabadcf96a22c974d5b87c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a246898ffabcabadcf96a22c974d5b87c">getDeviceId</a> () const</td></tr>
<tr class="memdesc:a246898ffabcabadcf96a22c974d5b87c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the ID of the current CUDA device.  <br /></td></tr>
<tr class="separator:a246898ffabcabadcf96a22c974d5b87c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27d011f69f1b145adc30a0d6bd9347ba" id="r_a27d011f69f1b145adc30a0d6bd9347ba"><td class="memItemLeft" align="right" valign="top">cudaStream_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a27d011f69f1b145adc30a0d6bd9347ba">getStream</a> () const</td></tr>
<tr class="memdesc:a27d011f69f1b145adc30a0d6bd9347ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current CUDA stream.  <br /></td></tr>
<tr class="separator:a27d011f69f1b145adc30a0d6bd9347ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0be82bb15781cc2d3239b7cea4da717" id="r_aa0be82bb15781cc2d3239b7cea4da717"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717">isCudaDevice</a> () const</td></tr>
<tr class="memdesc:aa0be82bb15781cc2d3239b7cea4da717"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the current device is a CUDA device.  <br /></td></tr>
<tr class="separator:aa0be82bb15781cc2d3239b7cea4da717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4105deade514dfadccff3d9b21a6c4ed" id="r_a4105deade514dfadccff3d9b21a6c4ed"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed">isDeviceType</a> (<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> type) const</td></tr>
<tr class="memdesc:a4105deade514dfadccff3d9b21a6c4ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the current device is of a specific type.  <br /></td></tr>
<tr class="separator:a4105deade514dfadccff3d9b21a6c4ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab51af05586b93f8a9867b4e0e0b5209d" id="r_ab51af05586b93f8a9867b4e0e0b5209d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab51af05586b93f8a9867b4e0e0b5209d">makeCurrent</a> () const</td></tr>
<tr class="memdesc:ab51af05586b93f8a9867b4e0e0b5209d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the cuDNN handle, initializing it if necessary.  <br /></td></tr>
<tr class="separator:ab51af05586b93f8a9867b4e0e0b5209d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf003ce328f957580880f66d6b31facd" id="r_acf003ce328f957580880f66d6b31facd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#acf003ce328f957580880f66d6b31facd">operator=</a> (const <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;)=delete</td></tr>
<tr class="memdesc:acf003ce328f957580880f66d6b31facd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy assignment operator (deleted).  <br /></td></tr>
<tr class="separator:acf003ce328f957580880f66d6b31facd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a883e401e8e1be2c8513a95e99a7e4235" id="r_a883e401e8e1be2c8513a95e99a7e4235"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a883e401e8e1be2c8513a95e99a7e4235">operator=</a> (<a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;other) noexcept</td></tr>
<tr class="memdesc:a883e401e8e1be2c8513a95e99a7e4235"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move assignment operator.  <br /></td></tr>
<tr class="separator:a883e401e8e1be2c8513a95e99a7e4235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adec58c226e24c7d4a0d9ba6b5119874d" id="r_adec58c226e24c7d4a0d9ba6b5119874d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#adec58c226e24c7d4a0d9ba6b5119874d">synchronize</a> ()</td></tr>
<tr class="memdesc:adec58c226e24c7d4a0d9ba6b5119874d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Synchronizes the device, waiting for all operations to complete.  <br /></td></tr>
<tr class="separator:adec58c226e24c7d4a0d9ba6b5119874d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a439bcf09aae78c73d84fd6bc5b3d4469" id="r_a439bcf09aae78c73d84fd6bc5b3d4469"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a439bcf09aae78c73d84fd6bc5b3d4469">initializeDeviceResources</a> ()</td></tr>
<tr class="memdesc:a439bcf09aae78c73d84fd6bc5b3d4469"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes resources specific to the current device.  <br /></td></tr>
<tr class="separator:a439bcf09aae78c73d84fd6bc5b3d4469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9c7afccb46ad4b1afbe83bc5d861b32" id="r_aa9c7afccb46ad4b1afbe83bc5d861b32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa9c7afccb46ad4b1afbe83bc5d861b32">moveFrom</a> (<a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;other)</td></tr>
<tr class="memdesc:aa9c7afccb46ad4b1afbe83bc5d861b32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Moves resources from another <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a>.  <br /></td></tr>
<tr class="separator:aa9c7afccb46ad4b1afbe83bc5d861b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3da2632ad08d0ef326d3a51ed3c46284" id="r_a3da2632ad08d0ef326d3a51ed3c46284"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a3da2632ad08d0ef326d3a51ed3c46284">releaseResources</a> ()</td></tr>
<tr class="memdesc:a3da2632ad08d0ef326d3a51ed3c46284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases all device-specific resources.  <br /></td></tr>
<tr class="separator:a3da2632ad08d0ef326d3a51ed3c46284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e36e81342090136e9f33153a73165e0" id="r_a8e36e81342090136e9f33153a73165e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a8e36e81342090136e9f33153a73165e0">setDevice</a> (const std::string &amp;device_name)</td></tr>
<tr class="memdesc:a8e36e81342090136e9f33153a73165e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the current device by name.  <br /></td></tr>
<tr class="separator:a8e36e81342090136e9f33153a73165e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a136f6950f3a605a18f610b031e9a0f39" id="r_a136f6950f3a605a18f610b031e9a0f39"><td class="memItemLeft" align="right" valign="top">cublasLtHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a136f6950f3a605a18f610b031e9a0f39">cublasLtHandle_</a> = nullptr</td></tr>
<tr class="memdesc:a136f6950f3a605a18f610b031e9a0f39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle for cuBLASLt operations.  <br /></td></tr>
<tr class="separator:a136f6950f3a605a18f610b031e9a0f39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c82a66fd608ea99c9aef3baf4b173ce" id="r_a7c82a66fd608ea99c9aef3baf4b173ce"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputeDevice.html">ComputeDevice</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a7c82a66fd608ea99c9aef3baf4b173ce">device_</a></td></tr>
<tr class="memdesc:a7c82a66fd608ea99c9aef3baf4b173ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">The compute device used by this context.  <br /></td></tr>
<tr class="separator:a7c82a66fd608ea99c9aef3baf4b173ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0844d4eb6c1990d90e149b896db12c2" id="r_ac0844d4eb6c1990d90e149b896db12c2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ac0844d4eb6c1990d90e149b896db12c2">device_id_</a> = -1</td></tr>
<tr class="memdesc:ac0844d4eb6c1990d90e149b896db12c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The CUDA device ID, -1 indicates uninitialized.  <br /></td></tr>
<tr class="separator:ac0844d4eb6c1990d90e149b896db12c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae80a515e01d0f15cf53d30f4a52c76be" id="r_ae80a515e01d0f15cf53d30f4a52c76be"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ae80a515e01d0f15cf53d30f4a52c76be">handle_mutex_</a></td></tr>
<tr class="memdesc:ae80a515e01d0f15cf53d30f4a52c76be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex for thread-safe handle initialization.  <br /></td></tr>
<tr class="separator:ae80a515e01d0f15cf53d30f4a52c76be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17a79f6d2f52b8ba67087d4085c2dc8d" id="r_a17a79f6d2f52b8ba67087d4085c2dc8d"><td class="memItemLeft" align="right" valign="top">cudaStream_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a17a79f6d2f52b8ba67087d4085c2dc8d">stream_</a> = nullptr</td></tr>
<tr class="memdesc:a17a79f6d2f52b8ba67087d4085c2dc8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The CUDA stream for asynchronous operations.  <br /></td></tr>
<tr class="separator:a17a79f6d2f52b8ba67087d4085c2dc8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a273d229110a273c367e37339148e2034" id="r_a273d229110a273c367e37339148e2034"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a273d229110a273c367e37339148e2034">stream_created_</a> = false</td></tr>
<tr class="memdesc:a273d229110a273c367e37339148e2034"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates if the stream was created by this context and needs to be destroyed.  <br /></td></tr>
<tr class="separator:a273d229110a273c367e37339148e2034"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a> class manages device contexts for module and tensor computations. </p>
<p>This class provides functionality for managing compute devices and their associated resources, such as CUDA streams and optional cuBLASLt and cuDNN handles. Multiple instances can be created to manage different devices. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a66052215400fe2b037fc7e490722ebf0" name="a66052215400fe2b037fc7e490722ebf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66052215400fe2b037fc7e490722ebf0">&#9670;&#160;</a></span>DeviceContext() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Compute::DeviceContext::DeviceContext </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>device_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor with a specific device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device_name</td><td>The name of the device to use (e.g., "CUDA:0", "CPU"). </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If the device name is invalid or device initialization fails. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a66052215400fe2b037fc7e490722ebf0_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a66052215400fe2b037fc7e490722ebf0_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a66052215400fe2b037fc7e490722ebf0_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a66052215400fe2b037fc7e490722ebf0_cgraph">
<area shape="rect" title="Constructor with a specific device." alt="" coords="5,113,236,153"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a8e36e81342090136e9f33153a73165e0" title="Sets the current device by name." alt="" coords="284,113,483,153"/>
<area shape="poly" title=" " alt="" coords="236,131,270,131,270,136,236,136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceRegistry.html#a764172511f24e7ace760b39f32e316af" title="Creates a device instance by name." alt="" coords="531,5,753,45"/>
<area shape="poly" title=" " alt="" coords="417,111,469,83,530,55,551,47,552,52,532,60,472,87,420,116"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a439bcf09aae78c73d84fd6bc5b3d4469" title="Initializes resources specific to the current device." alt="" coords="547,70,737,125"/>
<area shape="poly" title=" " alt="" coords="483,117,533,110,534,115,483,122"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceRegistry.html#a7fad4212ab870e74917da2abcaf77938" title="Gets the singleton instance of the DeviceRegistry." alt="" coords="547,149,737,189"/>
<area shape="poly" title=" " alt="" coords="483,145,534,152,533,157,483,150"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a3da2632ad08d0ef326d3a51ed3c46284" title="Releases all device&#45;specific resources." alt="" coords="801,203,1051,243"/>
<area shape="poly" title=" " alt="" coords="419,151,471,177,531,199,596,212,662,220,788,225,788,231,662,225,595,217,530,204,469,182,417,156"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="1099,135,1321,175"/>
<area shape="poly" title=" " alt="" coords="738,97,885,104,1051,120,1108,129,1107,135,1050,125,885,110,737,102"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab51af05586b93f8a9867b4e0e0b5209d" title="Gets the cuDNN handle, initializing it if necessary." alt="" coords="817,135,1035,175"/>
<area shape="poly" title=" " alt="" coords="738,114,814,129,812,135,737,119"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="1369,135,1589,175"/>
<area shape="poly" title=" " alt="" coords="1321,152,1356,152,1356,157,1321,157"/>
<area shape="poly" title=" " alt="" coords="1036,152,1085,152,1085,157,1036,157"/>
<area shape="poly" title=" " alt="" coords="1010,200,1112,175,1113,180,1011,205"/>
</map>
</div>

</div>
</div>
<a id="ab38f3619ed2c3c117a833b21d3223b61" name="ab38f3619ed2c3c117a833b21d3223b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab38f3619ed2c3c117a833b21d3223b61">&#9670;&#160;</a></span>~DeviceContext()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Compute::DeviceContext::~DeviceContext </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<p>Cleans up any associated resources. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab38f3619ed2c3c117a833b21d3223b61_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab38f3619ed2c3c117a833b21d3223b61_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab38f3619ed2c3c117a833b21d3223b61_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab38f3619ed2c3c117a833b21d3223b61_cgraph">
<area shape="rect" title="Destructor." alt="" coords="5,5,247,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a3da2632ad08d0ef326d3a51ed3c46284" title="Releases all device&#45;specific resources." alt="" coords="295,5,544,45"/>
<area shape="poly" title=" " alt="" coords="247,23,281,23,281,28,247,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="592,5,815,45"/>
<area shape="poly" title=" " alt="" coords="544,23,579,23,579,28,544,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="863,5,1083,45"/>
<area shape="poly" title=" " alt="" coords="815,23,849,23,849,28,815,28"/>
</map>
</div>

</div>
</div>
<a id="a6f44384ca21e685f62cefe14e717fb7a" name="a6f44384ca21e685f62cefe14e717fb7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f44384ca21e685f62cefe14e717fb7a">&#9670;&#160;</a></span>DeviceContext() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Compute::DeviceContext::DeviceContext </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy constructor (deleted). </p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a> is not copyable due to unique resource ownership. </dd></dl>

</div>
</div>
<a id="a22a25b92fbd26db5f10fa4bec8d611e2" name="a22a25b92fbd26db5f10fa4bec8d611e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22a25b92fbd26db5f10fa4bec8d611e2">&#9670;&#160;</a></span>DeviceContext() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Compute::DeviceContext::DeviceContext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Move constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The source <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a> to move from. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a22a25b92fbd26db5f10fa4bec8d611e2_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a22a25b92fbd26db5f10fa4bec8d611e2_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a22a25b92fbd26db5f10fa4bec8d611e2_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a22a25b92fbd26db5f10fa4bec8d611e2_cgraph">
<area shape="rect" title="Move constructor." alt="" coords="5,5,236,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa9c7afccb46ad4b1afbe83bc5d861b32" title="Moves resources from another DeviceContext." alt="" coords="284,5,488,45"/>
<area shape="poly" title=" " alt="" coords="236,23,270,23,270,28,236,28"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4620f615ff3dae0d121c68d1c5af77b6" name="a4620f615ff3dae0d121c68d1c5af77b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4620f615ff3dae0d121c68d1c5af77b6">&#9670;&#160;</a></span>getComputeCapability()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; int, int &gt; Mila::Dnn::Compute::DeviceContext::getComputeCapability </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the compute capability of the current CUDA device. </p>
<dl class="section return"><dt>Returns</dt><dd>std::pair&lt;int, int&gt; The major and minor versions of the compute capability, or {0,0} if the device is not a CUDA device or compute capability couldn't be determined. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a4620f615ff3dae0d121c68d1c5af77b6_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a4620f615ff3dae0d121c68d1c5af77b6_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a4620f615ff3dae0d121c68d1c5af77b6_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a4620f615ff3dae0d121c68d1c5af77b6_cgraph">
<area shape="rect" title="Gets the compute capability of the current CUDA device." alt="" coords="5,5,220,60"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="268,13,491,53"/>
<area shape="poly" title=" " alt="" coords="220,30,254,30,254,35,220,35"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="539,13,759,53"/>
<area shape="poly" title=" " alt="" coords="491,30,525,30,525,35,491,35"/>
</map>
</div>

</div>
</div>
<a id="a77f02b7b4dc653665c239c61bbe6cee0" name="a77f02b7b4dc653665c239c61bbe6cee0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77f02b7b4dc653665c239c61bbe6cee0">&#9670;&#160;</a></span>getCublasLtHandle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cublasLtHandle_t Mila::Dnn::Compute::DeviceContext::getCublasLtHandle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the cuBLASLt handle, initializing it if necessary. </p>
<dl class="section return"><dt>Returns</dt><dd>The cuBLASLt handle. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If creating the cuBLASLt handle fails. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a77f02b7b4dc653665c239c61bbe6cee0_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a77f02b7b4dc653665c239c61bbe6cee0_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a77f02b7b4dc653665c239c61bbe6cee0_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a77f02b7b4dc653665c239c61bbe6cee0_cgraph">
<area shape="rect" title="Gets the cuBLASLt handle, initializing it if necessary." alt="" coords="5,5,204,60"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="252,13,475,53"/>
<area shape="poly" title=" " alt="" coords="204,30,238,30,238,35,204,35"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="523,13,743,53"/>
<area shape="poly" title=" " alt="" coords="475,30,509,30,509,35,475,35"/>
</map>
</div>

</div>
</div>
<a id="a6cbfe23abf282a478ca3333b11cbc576" name="a6cbfe23abf282a478ca3333b11cbc576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cbfe23abf282a478ca3333b11cbc576">&#9670;&#160;</a></span>getDevice()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputeDevice.html">ComputeDevice</a> &gt; Mila::Dnn::Compute::DeviceContext::getDevice </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the current device. </p>
<dl class="section return"><dt>Returns</dt><dd>A shared pointer to the current device. </dd></dl>

</div>
</div>
<a id="a246898ffabcabadcf96a22c974d5b87c" name="a246898ffabcabadcf96a22c974d5b87c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a246898ffabcabadcf96a22c974d5b87c">&#9670;&#160;</a></span>getDeviceId()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Mila::Dnn::Compute::DeviceContext::getDeviceId </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the ID of the current CUDA device. </p>
<dl class="section return"><dt>Returns</dt><dd>The CUDA device ID, or -1 if not using a CUDA device. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a246898ffabcabadcf96a22c974d5b87c_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a246898ffabcabadcf96a22c974d5b87c_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a246898ffabcabadcf96a22c974d5b87c_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a246898ffabcabadcf96a22c974d5b87c_cgraph">
<area shape="rect" title="Gets the ID of the current CUDA device." alt="" coords="5,5,217,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="265,5,488,45"/>
<area shape="poly" title=" " alt="" coords="218,23,251,23,251,28,218,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="536,5,756,45"/>
<area shape="poly" title=" " alt="" coords="488,23,522,23,522,28,488,28"/>
</map>
</div>

</div>
</div>
<a id="a27d011f69f1b145adc30a0d6bd9347ba" name="a27d011f69f1b145adc30a0d6bd9347ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27d011f69f1b145adc30a0d6bd9347ba">&#9670;&#160;</a></span>getStream()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cudaStream_t Mila::Dnn::Compute::DeviceContext::getStream </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the current CUDA stream. </p>
<dl class="section return"><dt>Returns</dt><dd>The current CUDA stream, or nullptr if not using CUDA. </dd></dl>

</div>
</div>
<a id="a439bcf09aae78c73d84fd6bc5b3d4469" name="a439bcf09aae78c73d84fd6bc5b3d4469"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a439bcf09aae78c73d84fd6bc5b3d4469">&#9670;&#160;</a></span>initializeDeviceResources()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::DeviceContext::initializeDeviceResources </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes resources specific to the current device. </p>
<p>For CUDA devices, this retrieves the device ID, sets the device as current, and creates a CUDA stream. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a439bcf09aae78c73d84fd6bc5b3d4469_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a439bcf09aae78c73d84fd6bc5b3d4469_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a439bcf09aae78c73d84fd6bc5b3d4469_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a439bcf09aae78c73d84fd6bc5b3d4469_cgraph">
<area shape="rect" title="Initializes resources specific to the current device." alt="" coords="5,5,196,60"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="511,13,733,53"/>
<area shape="poly" title=" " alt="" coords="196,27,244,26,463,26,497,27,497,32,463,31,244,31,196,32"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab51af05586b93f8a9867b4e0e0b5209d" title="Gets the cuDNN handle, initializing it if necessary." alt="" coords="244,41,463,81"/>
<area shape="poly" title=" " alt="" coords="196,41,231,44,230,50,196,46"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="781,13,1001,53"/>
<area shape="poly" title=" " alt="" coords="733,30,768,30,768,35,733,35"/>
<area shape="poly" title=" " alt="" coords="463,47,497,43,497,48,463,52"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a439bcf09aae78c73d84fd6bc5b3d4469_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a439bcf09aae78c73d84fd6bc5b3d4469_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a439bcf09aae78c73d84fd6bc5b3d4469_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a439bcf09aae78c73d84fd6bc5b3d4469_icgraph">
<area shape="rect" title="Initializes resources specific to the current device." alt="" coords="531,5,721,60"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a8e36e81342090136e9f33153a73165e0" title="Sets the current device by name." alt="" coords="284,13,483,53"/>
<area shape="poly" title=" " alt="" coords="517,35,483,35,483,30,517,30"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a66052215400fe2b037fc7e490722ebf0" title="Constructor with a specific device." alt="" coords="5,13,236,53"/>
<area shape="poly" title=" " alt="" coords="270,35,236,35,236,30,270,30"/>
</map>
</div>

</div>
</div>
<a id="aa0be82bb15781cc2d3239b7cea4da717" name="aa0be82bb15781cc2d3239b7cea4da717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0be82bb15781cc2d3239b7cea4da717">&#9670;&#160;</a></span>isCudaDevice()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Mila::Dnn::Compute::DeviceContext::isCudaDevice </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the current device is a CUDA device. </p>
<dl class="section return"><dt>Returns</dt><dd>True if the device is a CUDA device, false otherwise. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa0be82bb15781cc2d3239b7cea4da717_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa0be82bb15781cc2d3239b7cea4da717_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa0be82bb15781cc2d3239b7cea4da717_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa0be82bb15781cc2d3239b7cea4da717_cgraph">
<area shape="rect" title="Checks if the current device is a CUDA device." alt="" coords="5,5,228,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="276,5,496,45"/>
<area shape="poly" title=" " alt="" coords="228,23,262,23,262,28,228,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa0be82bb15781cc2d3239b7cea4da717_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa0be82bb15781cc2d3239b7cea4da717_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa0be82bb15781cc2d3239b7cea4da717_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa0be82bb15781cc2d3239b7cea4da717_icgraph">
<area shape="rect" title="Checks if the current device is a CUDA device." alt="" coords="1117,221,1340,261"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4620f615ff3dae0d121c68d1c5af77b6" title="Gets the compute capability of the current CUDA device." alt="" coords="837,5,1052,60"/>
<area shape="poly" title=" " alt="" coords="1204,211,1147,142,1110,105,1068,74,1047,62,1049,58,1071,69,1113,101,1151,138,1208,208"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a77f02b7b4dc653665c239c61bbe6cee0" title="Gets the cuBLASLt handle, initializing it if necessary." alt="" coords="845,84,1044,139"/>
<area shape="poly" title=" " alt="" coords="1183,216,1129,184,1068,154,1037,141,1039,136,1070,149,1132,180,1186,211"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a246898ffabcabadcf96a22c974d5b87c" title="Gets the ID of the current CUDA device." alt="" coords="839,163,1051,203"/>
<area shape="poly" title=" " alt="" coords="1115,220,1044,206,1045,201,1116,215"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a439bcf09aae78c73d84fd6bc5b3d4469" title="Initializes resources specific to the current device." alt="" coords="556,213,747,268"/>
<area shape="poly" title=" " alt="" coords="1104,243,747,243,747,238,1104,238"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab51af05586b93f8a9867b4e0e0b5209d" title="Gets the cuDNN handle, initializing it if necessary." alt="" coords="835,278,1054,318"/>
<area shape="poly" title=" " alt="" coords="1116,266,1045,281,1044,275,1115,261"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#adec58c226e24c7d4a0d9ba6b5119874d" title="Synchronizes the device, waiting for all operations to complete." alt="" coords="545,293,757,333"/>
<area shape="poly" title=" " alt="" coords="1192,271,1137,305,1104,321,1070,333,987,347,902,350,821,345,750,335,750,330,821,339,902,344,986,342,1069,327,1102,316,1134,301,1189,266"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a3da2632ad08d0ef326d3a51ed3c46284" title="Releases all device&#45;specific resources." alt="" coords="820,399,1069,439"/>
<area shape="poly" title=" " alt="" coords="1200,273,1143,325,1108,352,1071,376,1015,402,1013,397,1068,372,1105,348,1140,321,1197,269"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a8e36e81342090136e9f33153a73165e0" title="Sets the current device by name." alt="" coords="284,286,483,326"/>
<area shape="poly" title=" " alt="" coords="543,270,467,289,465,283,542,265"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a66052215400fe2b037fc7e490722ebf0" title="Constructor with a specific device." alt="" coords="5,286,236,326"/>
<area shape="poly" title=" " alt="" coords="270,309,236,309,236,303,270,303"/>
<area shape="poly" title=" " alt="" coords="828,278,746,262,747,257,829,273"/>
<area shape="poly" title=" " alt="" coords="821,307,758,310,757,305,821,301"/>
<area shape="poly" title=" " alt="" coords="806,400,672,376,530,347,455,329,456,323,531,342,673,371,807,395"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab38f3619ed2c3c117a833b21d3223b61" title="Destructor." alt="" coords="531,407,772,447"/>
<area shape="poly" title=" " alt="" coords="806,426,772,427,772,421,806,420"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a883e401e8e1be2c8513a95e99a7e4235" title="Move assignment operator." alt="" coords="551,471,751,511"/>
<area shape="poly" title=" " alt="" coords="850,445,734,474,733,469,849,440"/>
</map>
</div>

</div>
</div>
<a id="a4105deade514dfadccff3d9b21a6c4ed" name="a4105deade514dfadccff3d9b21a6c4ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4105deade514dfadccff3d9b21a6c4ed">&#9670;&#160;</a></span>isDeviceType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Mila::Dnn::Compute::DeviceContext::isDeviceType </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the current device is of a specific type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>The device type to check against. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the device matches the specified type, false otherwise. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a4105deade514dfadccff3d9b21a6c4ed_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a4105deade514dfadccff3d9b21a6c4ed_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a4105deade514dfadccff3d9b21a6c4ed_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a4105deade514dfadccff3d9b21a6c4ed_icgraph">
<area shape="rect" title="Checks if the current device is of a specific type." alt="" coords="1388,221,1608,261"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="1117,221,1340,261"/>
<area shape="poly" title=" " alt="" coords="1374,243,1340,243,1340,238,1374,238"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4620f615ff3dae0d121c68d1c5af77b6" title="Gets the compute capability of the current CUDA device." alt="" coords="837,5,1052,60"/>
<area shape="poly" title=" " alt="" coords="1204,211,1147,142,1110,105,1068,74,1047,62,1049,58,1071,69,1113,101,1151,138,1208,208"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a77f02b7b4dc653665c239c61bbe6cee0" title="Gets the cuBLASLt handle, initializing it if necessary." alt="" coords="845,84,1044,139"/>
<area shape="poly" title=" " alt="" coords="1183,216,1129,184,1068,154,1037,141,1039,136,1070,149,1132,180,1186,211"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a246898ffabcabadcf96a22c974d5b87c" title="Gets the ID of the current CUDA device." alt="" coords="839,163,1051,203"/>
<area shape="poly" title=" " alt="" coords="1115,220,1044,206,1045,201,1116,215"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a439bcf09aae78c73d84fd6bc5b3d4469" title="Initializes resources specific to the current device." alt="" coords="556,213,747,268"/>
<area shape="poly" title=" " alt="" coords="1104,243,747,243,747,238,1104,238"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab51af05586b93f8a9867b4e0e0b5209d" title="Gets the cuDNN handle, initializing it if necessary." alt="" coords="835,278,1054,318"/>
<area shape="poly" title=" " alt="" coords="1116,266,1045,281,1044,275,1115,261"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#adec58c226e24c7d4a0d9ba6b5119874d" title="Synchronizes the device, waiting for all operations to complete." alt="" coords="545,293,757,333"/>
<area shape="poly" title=" " alt="" coords="1192,271,1137,305,1104,321,1070,333,987,347,902,350,821,345,750,335,750,330,821,339,902,344,986,342,1069,327,1102,316,1134,301,1189,266"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a3da2632ad08d0ef326d3a51ed3c46284" title="Releases all device&#45;specific resources." alt="" coords="820,399,1069,439"/>
<area shape="poly" title=" " alt="" coords="1200,273,1143,325,1108,352,1071,376,1015,402,1013,397,1068,372,1105,348,1140,321,1197,269"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a8e36e81342090136e9f33153a73165e0" title="Sets the current device by name." alt="" coords="284,286,483,326"/>
<area shape="poly" title=" " alt="" coords="543,270,467,289,465,283,542,265"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a66052215400fe2b037fc7e490722ebf0" title="Constructor with a specific device." alt="" coords="5,286,236,326"/>
<area shape="poly" title=" " alt="" coords="270,309,236,309,236,303,270,303"/>
<area shape="poly" title=" " alt="" coords="828,278,746,262,747,257,829,273"/>
<area shape="poly" title=" " alt="" coords="821,307,758,310,757,305,821,301"/>
<area shape="poly" title=" " alt="" coords="806,400,672,376,530,347,455,329,456,323,531,342,673,371,807,395"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab38f3619ed2c3c117a833b21d3223b61" title="Destructor." alt="" coords="531,407,772,447"/>
<area shape="poly" title=" " alt="" coords="806,426,772,427,772,421,806,420"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a883e401e8e1be2c8513a95e99a7e4235" title="Move assignment operator." alt="" coords="551,471,751,511"/>
<area shape="poly" title=" " alt="" coords="850,445,734,474,733,469,849,440"/>
</map>
</div>

</div>
</div>
<a id="ab51af05586b93f8a9867b4e0e0b5209d" name="ab51af05586b93f8a9867b4e0e0b5209d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab51af05586b93f8a9867b4e0e0b5209d">&#9670;&#160;</a></span>makeCurrent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::DeviceContext::makeCurrent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the cuDNN handle, initializing it if necessary. </p>
<dl class="section return"><dt>Returns</dt><dd>The cuDNN handle. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If creating the cuDNN handle fails.</td></tr>
  </table>
  </dd>
</dl>
<p>Sets the current device as active in the current thread.</p>
<p>This method ensures that subsequent CUDA operations are executed on the correct device by setting the current device in the thread if it's different from the previously set device. The method optimizes performance by tracking the currently active device per thread and avoiding unnecessary device switches.</p>
<dl class="section note"><dt>Note</dt><dd>This method is thread-safe and optimized for multi-threaded environments. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If setting the CUDA device fails. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab51af05586b93f8a9867b4e0e0b5209d_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab51af05586b93f8a9867b4e0e0b5209d_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab51af05586b93f8a9867b4e0e0b5209d_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab51af05586b93f8a9867b4e0e0b5209d_cgraph">
<area shape="rect" title="Gets the cuDNN handle, initializing it if necessary." alt="" coords="5,5,224,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="272,5,495,45"/>
<area shape="poly" title=" " alt="" coords="224,23,258,23,258,28,224,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="543,5,763,45"/>
<area shape="poly" title=" " alt="" coords="495,23,529,23,529,28,495,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab51af05586b93f8a9867b4e0e0b5209d_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab51af05586b93f8a9867b4e0e0b5209d_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab51af05586b93f8a9867b4e0e0b5209d_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_ab51af05586b93f8a9867b4e0e0b5209d_icgraph">
<area shape="rect" title="Gets the cuDNN handle, initializing it if necessary." alt="" coords="791,49,1009,89"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a439bcf09aae78c73d84fd6bc5b3d4469" title="Initializes resources specific to the current device." alt="" coords="541,5,732,60"/>
<area shape="poly" title=" " alt="" coords="776,54,732,48,733,43,777,49"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#adec58c226e24c7d4a0d9ba6b5119874d" title="Synchronizes the device, waiting for all operations to complete." alt="" coords="531,85,743,125"/>
<area shape="poly" title=" " alt="" coords="777,88,743,93,743,88,777,83"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a8e36e81342090136e9f33153a73165e0" title="Sets the current device by name." alt="" coords="284,13,483,53"/>
<area shape="poly" title=" " alt="" coords="528,35,483,35,483,30,528,30"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a66052215400fe2b037fc7e490722ebf0" title="Constructor with a specific device." alt="" coords="5,13,236,53"/>
<area shape="poly" title=" " alt="" coords="270,35,236,35,236,30,270,30"/>
</map>
</div>

</div>
</div>
<a id="aa9c7afccb46ad4b1afbe83bc5d861b32" name="aa9c7afccb46ad4b1afbe83bc5d861b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9c7afccb46ad4b1afbe83bc5d861b32">&#9670;&#160;</a></span>moveFrom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::DeviceContext::moveFrom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Moves resources from another <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a> to move resources from. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa9c7afccb46ad4b1afbe83bc5d861b32_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa9c7afccb46ad4b1afbe83bc5d861b32_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa9c7afccb46ad4b1afbe83bc5d861b32_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_aa9c7afccb46ad4b1afbe83bc5d861b32_icgraph">
<area shape="rect" title="Moves resources from another DeviceContext." alt="" coords="284,37,488,77"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a22a25b92fbd26db5f10fa4bec8d611e2" title="Move constructor." alt="" coords="5,5,236,45"/>
<area shape="poly" title=" " alt="" coords="270,46,236,42,236,37,271,41"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a883e401e8e1be2c8513a95e99a7e4235" title="Move assignment operator." alt="" coords="21,69,221,109"/>
<area shape="poly" title=" " alt="" coords="270,74,221,80,220,75,270,69"/>
</map>
</div>

</div>
</div>
<a id="acf003ce328f957580880f66d6b31facd" name="acf003ce328f957580880f66d6b31facd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf003ce328f957580880f66d6b31facd">&#9670;&#160;</a></span>operator=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp; Mila::Dnn::Compute::DeviceContext::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy assignment operator (deleted). </p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a> is not copyable due to unique resource ownership. </dd></dl>

</div>
</div>
<a id="a883e401e8e1be2c8513a95e99a7e4235" name="a883e401e8e1be2c8513a95e99a7e4235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a883e401e8e1be2c8513a95e99a7e4235">&#9670;&#160;</a></span>operator=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp; Mila::Dnn::Compute::DeviceContext::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Move assignment operator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The source <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a> to move from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a>. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a883e401e8e1be2c8513a95e99a7e4235_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a883e401e8e1be2c8513a95e99a7e4235_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a883e401e8e1be2c8513a95e99a7e4235_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a883e401e8e1be2c8513a95e99a7e4235_cgraph">
<area shape="rect" title="Move assignment operator." alt="" coords="5,37,205,77"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa9c7afccb46ad4b1afbe83bc5d861b32" title="Moves resources from another DeviceContext." alt="" coords="276,5,480,45"/>
<area shape="poly" title=" " alt="" coords="205,43,262,36,263,42,206,48"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a3da2632ad08d0ef326d3a51ed3c46284" title="Releases all device&#45;specific resources." alt="" coords="253,69,503,109"/>
<area shape="poly" title=" " alt="" coords="206,66,240,70,240,76,205,72"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="551,69,773,109"/>
<area shape="poly" title=" " alt="" coords="503,87,537,87,537,92,503,92"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="821,69,1041,109"/>
<area shape="poly" title=" " alt="" coords="773,87,808,87,808,92,773,92"/>
</map>
</div>

</div>
</div>
<a id="a3da2632ad08d0ef326d3a51ed3c46284" name="a3da2632ad08d0ef326d3a51ed3c46284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3da2632ad08d0ef326d3a51ed3c46284">&#9670;&#160;</a></span>releaseResources()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::DeviceContext::releaseResources </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Releases all device-specific resources. </p>
<p>Frees CUDA streams and library handles when applicable. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a3da2632ad08d0ef326d3a51ed3c46284_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a3da2632ad08d0ef326d3a51ed3c46284_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a3da2632ad08d0ef326d3a51ed3c46284_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a3da2632ad08d0ef326d3a51ed3c46284_cgraph">
<area shape="rect" title="Releases all device&#45;specific resources." alt="" coords="5,5,255,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="303,5,525,45"/>
<area shape="poly" title=" " alt="" coords="255,23,289,23,289,28,255,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="573,5,793,45"/>
<area shape="poly" title=" " alt="" coords="525,23,560,23,560,28,525,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a3da2632ad08d0ef326d3a51ed3c46284_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a3da2632ad08d0ef326d3a51ed3c46284_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a3da2632ad08d0ef326d3a51ed3c46284_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a3da2632ad08d0ef326d3a51ed3c46284_icgraph">
<area shape="rect" title="Releases all device&#45;specific resources." alt="" coords="573,69,823,109"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab38f3619ed2c3c117a833b21d3223b61" title="Destructor." alt="" coords="284,5,525,45"/>
<area shape="poly" title=" " alt="" coords="592,69,496,48,497,43,593,64"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a883e401e8e1be2c8513a95e99a7e4235" title="Move assignment operator." alt="" coords="305,69,505,109"/>
<area shape="poly" title=" " alt="" coords="560,92,505,92,505,87,560,87"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a8e36e81342090136e9f33153a73165e0" title="Sets the current device by name." alt="" coords="305,133,504,173"/>
<area shape="poly" title=" " alt="" coords="593,115,497,136,496,131,592,110"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a66052215400fe2b037fc7e490722ebf0" title="Constructor with a specific device." alt="" coords="5,133,236,173"/>
<area shape="poly" title=" " alt="" coords="292,156,236,156,236,151,292,151"/>
</map>
</div>

</div>
</div>
<a id="a8e36e81342090136e9f33153a73165e0" name="a8e36e81342090136e9f33153a73165e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e36e81342090136e9f33153a73165e0">&#9670;&#160;</a></span>setDevice()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::DeviceContext::setDevice </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>device_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the current device by name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device_name</td><td>The name of the device to set. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If the device name is invalid or device initialization fails. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a8e36e81342090136e9f33153a73165e0_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a8e36e81342090136e9f33153a73165e0_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a8e36e81342090136e9f33153a73165e0_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a8e36e81342090136e9f33153a73165e0_cgraph">
<area shape="rect" title="Sets the current device by name." alt="" coords="5,113,204,153"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceRegistry.html#a764172511f24e7ace760b39f32e316af" title="Creates a device instance by name." alt="" coords="252,5,475,45"/>
<area shape="poly" title=" " alt="" coords="139,111,191,83,251,55,272,47,274,52,253,60,193,87,141,116"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a439bcf09aae78c73d84fd6bc5b3d4469" title="Initializes resources specific to the current device." alt="" coords="268,70,459,125"/>
<area shape="poly" title=" " alt="" coords="204,117,254,110,255,115,205,122"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceRegistry.html#a7fad4212ab870e74917da2abcaf77938" title="Gets the singleton instance of the DeviceRegistry." alt="" coords="268,149,459,189"/>
<area shape="poly" title=" " alt="" coords="205,145,255,152,254,157,204,150"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a3da2632ad08d0ef326d3a51ed3c46284" title="Releases all device&#45;specific resources." alt="" coords="523,203,772,243"/>
<area shape="poly" title=" " alt="" coords="141,151,192,177,253,199,317,212,383,220,509,225,509,231,383,225,316,217,251,204,190,182,138,156"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="820,135,1043,175"/>
<area shape="poly" title=" " alt="" coords="459,97,607,104,772,120,829,129,828,135,772,125,606,110,459,102"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab51af05586b93f8a9867b4e0e0b5209d" title="Gets the cuDNN handle, initializing it if necessary." alt="" coords="538,135,757,175"/>
<area shape="poly" title=" " alt="" coords="459,114,535,129,534,135,458,119"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="1091,135,1311,175"/>
<area shape="poly" title=" " alt="" coords="1043,152,1077,152,1077,157,1043,157"/>
<area shape="poly" title=" " alt="" coords="757,152,806,152,806,157,757,157"/>
<area shape="poly" title=" " alt="" coords="731,200,834,175,835,180,732,205"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_a8e36e81342090136e9f33153a73165e0_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a8e36e81342090136e9f33153a73165e0_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a8e36e81342090136e9f33153a73165e0_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_a8e36e81342090136e9f33153a73165e0_icgraph">
<area shape="rect" title="Sets the current device by name." alt="" coords="284,5,483,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a66052215400fe2b037fc7e490722ebf0" title="Constructor with a specific device." alt="" coords="5,5,236,45"/>
<area shape="poly" title=" " alt="" coords="270,28,236,28,236,23,270,23"/>
</map>
</div>

</div>
</div>
<a id="adec58c226e24c7d4a0d9ba6b5119874d" name="adec58c226e24c7d4a0d9ba6b5119874d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adec58c226e24c7d4a0d9ba6b5119874d">&#9670;&#160;</a></span>synchronize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::DeviceContext::synchronize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Synchronizes the device, waiting for all operations to complete. </p>
<p>When using a CUDA device, this method ensures the current device is active and then synchronizes the CUDA stream, waiting for all enqueued operations to complete. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1DeviceContext_adec58c226e24c7d4a0d9ba6b5119874d_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_adec58c226e24c7d4a0d9ba6b5119874d_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_adec58c226e24c7d4a0d9ba6b5119874d_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1DeviceContext_adec58c226e24c7d4a0d9ba6b5119874d_cgraph">
<area shape="rect" title="Synchronizes the device, waiting for all operations to complete." alt="" coords="5,5,217,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717" title="Checks if the current device is a CUDA device." alt="" coords="532,5,755,45"/>
<area shape="poly" title=" " alt="" coords="217,20,265,19,484,19,518,19,518,25,484,24,265,24,217,25"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab51af05586b93f8a9867b4e0e0b5209d" title="Gets the cuDNN handle, initializing it if necessary." alt="" coords="265,33,484,73"/>
<area shape="poly" title=" " alt="" coords="218,34,252,38,252,43,217,39"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed" title="Checks if the current device is of a specific type." alt="" coords="803,5,1023,45"/>
<area shape="poly" title=" " alt="" coords="755,23,789,23,789,28,755,28"/>
<area shape="poly" title=" " alt="" coords="484,39,518,36,519,41,484,45"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a136f6950f3a605a18f610b031e9a0f39" name="a136f6950f3a605a18f610b031e9a0f39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a136f6950f3a605a18f610b031e9a0f39">&#9670;&#160;</a></span>cublasLtHandle_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cublasLtHandle_t Mila::Dnn::Compute::DeviceContext::cublasLtHandle_ = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle for cuBLASLt operations. </p>

</div>
</div>
<a id="a7c82a66fd608ea99c9aef3baf4b173ce" name="a7c82a66fd608ea99c9aef3baf4b173ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c82a66fd608ea99c9aef3baf4b173ce">&#9670;&#160;</a></span>device_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputeDevice.html">ComputeDevice</a>&gt; Mila::Dnn::Compute::DeviceContext::device_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The compute device used by this context. </p>

</div>
</div>
<a id="ac0844d4eb6c1990d90e149b896db12c2" name="ac0844d4eb6c1990d90e149b896db12c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0844d4eb6c1990d90e149b896db12c2">&#9670;&#160;</a></span>device_id_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Mila::Dnn::Compute::DeviceContext::device_id_ = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The CUDA device ID, -1 indicates uninitialized. </p>

</div>
</div>
<a id="ae80a515e01d0f15cf53d30f4a52c76be" name="ae80a515e01d0f15cf53d30f4a52c76be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae80a515e01d0f15cf53d30f4a52c76be">&#9670;&#160;</a></span>handle_mutex_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex Mila::Dnn::Compute::DeviceContext::handle_mutex_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mutex for thread-safe handle initialization. </p>

</div>
</div>
<a id="a17a79f6d2f52b8ba67087d4085c2dc8d" name="a17a79f6d2f52b8ba67087d4085c2dc8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17a79f6d2f52b8ba67087d4085c2dc8d">&#9670;&#160;</a></span>stream_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cudaStream_t Mila::Dnn::Compute::DeviceContext::stream_ = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The CUDA stream for asynchronous operations. </p>

</div>
</div>
<a id="a273d229110a273c367e37339148e2034" name="a273d229110a273c367e37339148e2034"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a273d229110a273c367e37339148e2034">&#9670;&#160;</a></span>stream_created_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Mila::Dnn::Compute::DeviceContext::stream_created_ = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Indicates if the stream was created by this context and needs to be destroyed. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/runner/work/Mila/Mila/Mila/Src/Dnn/Compute/Devices/<a class="el" href="DeviceContext_8ixx.html">DeviceContext.ixx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceMila.html">Mila</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn.html">Dnn</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html">Compute</a></li><li class="navelem"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
