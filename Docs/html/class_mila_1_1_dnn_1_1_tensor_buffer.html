<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mila: Mila::Dnn::TensorBuffer&lt; T, MR &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mila
   </div>
   <div id="projectbrief">Deep Neural Network Library</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('class_mila_1_1_dnn_1_1_tensor_buffer.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_mila_1_1_dnn_1_1_tensor_buffer-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Mila::Dnn::TensorBuffer&lt; T, MR &gt; Class Template Reference<span class="mlabels"><span class="mlabel export">export</span></span><div class="ingroups">module <a class="el" href="module___dnn_8_tensor_buffer.html">Dnn.TensorBuffer</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>A buffer for storing tensor data with configurable memory management.  
 <a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9ac438ca78c08a4c2ad2e5bc818696ae" id="r_a9ac438ca78c08a4c2ad2e5bc818696ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ac438ca78c08a4c2ad2e5bc818696ae">TensorBuffer</a> (const <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">TensorBuffer</a> &amp;)=delete</td></tr>
<tr class="memdesc:a9ac438ca78c08a4c2ad2e5bc818696ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy operations are explicitly deleted.  <br /></td></tr>
<tr class="separator:a9ac438ca78c08a4c2ad2e5bc818696ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f843cfbf1ce8cc6c7c1f9c4b5af200a" id="r_a4f843cfbf1ce8cc6c7c1f9c4b5af200a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f843cfbf1ce8cc6c7c1f9c4b5af200a">TensorBuffer</a> (size_t <a class="el" href="#a7f4731fcc1a15d7faf10b5eedc910ff2">size</a>, T *data_ptr)</td></tr>
<tr class="memdesc:a4f843cfbf1ce8cc6c7c1f9c4b5af200a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object with externally managed memory.  <br /></td></tr>
<tr class="separator:a4f843cfbf1ce8cc6c7c1f9c4b5af200a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc48bf1e1c6d3f9ce6756026cc446eae" id="r_acc48bf1e1c6d3f9ce6756026cc446eae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc48bf1e1c6d3f9ce6756026cc446eae">TensorBuffer</a> (size_t <a class="el" href="#a7f4731fcc1a15d7faf10b5eedc910ff2">size</a>, T value=T{})</td></tr>
<tr class="memdesc:acc48bf1e1c6d3f9ce6756026cc446eae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object with owned memory and optional value initialization.  <br /></td></tr>
<tr class="separator:acc48bf1e1c6d3f9ce6756026cc446eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48faa8a0cc8086b3e3d4063bef00b1d4" id="r_a48faa8a0cc8086b3e3d4063bef00b1d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48faa8a0cc8086b3e3d4063bef00b1d4">~TensorBuffer</a> ()</td></tr>
<tr class="memdesc:a48faa8a0cc8086b3e3d4063bef00b1d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object and deallocates memory if owned.  <br /></td></tr>
<tr class="separator:a48faa8a0cc8086b3e3d4063bef00b1d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa2e141e0f345ccca9bc53b2b17bdf58" id="r_aaa2e141e0f345ccca9bc53b2b17bdf58"><td class="memItemLeft" align="right" valign="top">T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa2e141e0f345ccca9bc53b2b17bdf58">data</a> ()</td></tr>
<tr class="memdesc:aaa2e141e0f345ccca9bc53b2b17bdf58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a pointer to the buffer's data.  <br /></td></tr>
<tr class="separator:aaa2e141e0f345ccca9bc53b2b17bdf58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab18d7d4bfb2cc6ce2ae149a191a3a0eb" id="r_ab18d7d4bfb2cc6ce2ae149a191a3a0eb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab18d7d4bfb2cc6ce2ae149a191a3a0eb">is_aligned</a> () const noexcept</td></tr>
<tr class="memdesc:ab18d7d4bfb2cc6ce2ae149a191a3a0eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the buffer's data pointer is properly aligned.  <br /></td></tr>
<tr class="separator:ab18d7d4bfb2cc6ce2ae149a191a3a0eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ade189423d0f2ab93f68a9bca480118" id="r_a6ade189423d0f2ab93f68a9bca480118"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">TensorBuffer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ade189423d0f2ab93f68a9bca480118">operator=</a> (const <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">TensorBuffer</a> &amp;)=delete</td></tr>
<tr class="separator:a6ade189423d0f2ab93f68a9bca480118"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946911e83680e60fd374078c9fe70c4f" id="r_a946911e83680e60fd374078c9fe70c4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a946911e83680e60fd374078c9fe70c4f">resize</a> (size_t new_size)</td></tr>
<tr class="memdesc:a946911e83680e60fd374078c9fe70c4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resizes the buffer to a new size, preserving existing data when possible.  <br /></td></tr>
<tr class="separator:a946911e83680e60fd374078c9fe70c4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f4731fcc1a15d7faf10b5eedc910ff2" id="r_a7f4731fcc1a15d7faf10b5eedc910ff2"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f4731fcc1a15d7faf10b5eedc910ff2">size</a> () const</td></tr>
<tr class="memdesc:a7f4731fcc1a15d7faf10b5eedc910ff2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the size of the buffer.  <br /></td></tr>
<tr class="separator:a7f4731fcc1a15d7faf10b5eedc910ff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:aaf352839767ee4d8c3d0c3769e319d6b" id="r_aaf352839767ee4d8c3d0c3769e319d6b"><td class="memItemLeft" align="right" valign="top">static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaf352839767ee4d8c3d0c3769e319d6b">alignment</a> = <a class="el" href="namespace_mila_1_1_dnn_1_1detail.html#af137c7018cb88c2251064731685714a7">detail::get_alignment</a>&lt;MR&gt;()</td></tr>
<tr class="memdesc:aaf352839767ee4d8c3d0c3769e319d6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The alignment boundary for memory allocation based on the memory resource type.  <br /></td></tr>
<tr class="separator:aaf352839767ee4d8c3d0c3769e319d6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a85da3fc48bcde3924abdf0b228bd059c" id="r_a85da3fc48bcde3924abdf0b228bd059c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85da3fc48bcde3924abdf0b228bd059c">fillBuffer</a> (T value=T{})</td></tr>
<tr class="memdesc:a85da3fc48bcde3924abdf0b228bd059c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the buffer with a specified value.  <br /></td></tr>
<tr class="separator:a85da3fc48bcde3924abdf0b228bd059c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ad65ade365824f6f36cd7fd2e052977b4" id="r_ad65ade365824f6f36cd7fd2e052977b4"><td class="memItemLeft" align="right" valign="top">T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad65ade365824f6f36cd7fd2e052977b4">data_</a> { nullptr }</td></tr>
<tr class="memdesc:ad65ade365824f6f36cd7fd2e052977b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">A pointer to the allocated memory containing the buffer's data.  <br /></td></tr>
<tr class="separator:ad65ade365824f6f36cd7fd2e052977b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3928ef4134ebd3212136afd1bd31a921" id="r_a3928ef4134ebd3212136afd1bd31a921"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="namespace_mila_1_1_dnn_1_1_compute.html#aa6456bd950c55c6e678e77a203425149">Compute::MemoryResource</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3928ef4134ebd3212136afd1bd31a921">mr_</a> { nullptr }</td></tr>
<tr class="memdesc:a3928ef4134ebd3212136afd1bd31a921"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory resource used for allocation/deallocation (null for externally managed buffers).  <br /></td></tr>
<tr class="separator:a3928ef4134ebd3212136afd1bd31a921"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3df84f6770181428fb5b6778d8868aa" id="r_ac3df84f6770181428fb5b6778d8868aa"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac3df84f6770181428fb5b6778d8868aa">size_</a> { 0 }</td></tr>
<tr class="memdesc:ac3df84f6770181428fb5b6778d8868aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of elements in the buffer.  <br /></td></tr>
<tr class="separator:ac3df84f6770181428fb5b6778d8868aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename T, typename MR&gt;<br />
requires std::is_base_of_v&lt;<a class="el" href="namespace_mila_1_1_dnn_1_1_compute.html#aa6456bd950c55c6e678e77a203425149">Compute::MemoryResource</a>, MR&gt;<br />
class Mila::Dnn::TensorBuffer&lt; T, MR &gt;</div><p>A buffer for storing tensor data with configurable memory management. </p>
<p><a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> provides a generic container for tensor data that can be stored either in CPU or GPU memory based on the memory resource type. It supports both owned and externally managed memory.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>The type of the elements stored in the buffer. </td></tr>
    <tr><td class="paramname">MR</td><td>The memory resource type that determines where and how memory is allocated. Must derive from <a class="el" href="namespace_mila_1_1_dnn_1_1_compute.html#aa6456bd950c55c6e678e77a203425149" title="An alias for the standard polymorphic memory resource.">Compute::MemoryResource</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Thread Safety: The buffer is not thread-safe. Multiple threads accessing the same buffer must be synchronized externally.</dd>
<dd>
Exception Safety: Basic guarantee - if an exception occurs during operations, no memory is leaked but the buffer may be left in an undefined state.</dd></dl>
<p>Example usage: </p><div class="fragment"><div class="line"><span class="comment">// Create a CPU buffer with 100 floats initialized to 0.0f</span></div>
<div class="line"><a class="code hl_function" href="#acc48bf1e1c6d3f9ce6756026cc446eae">TensorBuffer&lt;float, Compute::HostMemoryResource&gt;</a> cpuBuffer(100, 0.0f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a GPU buffer with 100 floats</span></div>
<div class="line"><a class="code hl_function" href="#acc48bf1e1c6d3f9ce6756026cc446eae">TensorBuffer&lt;float, Compute::DeviceMemoryResource&gt;</a> gpuBuffer(100);</div>
<div class="ttc" id="aclass_mila_1_1_dnn_1_1_tensor_buffer_html_acc48bf1e1c6d3f9ce6756026cc446eae"><div class="ttname"><a href="#acc48bf1e1c6d3f9ce6756026cc446eae">Mila::Dnn::TensorBuffer::TensorBuffer</a></div><div class="ttdeci">TensorBuffer(size_t size, T value=T{})</div><div class="ttdoc">Constructs a new TensorBuffer object with owned memory and optional value initialization.</div><div class="ttdef"><b>Definition</b> TensorBuffer.ixx:111</div></div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="acc48bf1e1c6d3f9ce6756026cc446eae" name="acc48bf1e1c6d3f9ce6756026cc446eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc48bf1e1c6d3f9ce6756026cc446eae">&#9670;&#160;</a></span>TensorBuffer() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::TensorBuffer </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>value</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T{}</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel explicit">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object with owned memory and optional value initialization. </p>
<p>This constructor allocates memory using the specified memory resource and optionally initializes all elements to the provided value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>The number of elements in the buffer. </td></tr>
    <tr><td class="paramname">value</td><td>Value to initialize the buffer with (default: default-constructed T).</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::overflow_error</td><td>If size is too large, causing overflow in aligned size calculation. </td></tr>
    <tr><td class="paramname">std::bad_alloc</td><td>If memory allocation fails. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4f843cfbf1ce8cc6c7c1f9c4b5af200a" name="a4f843cfbf1ce8cc6c7c1f9c4b5af200a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f843cfbf1ce8cc6c7c1f9c4b5af200a">&#9670;&#160;</a></span>TensorBuffer() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::TensorBuffer </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *</td>          <td class="paramname"><span class="paramname"><em>data_ptr</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object with externally managed memory. </p>
<p>This constructor does not allocate memory but instead wraps the provided pre-allocated memory. The buffer does not take ownership of this memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>The number of elements in the buffer. </td></tr>
    <tr><td class="paramname">data_ptr</td><td>Pointer to the pre-allocated memory.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>If data_ptr is null. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a48faa8a0cc8086b3e3d4063bef00b1d4" name="a48faa8a0cc8086b3e3d4063bef00b1d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48faa8a0cc8086b3e3d4063bef00b1d4">&#9670;&#160;</a></span>~TensorBuffer()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::~<a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">TensorBuffer</a> </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroys the <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object and deallocates memory if owned. </p>
<p>If the buffer owns its memory (mr_ is not null), it will deallocate the memory using the memory resource. If the buffer uses externally managed memory, it will not deallocate anything. </p>

</div>
</div>
<a id="a9ac438ca78c08a4c2ad2e5bc818696ae" name="a9ac438ca78c08a4c2ad2e5bc818696ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ac438ca78c08a4c2ad2e5bc818696ae">&#9670;&#160;</a></span>TensorBuffer() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::TensorBuffer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">TensorBuffer</a>&lt; T, MR &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel delete">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy operations are explicitly deleted. </p>
<p><a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> does not support copying since it may involve deep copying of large memory blocks across different memory spaces. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aaa2e141e0f345ccca9bc53b2b17bdf58" name="aaa2e141e0f345ccca9bc53b2b17bdf58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa2e141e0f345ccca9bc53b2b17bdf58">&#9670;&#160;</a></span>data()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T * <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::data </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a pointer to the buffer's data. </p>
<dl class="section return"><dt>Returns</dt><dd>T* A pointer to the data stored in the buffer. </dd></dl>

</div>
</div>
<a id="a85da3fc48bcde3924abdf0b228bd059c" name="a85da3fc48bcde3924abdf0b228bd059c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85da3fc48bcde3924abdf0b228bd059c">&#9670;&#160;</a></span>fillBuffer()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::fillBuffer </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>value</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T{}</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes the buffer with a specified value. </p>
<p>This method fills the buffer with the specified value, using different approaches depending on whether the buffer is in CPU or GPU memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>Value to initialize the buffer with (default: default-constructed T).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>For CPU memory, SIMD optimizations may be used for larger trivially copyable types. </dd>
<dd>
For GPU memory, a temporary host buffer is created and copied to the device. </dd></dl>

</div>
</div>
<a id="ab18d7d4bfb2cc6ce2ae149a191a3a0eb" name="ab18d7d4bfb2cc6ce2ae149a191a3a0eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab18d7d4bfb2cc6ce2ae149a191a3a0eb">&#9670;&#160;</a></span>is_aligned()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::is_aligned </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the buffer's data pointer is properly aligned. </p>
<p>This method verifies that the buffer's data pointer is aligned according to the alignment requirements of the memory resource.</p>
<dl class="section return"><dt>Returns</dt><dd>bool True if the data pointer is properly aligned, false otherwise. </dd></dl>

</div>
</div>
<a id="a6ade189423d0f2ab93f68a9bca480118" name="a6ade189423d0f2ab93f68a9bca480118"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ade189423d0f2ab93f68a9bca480118">&#9670;&#160;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">TensorBuffer</a> &amp; <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">TensorBuffer</a>&lt; T, MR &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel delete">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a946911e83680e60fd374078c9fe70c4f" name="a946911e83680e60fd374078c9fe70c4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a946911e83680e60fd374078c9fe70c4f">&#9670;&#160;</a></span>resize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::resize </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>new_size</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resizes the buffer to a new size, preserving existing data when possible. </p>
<p>This method allocates a new buffer of the specified size, copies data from the old buffer to the new one (up to the smaller of the old and new sizes), and then deallocates the old buffer. If the new size is larger than the old size, the additional elements are default-initialized.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_size</td><td>The new size of the buffer. Can be zero.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If the buffer is externally managed. </td></tr>
    <tr><td class="paramname">std::overflow_error</td><td>If new_size is too large, causing overflow in aligned size calculation. </td></tr>
    <tr><td class="paramname">std::bad_alloc</td><td>If memory allocation fails. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7f4731fcc1a15d7faf10b5eedc910ff2" name="a7f4731fcc1a15d7faf10b5eedc910ff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f4731fcc1a15d7faf10b5eedc910ff2">&#9670;&#160;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::size </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the size of the buffer. </p>
<dl class="section return"><dt>Returns</dt><dd>size_t The number of elements in the buffer. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aaf352839767ee4d8c3d0c3769e319d6b" name="aaf352839767ee4d8c3d0c3769e319d6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf352839767ee4d8c3d0c3769e319d6b">&#9670;&#160;</a></span>alignment</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::alignment = <a class="el" href="namespace_mila_1_1_dnn_1_1detail.html#af137c7018cb88c2251064731685714a7">detail::get_alignment</a>&lt;MR&gt;()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel constexpr">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The alignment boundary for memory allocation based on the memory resource type. </p>
<p>This value is determined at compile time to ensure optimal memory access patterns for the specific memory resource type (CPU or GPU). </p>

</div>
</div>
<a id="ad65ade365824f6f36cd7fd2e052977b4" name="ad65ade365824f6f36cd7fd2e052977b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad65ade365824f6f36cd7fd2e052977b4">&#9670;&#160;</a></span>data_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T* <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::data_ { nullptr }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A pointer to the allocated memory containing the buffer's data. </p>

</div>
</div>
<a id="a3928ef4134ebd3212136afd1bd31a921" name="a3928ef4134ebd3212136afd1bd31a921"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3928ef4134ebd3212136afd1bd31a921">&#9670;&#160;</a></span>mr_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="namespace_mila_1_1_dnn_1_1_compute.html#aa6456bd950c55c6e678e77a203425149">Compute::MemoryResource</a>&gt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::mr_ { nullptr }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Memory resource used for allocation/deallocation (null for externally managed buffers). </p>

</div>
</div>
<a id="ac3df84f6770181428fb5b6778d8868aa" name="ac3df84f6770181428fb5b6778d8868aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3df84f6770181428fb5b6778d8868aa">&#9670;&#160;</a></span>size_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, typename MR&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR &gt;::size_ { 0 }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of elements in the buffer. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Src/Dnn/<a class="el" href="_tensor_buffer_8ixx.html">TensorBuffer.ixx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_mila.html">Mila</a></li><li class="navelem"><a class="el" href="namespace_mila_1_1_dnn.html">Dnn</a></li><li class="navelem"><a class="el" href="class_mila_1_1_dnn_1_1_tensor_buffer.html">TensorBuffer</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
