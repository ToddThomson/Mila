<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mila: Mila::Dnn::Compute::CpuFullyConnectedOp&lt; TInput, TPrecision &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mila
   </div>
   <div id="projectbrief">Deep Neural Network Library</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('class_mila_1_1_dnn_1_1_compute_1_1_cpu_fully_connected_op.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="class_mila_1_1_dnn_1_1_compute_1_1_cpu_fully_connected_op-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Mila::Dnn::Compute::CpuFullyConnectedOp&lt; TInput, TPrecision &gt; Class Template Reference<span class="mlabels"><span class="mlabel export">export</span></span><div class="ingroups">module <a class="el" href="module___compute_8_cpu_fully_connected_op.html">Compute.CpuFullyConnectedOp</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>CPU implementation of the Fully Connected operation for neural networks.  
 <a href="#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for Mila::Dnn::Compute::CpuFullyConnectedOp&lt; TInput, TPrecision &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_mila_1_1_dnn_1_1_compute_1_1_cpu_fully_connected_op.png" usemap="#Mila::Dnn::Compute::CpuFullyConnectedOp_3C_20TInput_2C_20TPrecision_20_3E_map" alt=""/>
  <map id="Mila::Dnn::Compute::CpuFullyConnectedOp_3C_20TInput_2C_20TPrecision_20_3E_map" name="Mila::Dnn::Compute::CpuFullyConnectedOp_3C_20TInput_2C_20TPrecision_20_3E_map">
<area href="class_mila_1_1_dnn_1_1_compute_1_1_unary_operation.html" alt="Mila::Dnn::Compute::UnaryOperation&lt; TInput, TInput, DeviceType::Cpu &gt;" shape="rect" coords="0,56,423,80"/>
<area href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html" alt="Mila::Dnn::Compute::OperationBase&lt; TInput, TInput, TDeviceType &gt;" shape="rect" coords="0,0,423,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a549f8193d4a8f560f4f48af8895bc9d9" id="r_a549f8193d4a8f560f4f48af8895bc9d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a549f8193d4a8f560f4f48af8895bc9d9">CpuFullyConnectedOp</a> ()</td></tr>
<tr class="memdesc:a549f8193d4a8f560f4f48af8895bc9d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new CPU Fully Connected operation.  <br /></td></tr>
<tr class="separator:a549f8193d4a8f560f4f48af8895bc9d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addb9e120f555221f162857793396ee47" id="r_addb9e120f555221f162857793396ee47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#addb9e120f555221f162857793396ee47">backward</a> (float *dinp, float *dweight, float *dbias, const float *dout, const float *inp, const float *weight, int B, int T, int C, int OC)</td></tr>
<tr class="memdesc:addb9e120f555221f162857793396ee47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the backward pass of the Fully Connected operation.  <br /></td></tr>
<tr class="separator:addb9e120f555221f162857793396ee47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b254f455b9c0586e805915b594d9795" id="r_a8b254f455b9c0586e805915b594d9795"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8b254f455b9c0586e805915b594d9795">forward</a> (const <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TInput, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &amp;input, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TPrecision, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &gt; &gt; &amp;parameters_, const <a class="el" href="struct_mila_1_1_dnn_1_1_compute_1_1_operation_attributes.html">OperationAttributes</a> &amp;properties, <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TPrecision, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &amp;output, std::vector&lt; std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TPrecision, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &gt; &gt; &amp;output_state) const override</td></tr>
<tr class="memdesc:a8b254f455b9c0586e805915b594d9795"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the forward pass of the Fully Connected operation.  <br /></td></tr>
<tr class="separator:a8b254f455b9c0586e805915b594d9795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abffb68942a70ff8bd8916acbc1ed514e" id="r_abffb68942a70ff8bd8916acbc1ed514e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abffb68942a70ff8bd8916acbc1ed514e">getName</a> () const override</td></tr>
<tr class="memdesc:abffb68942a70ff8bd8916acbc1ed514e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the name of this operation.  <br /></td></tr>
<tr class="separator:abffb68942a70ff8bd8916acbc1ed514e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_unary_operation"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_unary_operation')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_unary_operation.html">Mila::Dnn::Compute::UnaryOperation&lt; TInput, TInput, DeviceType::Cpu &gt;</a></td></tr>
<tr class="memitem:a183b29a34bed8278d9b134f0b61e91bb inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_unary_operation" id="r_a183b29a34bed8278d9b134f0b61e91bb"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_unary_operation.html#a183b29a34bed8278d9b134f0b61e91bb">forward</a> (const <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TInput, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_unary_operation.html#a190d43dcf3852d519bc03ae505a11df8">MR</a> &gt; &amp;input, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TInput, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_unary_operation.html#a190d43dcf3852d519bc03ae505a11df8">MR</a> &gt; &gt; &gt; &amp;parameters, const <a class="el" href="struct_mila_1_1_dnn_1_1_compute_1_1_operation_attributes.html">OperationAttributes</a> &amp;properties, <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TInput, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_unary_operation.html#a190d43dcf3852d519bc03ae505a11df8">MR</a> &gt; &amp;output, std::vector&lt; std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TInput, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_unary_operation.html#a190d43dcf3852d519bc03ae505a11df8">MR</a> &gt; &gt; &gt; &amp;output_state) const=0</td></tr>
<tr class="memdesc:a183b29a34bed8278d9b134f0b61e91bb inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_unary_operation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the forward pass of a unary operation.  <br /></td></tr>
<tr class="separator:a183b29a34bed8278d9b134f0b61e91bb inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_unary_operation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html">Mila::Dnn::Compute::OperationBase&lt; TInput, TInput, TDeviceType &gt;</a></td></tr>
<tr class="memitem:ade2eeb6a01c3f49e1e3553be82854387 inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base" id="r_ade2eeb6a01c3f49e1e3553be82854387"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html#ade2eeb6a01c3f49e1e3553be82854387">OperationBase</a> (<a class="el" href="namespace_mila_1_1_dnn_1_1_compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> device_type, <a class="el" href="namespace_mila_1_1_dnn_1_1_compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a> operation_type)</td></tr>
<tr class="memdesc:ade2eeb6a01c3f49e1e3553be82854387 inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs an <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html" title="Base class for all compute operations.">OperationBase</a> object.  <br /></td></tr>
<tr class="separator:ade2eeb6a01c3f49e1e3553be82854387 inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af48032a442a24db3eaddb8045b99cd9b inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base" id="r_af48032a442a24db3eaddb8045b99cd9b"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html#af48032a442a24db3eaddb8045b99cd9b">~OperationBase</a> ()=default</td></tr>
<tr class="memdesc:af48032a442a24db3eaddb8045b99cd9b inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor for the <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html" title="Base class for all compute operations.">OperationBase</a> class.  <br /></td></tr>
<tr class="separator:af48032a442a24db3eaddb8045b99cd9b inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9590bd70f4d453ee52689df13335493e inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base" id="r_a9590bd70f4d453ee52689df13335493e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html#a9590bd70f4d453ee52689df13335493e">backward</a> (const <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TInput, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html#abc52b5efcf69cbfbef78bee9944f49f0">MR</a> &gt; &amp;grad, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TInput, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html#abc52b5efcf69cbfbef78bee9944f49f0">MR</a> &gt; &gt; &gt; &amp;parameters, std::vector&lt; std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TInput, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html#abc52b5efcf69cbfbef78bee9944f49f0">MR</a> &gt; &gt; &gt; &amp;output_grads) const</td></tr>
<tr class="memdesc:a9590bd70f4d453ee52689df13335493e inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the forward pass of the operation.  <br /></td></tr>
<tr class="separator:a9590bd70f4d453ee52689df13335493e inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7991ce6f0a34440fbc0e36798e916ef2 inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base" id="r_a7991ce6f0a34440fbc0e36798e916ef2"><td class="memItemLeft" align="right" valign="top">constexpr <a class="el" href="namespace_mila_1_1_dnn_1_1_compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html#a7991ce6f0a34440fbc0e36798e916ef2">getDeviceType</a> () const</td></tr>
<tr class="memdesc:a7991ce6f0a34440fbc0e36798e916ef2 inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the device type.  <br /></td></tr>
<tr class="separator:a7991ce6f0a34440fbc0e36798e916ef2 inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c67da5a925ddd6bee39b22c325eb603 inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base" id="r_a0c67da5a925ddd6bee39b22c325eb603"><td class="memItemLeft" align="right" valign="top">constexpr <a class="el" href="namespace_mila_1_1_dnn_1_1_compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html#a0c67da5a925ddd6bee39b22c325eb603">getOperationType</a> () const</td></tr>
<tr class="memdesc:a0c67da5a925ddd6bee39b22c325eb603 inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the operation type.  <br /></td></tr>
<tr class="separator:a0c67da5a925ddd6bee39b22c325eb603 inherit pub_methods_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a41f2e1afe0c41e35c25779c1445227d9" id="r_a41f2e1afe0c41e35c25779c1445227d9"><td class="memItemLeft" align="right" valign="top">static const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41f2e1afe0c41e35c25779c1445227d9">className</a> ()</td></tr>
<tr class="memdesc:a41f2e1afe0c41e35c25779c1445227d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the class name of this operation.  <br /></td></tr>
<tr class="separator:a41f2e1afe0c41e35c25779c1445227d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa5dd96110a30c9fb0fc5f433fe536e05" id="r_aa5dd96110a30c9fb0fc5f433fe536e05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5dd96110a30c9fb0fc5f433fe536e05">forward_naive</a> (const <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; float, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &amp;input, const std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; float, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &gt; &amp;weight, const std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; float, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &gt; &amp;bias, <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; float, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &amp;output, int B, int T, int C, int OC) const</td></tr>
<tr class="memdesc:aa5dd96110a30c9fb0fc5f433fe536e05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Naive implementation of the forward pass for the Fully Connected operation.  <br /></td></tr>
<tr class="separator:aa5dd96110a30c9fb0fc5f433fe536e05"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_class_mila_1_1_dnn_1_1_compute_1_1_unary_operation"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_types_class_mila_1_1_dnn_1_1_compute_1_1_unary_operation')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_unary_operation.html">Mila::Dnn::Compute::UnaryOperation&lt; TInput, TInput, DeviceType::Cpu &gt;</a></td></tr>
<tr class="memitem:a190d43dcf3852d519bc03ae505a11df8 inherit pub_types_class_mila_1_1_dnn_1_1_compute_1_1_unary_operation" id="r_a190d43dcf3852d519bc03ae505a11df8"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_unary_operation.html#a190d43dcf3852d519bc03ae505a11df8">MR</a></td></tr>
<tr class="separator:a190d43dcf3852d519bc03ae505a11df8 inherit pub_types_class_mila_1_1_dnn_1_1_compute_1_1_unary_operation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_types_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_types_class_mila_1_1_dnn_1_1_compute_1_1_operation_base')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html">Mila::Dnn::Compute::OperationBase&lt; TInput, TInput, TDeviceType &gt;</a></td></tr>
<tr class="memitem:abc52b5efcf69cbfbef78bee9944f49f0 inherit pub_types_class_mila_1_1_dnn_1_1_compute_1_1_operation_base" id="r_abc52b5efcf69cbfbef78bee9944f49f0"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html#abc52b5efcf69cbfbef78bee9944f49f0">MR</a></td></tr>
<tr class="separator:abc52b5efcf69cbfbef78bee9944f49f0 inherit pub_types_class_mila_1_1_dnn_1_1_compute_1_1_operation_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename TInput, typename TPrecision = TInput&gt;<br />
class Mila::Dnn::Compute::CpuFullyConnectedOp&lt; TInput, TPrecision &gt;</div><p>CPU implementation of the Fully Connected operation for neural networks. </p>
<p>This class provides a CPU-based implementation of the Fully Connected operation, which performs a matrix multiplication between the input and a weight matrix, optionally adds a bias, and produces an output. This operation implements the standard linear layer commonly used in neural networks.</p>
<p>The implementation includes both a performance-optimized version with loop unrolling and a naive fallback implementation for special cases.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TInput</td><td>The data type of the input tensor elements. </td></tr>
    <tr><td class="paramname">TPrecision</td><td>The data type used for computation and output (defaults to the input type). </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a549f8193d4a8f560f4f48af8895bc9d9" name="a549f8193d4a8f560f4f48af8895bc9d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a549f8193d4a8f560f4f48af8895bc9d9">&#9670;&#160;</a></span>CpuFullyConnectedOp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput, typename TPrecision = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_cpu_fully_connected_op.html">Mila::Dnn::Compute::CpuFullyConnectedOp</a>&lt; TInput, TPrecision &gt;::CpuFullyConnectedOp </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new CPU Fully Connected operation. </p>
<p>Initializes the operation with the CPU device type and FullyConnectedOp operation type. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="addb9e120f555221f162857793396ee47" name="addb9e120f555221f162857793396ee47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addb9e120f555221f162857793396ee47">&#9670;&#160;</a></span>backward()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput, typename TPrecision = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_cpu_fully_connected_op.html">Mila::Dnn::Compute::CpuFullyConnectedOp</a>&lt; TInput, TPrecision &gt;::backward </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>dinp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>dweight</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>dbias</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>dout</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>inp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>weight</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>T</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>C</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>OC</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the backward pass of the Fully Connected operation. </p>
<p>Computes gradients with respect to inputs, weights, and biases based on the output gradient.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dinp</td><td>Pointer to the gradient buffer for input. </td></tr>
    <tr><td class="paramname">dweight</td><td>Pointer to the gradient buffer for weight parameters. </td></tr>
    <tr><td class="paramname">dbias</td><td>Pointer to the gradient buffer for bias parameters (can be NULL if no bias is used). </td></tr>
    <tr><td class="paramname">dout</td><td>Pointer to the gradient buffer from the output. </td></tr>
    <tr><td class="paramname">inp</td><td>Pointer to the original input values. </td></tr>
    <tr><td class="paramname">weight</td><td>Pointer to the weight parameters. </td></tr>
    <tr><td class="paramname">B</td><td>Batch size. </td></tr>
    <tr><td class="paramname">T</td><td>Sequence length. </td></tr>
    <tr><td class="paramname">C</td><td>Input feature dimension. </td></tr>
    <tr><td class="paramname">OC</td><td>Output feature dimension. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a41f2e1afe0c41e35c25779c1445227d9" name="a41f2e1afe0c41e35c25779c1445227d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41f2e1afe0c41e35c25779c1445227d9">&#9670;&#160;</a></span>className()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput, typename TPrecision = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const std::string &amp; <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_cpu_fully_connected_op.html">Mila::Dnn::Compute::CpuFullyConnectedOp</a>&lt; TInput, TPrecision &gt;::className </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the class name of this operation. </p>
<dl class="section return"><dt>Returns</dt><dd>const std::string&amp; The class name of the operation. </dd></dl>

</div>
</div>
<a id="a8b254f455b9c0586e805915b594d9795" name="a8b254f455b9c0586e805915b594d9795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b254f455b9c0586e805915b594d9795">&#9670;&#160;</a></span>forward()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput, typename TPrecision = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_cpu_fully_connected_op.html">Mila::Dnn::Compute::CpuFullyConnectedOp</a>&lt; TInput, TPrecision &gt;::forward </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TInput, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TPrecision, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>parameters_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_mila_1_1_dnn_1_1_compute_1_1_operation_attributes.html">OperationAttributes</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>properties</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TPrecision, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; TPrecision, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>output_state</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel override">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the forward pass of the Fully Connected operation. </p>
<p>Computes the matrix multiplication between input and weights, adds bias if provided, and stores the result in the output tensor. Uses loop unrolling for performance optimization when possible, otherwise falls back to a naive implementation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Input tensor of shape [B, T, C] where B is batch size, T is sequence length, and C is input feature dimension. </td></tr>
    <tr><td class="paramname">parameters</td><td>Vector of parameter tensors [weight, bias] where weight is of shape [OC, C] and bias (optional) is of shape [OC]. </td></tr>
    <tr><td class="paramname">properties</td><td>Additional attributes for the operation. </td></tr>
    <tr><td class="paramname">output</td><td>Output tensor of shape [B, T, OC] where OC is output feature dimension. </td></tr>
    <tr><td class="paramname">output_state</td><td>Cache for intermediate results (not used in this operation). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa5dd96110a30c9fb0fc5f433fe536e05" name="aa5dd96110a30c9fb0fc5f433fe536e05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5dd96110a30c9fb0fc5f433fe536e05">&#9670;&#160;</a></span>forward_naive()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput, typename TPrecision = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_cpu_fully_connected_op.html">Mila::Dnn::Compute::CpuFullyConnectedOp</a>&lt; TInput, TPrecision &gt;::forward_naive </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; float, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; float, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>weight</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; float, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>bias</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_mila_1_1_dnn_1_1_tensor.html">Tensor</a>&lt; float, <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_host_memory_resource.html">HostMemoryResource</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>T</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>C</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>OC</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Naive implementation of the forward pass for the Fully Connected operation. </p>
<p>This is a simple implementation without optimizations that serves as a fallback for cases where the optimized implementation cannot be used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>Input tensor. </td></tr>
    <tr><td class="paramname">weight</td><td>Weight tensor. </td></tr>
    <tr><td class="paramname">bias</td><td>Bias tensor (optional). </td></tr>
    <tr><td class="paramname">output</td><td>Output tensor. </td></tr>
    <tr><td class="paramname">B</td><td>Batch size. </td></tr>
    <tr><td class="paramname">T</td><td>Sequence length. </td></tr>
    <tr><td class="paramname">C</td><td>Input feature dimension. </td></tr>
    <tr><td class="paramname">OC</td><td>Output feature dimension. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abffb68942a70ff8bd8916acbc1ed514e" name="abffb68942a70ff8bd8916acbc1ed514e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abffb68942a70ff8bd8916acbc1ed514e">&#9670;&#160;</a></span>getName()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput, typename TPrecision = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_cpu_fully_connected_op.html">Mila::Dnn::Compute::CpuFullyConnectedOp</a>&lt; TInput, TPrecision &gt;::getName </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel override">override</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the name of this operation. </p>
<dl class="section return"><dt>Returns</dt><dd>std::string The name of the operation ("Cpu::MatMulOp"). </dd></dl>

<p>Implements <a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_operation_base.html#a9c4531f4e686ee70e776f8900542dedd">Mila::Dnn::Compute::OperationBase&lt; TInput, TInput, TDeviceType &gt;</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Src/Dnn/Compute/CPU/Ops/<a class="el" href="_cpu_fully_connected_op_8ixx.html">CpuFullyConnectedOp.ixx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_mila.html">Mila</a></li><li class="navelem"><a class="el" href="namespace_mila_1_1_dnn.html">Dnn</a></li><li class="navelem"><a class="el" href="namespace_mila_1_1_dnn_1_1_compute.html">Compute</a></li><li class="navelem"><a class="el" href="class_mila_1_1_dnn_1_1_compute_1_1_cpu_fully_connected_op.html">CpuFullyConnectedOp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
