<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mila: Mila::Dnn::Compute::CudaResidualOp&lt; TInput, TOutput &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mila
   </div>
   <div id="projectbrief">Deep Neural Network Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Mila::Dnn::Compute::CudaResidualOp&lt; TInput, TOutput &gt; Class Template Reference<span class="mlabels"><span class="mlabel">export</span></span><div class="ingroups">module <a class="el" href="module_Compute_8CudaResidualOp.html">Compute.CudaResidualOp</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>CUDA implementation of the residual operation for neural networks.  
 <a href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for Mila::Dnn::Compute::CudaResidualOp&lt; TInput, TOutput &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp__inherit__graph.png" border="0" usemap="#aMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_3_01TInput_00_01TOutput_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="aMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_3_01TInput_00_01TOutput_01_4_inherit__map" id="aMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_3_01TInput_00_01TOutput_01_4_inherit__map">
<area shape="rect" title="CUDA implementation of the residual operation for neural networks." alt="" coords="21,225,218,280"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html" title="Abstract class for binary operations in the neural network framework." alt="" coords="17,108,221,177"/>
<area shape="poly" title=" " alt="" coords="122,191,122,225,117,225,117,191"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html" title="Base class for all compute operations in the Mila neural network framework." alt="" coords="5,5,233,60"/>
<area shape="poly" title=" " alt="" coords="122,74,122,108,117,108,117,74"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Mila::Dnn::Compute::CudaResidualOp&lt; TInput, TOutput &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp__coll__graph.png" border="0" usemap="#aMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_3_01TInput_00_01TOutput_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="aMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_3_01TInput_00_01TOutput_01_4_coll__map" id="aMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_3_01TInput_00_01TOutput_01_4_coll__map">
<area shape="rect" title="CUDA implementation of the residual operation for neural networks." alt="" coords="585,49,783,103"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html" title="Abstract class for binary operations in the neural network framework." alt="" coords="283,5,487,75"/>
<area shape="poly" title=" " alt="" coords="501,51,585,62,585,67,500,57"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html" title="Base class for all compute operations in the Mila neural network framework." alt="" coords="5,13,233,67"/>
<area shape="poly" title=" " alt="" coords="247,37,283,37,283,43,247,43"/>
<area shape="rect" href="classMila_1_1Dnn_1_1ResidualConfig.html" title="Configuration class for Residual connection module." alt="" coords="290,99,479,125"/>
<area shape="poly" title=" " alt="" coords="493,96,585,85,585,90,493,102"/>
<area shape="rect" href="classMila_1_1Dnn_1_1ComponentConfig.html" title="Base configuration class for all neural network components." alt="" coords="15,99,223,125"/>
<area shape="poly" title=" " alt="" coords="237,109,290,109,290,115,237,115"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ac1d71ebd614d6ecfb5f0e991d30c5134" id="r_ac1d71ebd614d6ecfb5f0e991d30c5134"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ac1d71ebd614d6ecfb5f0e991d30c5134">BinaryOperationBase</a> = <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html">BinaryOperation</a>&lt; <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4a8b95dcff7397d0693c03e394af5552aa">DeviceType::Cuda</a>, TInput, TInput, TOutput &gt;</td></tr>
<tr class="separator:ac1d71ebd614d6ecfb5f0e991d30c5134"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab143511c7fe6602f967ea9605f891d3d" id="r_ab143511c7fe6602f967ea9605f891d3d"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> = typename <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaDevice.html#a338488d5ff948cc1d945a611789d8a54">CudaDevice::MR</a></td></tr>
<tr class="separator:ab143511c7fe6602f967ea9605f891d3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_types_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html">Mila::Dnn::Compute::BinaryOperation&lt; TDeviceType, TInput1, TInput2, TOutput &gt;</a></td></tr>
<tr class="memitem:aa3188912d10541f6dc6e1d634256c1df inherit pub_types_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation" id="r_aa3188912d10541f6dc6e1d634256c1df"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> = std::conditional_t&lt; TDeviceType==<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4a8b95dcff7397d0693c03e394af5552aa">DeviceType::Cuda</a>, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaMemoryResource.html">CudaMemoryResource</a>, <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a8c32f3f7cc6e4ef70be850a0cf5b9a62">HostMemoryResource</a> &gt;</td></tr>
<tr class="memdesc:aa3188912d10541f6dc6e1d634256c1df inherit pub_types_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory resource type based on device type.  <br /></td></tr>
<tr class="separator:aa3188912d10541f6dc6e1d634256c1df inherit pub_types_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa0093dacb265fe344e1dbc62267fb64f" id="r_aa0093dacb265fe344e1dbc62267fb64f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#aa0093dacb265fe344e1dbc62267fb64f">CudaResidualOp</a> (const <a class="el" href="classMila_1_1Dnn_1_1ResidualConfig.html">ResidualConfig</a> &amp;config)</td></tr>
<tr class="memdesc:aa0093dacb265fe344e1dbc62267fb64f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new CUDA <a class="el" href="classMila_1_1Dnn_1_1Residual.html" title="A class implementing a residual connection module.">Residual</a> operation with the default device context.  <br /></td></tr>
<tr class="separator:aa0093dacb265fe344e1dbc62267fb64f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0105bcf6121016a596da14f8a81abc03" id="r_a0105bcf6121016a596da14f8a81abc03"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#a0105bcf6121016a596da14f8a81abc03">CudaResidualOp</a> (std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt; context, const <a class="el" href="classMila_1_1Dnn_1_1ResidualConfig.html">ResidualConfig</a> &amp;config)</td></tr>
<tr class="memdesc:a0105bcf6121016a596da14f8a81abc03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new CUDA <a class="el" href="classMila_1_1Dnn_1_1Residual.html" title="A class implementing a residual connection module.">Residual</a> operation with a specific device context.  <br /></td></tr>
<tr class="separator:a0105bcf6121016a596da14f8a81abc03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11a441c2cf618193df424a6c331e626e" id="r_a11a441c2cf618193df424a6c331e626e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#a11a441c2cf618193df424a6c331e626e">backward</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;input1, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;input2, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;output, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;output_gradient, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &gt; &gt; &amp;parameters, std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &gt; &gt; &amp;parameter_gradients, <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;input1_gradient, <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;input2_gradient, const <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html">OperationAttributes</a> &amp;properties, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &gt; &gt; &amp;output_state) const</td></tr>
<tr class="memdesc:a11a441c2cf618193df424a6c331e626e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the backward pass of the residual operation.  <br /></td></tr>
<tr class="separator:a11a441c2cf618193df424a6c331e626e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78097b5b3f08a4c23bf679b07af7394f" id="r_a78097b5b3f08a4c23bf679b07af7394f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#a78097b5b3f08a4c23bf679b07af7394f">forward</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;input1, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;input2, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &gt; &gt; &amp;parameters, const <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html">OperationAttributes</a> &amp;properties, <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;output, std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &gt; &gt; &amp;output_state) const override</td></tr>
<tr class="memdesc:a78097b5b3f08a4c23bf679b07af7394f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the forward pass of the residual operation on CUDA.  <br /></td></tr>
<tr class="separator:a78097b5b3f08a4c23bf679b07af7394f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ece71350153dafd74b135c8b053bf71" id="r_a3ece71350153dafd74b135c8b053bf71"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#a3ece71350153dafd74b135c8b053bf71">getName</a> () const override</td></tr>
<tr class="memdesc:a3ece71350153dafd74b135c8b053bf71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the name of this operation.  <br /></td></tr>
<tr class="separator:a3ece71350153dafd74b135c8b053bf71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html">Mila::Dnn::Compute::BinaryOperation&lt; TDeviceType, TInput1, TInput2, TOutput &gt;</a></td></tr>
<tr class="memitem:a31ba6dc901db187ec6dbd71a9fc62890 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation" id="r_a31ba6dc901db187ec6dbd71a9fc62890"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#a31ba6dc901db187ec6dbd71a9fc62890">BinaryOperation</a> (<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a> operation_type)</td></tr>
<tr class="memdesc:a31ba6dc901db187ec6dbd71a9fc62890 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html" title="Abstract class for binary operations in the neural network framework.">BinaryOperation</a> with the specified operation type and precision policy.  <br /></td></tr>
<tr class="separator:a31ba6dc901db187ec6dbd71a9fc62890 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40d809f85c88d8402ec2eef31c11defa inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation" id="r_a40d809f85c88d8402ec2eef31c11defa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#a40d809f85c88d8402ec2eef31c11defa">BinaryOperation</a> (<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a> operation_type, std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt; context)</td></tr>
<tr class="memdesc:a40d809f85c88d8402ec2eef31c11defa inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html" title="Abstract class for binary operations in the neural network framework.">BinaryOperation</a> with the specified operation type, device context, and precision policy.  <br /></td></tr>
<tr class="separator:a40d809f85c88d8402ec2eef31c11defa inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04b2c59505c925fa714560fca701a04f inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation" id="r_a04b2c59505c925fa714560fca701a04f"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#a04b2c59505c925fa714560fca701a04f">~BinaryOperation</a> ()=default</td></tr>
<tr class="memdesc:a04b2c59505c925fa714560fca701a04f inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor for proper cleanup of derived classes.  <br /></td></tr>
<tr class="separator:a04b2c59505c925fa714560fca701a04f inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a224879bb0f17f41ee392945ca9900a96 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation" id="r_a224879bb0f17f41ee392945ca9900a96"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#a224879bb0f17f41ee392945ca9900a96">backward</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput1, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &amp;input1, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput2, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &amp;input2, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &amp;output, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &amp;output_gradient, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput1, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &gt; &gt; &amp;parameters, std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &gt; &gt; &amp;parameter_gradients, <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput1, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &amp;input1_gradient, <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput2, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &amp;input2_gradient, const <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html">OperationAttributes</a> &amp;attributes, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &gt; &gt; &amp;output_state) const</td></tr>
<tr class="memdesc:a224879bb0f17f41ee392945ca9900a96 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the backward pass of a binary operation.  <br /></td></tr>
<tr class="separator:a224879bb0f17f41ee392945ca9900a96 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b5b6791d444a1cbc30ed69bfa47c737 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation" id="r_a0b5b6791d444a1cbc30ed69bfa47c737"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#a0b5b6791d444a1cbc30ed69bfa47c737">forward</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput1, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &amp;input1, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput2, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &amp;input2, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput1, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &gt; &gt; &amp;parameters, const <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html">OperationAttributes</a> &amp;attributes, <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &amp;output, std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html#aa3188912d10541f6dc6e1d634256c1df">MR</a> &gt; &gt; &gt; &amp;output_state) const =0</td></tr>
<tr class="memdesc:a0b5b6791d444a1cbc30ed69bfa47c737 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the forward pass of a binary operation.  <br /></td></tr>
<tr class="separator:a0b5b6791d444a1cbc30ed69bfa47c737 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1BinaryOperation"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html">Mila::Dnn::Compute::OperationBase&lt; TDeviceType, TInput1, TInput2, TOutput &gt;</a></td></tr>
<tr class="memitem:aa04b0c9dbbb8618926b38f9f72866f9c inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase" id="r_aa04b0c9dbbb8618926b38f9f72866f9c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#aa04b0c9dbbb8618926b38f9f72866f9c">OperationBase</a> (<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a> operation_type, std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt; context)</td></tr>
<tr class="memdesc:aa04b0c9dbbb8618926b38f9f72866f9c inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs an <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html" title="Base class for all compute operations in the Mila neural network framework.">OperationBase</a> object with a specific device context and compute precision.  <br /></td></tr>
<tr class="separator:aa04b0c9dbbb8618926b38f9f72866f9c inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c5dc486a89b9f74303c7c5314e014c8 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase" id="r_a3c5dc486a89b9f74303c7c5314e014c8"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a3c5dc486a89b9f74303c7c5314e014c8">~OperationBase</a> ()=default</td></tr>
<tr class="memdesc:a3c5dc486a89b9f74303c7c5314e014c8 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor for the <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html" title="Base class for all compute operations in the Mila neural network framework.">OperationBase</a> class.  <br /></td></tr>
<tr class="separator:a3c5dc486a89b9f74303c7c5314e014c8 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89f65f9750a87e52fdc8f8095f18ba9a inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase" id="r_a89f65f9750a87e52fdc8f8095f18ba9a"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a89f65f9750a87e52fdc8f8095f18ba9a">getDeviceContext</a> () const</td></tr>
<tr class="memdesc:a89f65f9750a87e52fdc8f8095f18ba9a inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the device context associated with this operation.  <br /></td></tr>
<tr class="separator:a89f65f9750a87e52fdc8f8095f18ba9a inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14eb1f77c85ff4fc2f53300500d65185 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase" id="r_a14eb1f77c85ff4fc2f53300500d65185"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a14eb1f77c85ff4fc2f53300500d65185">getDeviceType</a> () const</td></tr>
<tr class="memdesc:a14eb1f77c85ff4fc2f53300500d65185 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the device type for this operation.  <br /></td></tr>
<tr class="separator:a14eb1f77c85ff4fc2f53300500d65185 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb4008133679e313261a2096af05499 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase" id="r_a9fb4008133679e313261a2096af05499"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a9fb4008133679e313261a2096af05499">getOperationType</a> () const</td></tr>
<tr class="memdesc:a9fb4008133679e313261a2096af05499 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the operation type enumeration value.  <br /></td></tr>
<tr class="separator:a9fb4008133679e313261a2096af05499 inherit pub_methods_classMila_1_1Dnn_1_1Compute_1_1OperationBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a263f73d6f2dbda99bca0f3b478bf8bc6" id="r_a263f73d6f2dbda99bca0f3b478bf8bc6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMila_1_1Dnn_1_1ResidualConfig.html">ResidualConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#a263f73d6f2dbda99bca0f3b478bf8bc6">config_</a></td></tr>
<tr class="memdesc:a263f73d6f2dbda99bca0f3b478bf8bc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration for the residual operation.  <br /></td></tr>
<tr class="separator:a263f73d6f2dbda99bca0f3b478bf8bc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename TInput, typename TOutput = TInput&gt;<br />
requires ValidFloatTensorTypes&lt;TInput, TOutput&gt;<br />
class Mila::Dnn::Compute::CudaResidualOp&lt; TInput, TOutput &gt;</div><p>CUDA implementation of the residual operation for neural networks. </p>
<p>This class provides a CUDA-based implementation of the residual operation, which performs element-wise addition of two input tensors. It is commonly used in residual connections in neural network architectures such as ResNet and Transformers to help with gradient flow and mitigate the vanishing gradient problem. The implementation is optimized for NVIDIA GPUs.</p>
<p>The implementation leverages CUDA for GPU acceleration, providing efficient computation for large neural network models. It also supports different precision modes via the <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputePrecision.html" title="Controls automatic mixed precision behavior for neural network operations.">ComputePrecision</a> policy.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TInput</td><td>The data type of both input tensor elements. </td></tr>
    <tr><td class="paramname">TOutput</td><td>The data type of the output tensor elements (defaults to TInput). </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="ac1d71ebd614d6ecfb5f0e991d30c5134" name="ac1d71ebd614d6ecfb5f0e991d30c5134"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1d71ebd614d6ecfb5f0e991d30c5134">&#9670;&#160;</a></span>BinaryOperationBase</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput , typename TOutput  = TInput&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html">Mila::Dnn::Compute::CudaResidualOp</a>&lt; TInput, TOutput &gt;::BinaryOperationBase =  <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html">BinaryOperation</a>&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4a8b95dcff7397d0693c03e394af5552aa">DeviceType::Cuda</a>, TInput, TInput, TOutput&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab143511c7fe6602f967ea9605f891d3d" name="ab143511c7fe6602f967ea9605f891d3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab143511c7fe6602f967ea9605f891d3d">&#9670;&#160;</a></span>MR</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput , typename TOutput  = TInput&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html">Mila::Dnn::Compute::CudaResidualOp</a>&lt; TInput, TOutput &gt;::MR =  typename <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaDevice.html#a338488d5ff948cc1d945a611789d8a54">CudaDevice::MR</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa0093dacb265fe344e1dbc62267fb64f" name="aa0093dacb265fe344e1dbc62267fb64f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0093dacb265fe344e1dbc62267fb64f">&#9670;&#160;</a></span>CudaResidualOp() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput , typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html">Mila::Dnn::Compute::CudaResidualOp</a>&lt; TInput, TOutput &gt;::CudaResidualOp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1ResidualConfig.html">ResidualConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new CUDA <a class="el" href="classMila_1_1Dnn_1_1Residual.html" title="A class implementing a residual connection module.">Residual</a> operation with the default device context. </p>
<p>Initializes the operation with a CUDA device context (defaults to CUDA:0).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">precision_policy</td><td>The precision policy to use for mixed precision computation. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0105bcf6121016a596da14f8a81abc03" name="a0105bcf6121016a596da14f8a81abc03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0105bcf6121016a596da14f8a81abc03">&#9670;&#160;</a></span>CudaResidualOp() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput , typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html">Mila::Dnn::Compute::CudaResidualOp</a>&lt; TInput, TOutput &gt;::CudaResidualOp </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1ResidualConfig.html">ResidualConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new CUDA <a class="el" href="classMila_1_1Dnn_1_1Residual.html" title="A class implementing a residual connection module.">Residual</a> operation with a specific device context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>The device context to use for this operation. </td></tr>
    <tr><td class="paramname">precision_policy</td><td>The precision policy to use for mixed precision computation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If the context is not for a CUDA device. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a11a441c2cf618193df424a6c331e626e" name="a11a441c2cf618193df424a6c331e626e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11a441c2cf618193df424a6c331e626e">&#9670;&#160;</a></span>backward()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput , typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html">Mila::Dnn::Compute::CudaResidualOp</a>&lt; TInput, TOutput &gt;::backward </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output_gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameter_gradients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input1_gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input2_gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html">OperationAttributes</a> &amp;&#160;</td>
          <td class="paramname"><em>properties</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>output_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the backward pass of the residual operation. </p>
<p>Computes gradients with respect to both inputs by propagating the output gradient to each input.</p>
<p>The precision policy affects the computation in the same way as the forward pass.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input1</td><td>First input tensor from the forward pass. </td></tr>
    <tr><td class="paramname">input2</td><td>Second input tensor from the forward pass. </td></tr>
    <tr><td class="paramname">output</td><td>Output tensor from the forward pass. </td></tr>
    <tr><td class="paramname">output_gradient</td><td>Gradient of the loss with respect to the output. </td></tr>
    <tr><td class="paramname">parameters</td><td>Parameters tensor from forward pass (not used in this operation). </td></tr>
    <tr><td class="paramname">parameter_gradients</td><td>Gradients for parameters (not used in this operation). </td></tr>
    <tr><td class="paramname">input1_gradient</td><td>Gradient of the loss with respect to input1. </td></tr>
    <tr><td class="paramname">input2_gradient</td><td>Gradient of the loss with respect to input2. </td></tr>
    <tr><td class="paramname">properties</td><td>Additional attributes for the operation. </td></tr>
    <tr><td class="paramname">output_state</td><td>Cache tensors from forward pass (not used in this operation). </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_a11a441c2cf618193df424a6c331e626e_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_a11a441c2cf618193df424a6c331e626e_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_a11a441c2cf618193df424a6c331e626e_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_a11a441c2cf618193df424a6c331e626e_cgraph">
<area shape="rect" title="Performs the backward pass of the residual operation." alt="" coords="5,163,213,203"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html#aa7d911be367de341882a9cf94d73284d" title="Gets a pointer to the tensor data with memory type safety." alt="" coords="280,5,451,31"/>
<area shape="poly" title=" " alt="" coords="124,161,180,102,218,69,260,41,278,33,280,38,263,46,221,73,184,105,128,165"/>
<area shape="rect" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html#a9712639fc255b962192c2095135c45a7" title="Helper method to get values from the propsMap with type safety." alt="" coords="272,55,459,95"/>
<area shape="poly" title=" " alt="" coords="145,161,199,133,260,105,280,97,282,102,262,110,201,138,148,166"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a89f65f9750a87e52fdc8f8095f18ba9a" title="Gets the device context associated with this operation." alt="" coords="265,120,465,175"/>
<area shape="poly" title=" " alt="" coords="213,166,252,161,252,166,214,171"/>
<area shape="rect" href="classMila_1_1Dnn_1_1ComponentConfig.html#a86aa2b04575c0dcb3feca075ab44e66f" title="Gets the configured precision policy." alt="" coords="261,199,469,239"/>
<area shape="poly" title=" " alt="" coords="214,195,248,200,247,205,213,201"/>
<area shape="rect" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html#a4f37c7b515d519ad422f8aea3b54d0a0" title="Check if a custom property exists in the propsMap." alt="" coords="271,263,460,303"/>
<area shape="poly" title=" " alt="" coords="153,201,262,249,284,256,282,261,260,254,151,206"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html#af952a34808a4ad53bc9588854ddd8592" title=" " alt="" coords="281,328,449,353"/>
<area shape="poly" title=" " alt="" coords="130,202,185,258,222,288,263,313,282,321,279,326,260,318,219,292,182,262,126,206"/>
</map>
</div>

</div>
</div>
<a id="a78097b5b3f08a4c23bf679b07af7394f" name="a78097b5b3f08a4c23bf679b07af7394f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78097b5b3f08a4c23bf679b07af7394f">&#9670;&#160;</a></span>forward()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput , typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html">Mila::Dnn::Compute::CudaResidualOp</a>&lt; TInput, TOutput &gt;::forward </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationAttributes.html">OperationAttributes</a> &amp;&#160;</td>
          <td class="paramname"><em>properties</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html#ab143511c7fe6602f967ea9605f891d3d">MR</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>output_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the forward pass of the residual operation on CUDA. </p>
<p>Adds two input tensors element-wise and stores the result in the output tensor. The computation is performed on the GPU using CUDA kernels for optimal performance.</p>
<p>The precision policy affects how the computation is performed:</p><ul>
<li>Performance: May use faster but less precise algorithms</li>
<li>Accuracy: Will use the most accurate algorithm available</li>
<li>Auto: Will select an appropriate balance based on the hardware</li>
<li>Disabled: Will use the standard precision of the input/output types</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input1</td><td>The first input tensor to be added. </td></tr>
    <tr><td class="paramname">input2</td><td>The second input tensor to be added. </td></tr>
    <tr><td class="paramname">parameters</td><td>Additional parameters (not used in this operation). </td></tr>
    <tr><td class="paramname">properties</td><td>Additional attributes for the operation. </td></tr>
    <tr><td class="paramname">output</td><td>The output tensor where the results will be stored. </td></tr>
    <tr><td class="paramname">output_state</td><td>Cache for intermediate results (not used in this operation). </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_a78097b5b3f08a4c23bf679b07af7394f_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_a78097b5b3f08a4c23bf679b07af7394f_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_a78097b5b3f08a4c23bf679b07af7394f_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1CudaResidualOp_a78097b5b3f08a4c23bf679b07af7394f_cgraph">
<area shape="rect" title="Performs the forward pass of the residual operation on CUDA." alt="" coords="5,117,200,157"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a89f65f9750a87e52fdc8f8095f18ba9a" title="Gets the device context associated with this operation." alt="" coords="252,5,452,60"/>
<area shape="poly" title=" " alt="" coords="147,114,247,70,265,63,267,68,249,75,149,119"/>
<area shape="rect" href="classMila_1_1Dnn_1_1ComponentConfig.html#a86aa2b04575c0dcb3feca075ab44e66f" title="Gets the configured precision policy." alt="" coords="248,85,456,125"/>
<area shape="poly" title=" " alt="" coords="200,122,234,117,235,122,200,127"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html#a4f707ea4c0f00aab58189071fa1c11fd" title="Gets a raw pointer to the tensor data for use in CUDA kernels." alt="" coords="281,149,423,189"/>
<area shape="poly" title=" " alt="" coords="200,146,267,155,266,160,200,152"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html#af952a34808a4ad53bc9588854ddd8592" title=" " alt="" coords="268,213,436,239"/>
<area shape="poly" title=" " alt="" coords="145,154,249,198,279,207,278,212,247,203,143,159"/>
</map>
</div>

</div>
</div>
<a id="a3ece71350153dafd74b135c8b053bf71" name="a3ece71350153dafd74b135c8b053bf71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ece71350153dafd74b135c8b053bf71">&#9670;&#160;</a></span>getName()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput , typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html">Mila::Dnn::Compute::CudaResidualOp</a>&lt; TInput, TOutput &gt;::getName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the name of this operation. </p>
<dl class="section return"><dt>Returns</dt><dd>std::string The name of the operation ("Cuda::ResidualOp"). </dd></dl>

<p>Implements <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationBase.html#a63a8c032751878a9259ecd4335e629b4">Mila::Dnn::Compute::OperationBase&lt; TDeviceType, TInput1, TInput2, TOutput &gt;</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a263f73d6f2dbda99bca0f3b478bf8bc6" name="a263f73d6f2dbda99bca0f3b478bf8bc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a263f73d6f2dbda99bca0f3b478bf8bc6">&#9670;&#160;</a></span>config_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TInput , typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1ResidualConfig.html">ResidualConfig</a> <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html">Mila::Dnn::Compute::CudaResidualOp</a>&lt; TInput, TOutput &gt;::config_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configuration for the residual operation. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/runner/work/Mila/Mila/Mila/Src/Dnn/Compute/Operations/Cuda/<a class="el" href="CudaResidualOp_8ixx.html">CudaResidualOp.ixx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceMila.html">Mila</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn.html">Dnn</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html">Compute</a></li><li class="navelem"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOp.html">CudaResidualOp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
