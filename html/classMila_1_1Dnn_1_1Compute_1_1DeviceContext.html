<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mila: Mila::Dnn::Compute::DeviceContext Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mila
   </div>
   <div id="projectbrief">Deep Neural Network Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Mila::Dnn::Compute::DeviceContext Class Reference<span class="mlabels"><span class="mlabel">export</span></span><div class="ingroups">module <a class="el" href="module_Compute_8DeviceContext.html">Compute.DeviceContext</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a> class manages device contexts for module and tensor computations.  
 <a href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6f44384ca21e685f62cefe14e717fb7a" id="r_a6f44384ca21e685f62cefe14e717fb7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a6f44384ca21e685f62cefe14e717fb7a">DeviceContext</a> (const <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;)=delete</td></tr>
<tr class="separator:a6f44384ca21e685f62cefe14e717fb7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66052215400fe2b037fc7e490722ebf0" id="r_a66052215400fe2b037fc7e490722ebf0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a66052215400fe2b037fc7e490722ebf0">DeviceContext</a> (const std::string &amp;device_name)</td></tr>
<tr class="memdesc:a66052215400fe2b037fc7e490722ebf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor with a specific device.  <br /></td></tr>
<tr class="separator:a66052215400fe2b037fc7e490722ebf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a25b92fbd26db5f10fa4bec8d611e2" id="r_a22a25b92fbd26db5f10fa4bec8d611e2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a22a25b92fbd26db5f10fa4bec8d611e2">DeviceContext</a> (<a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;other) noexcept</td></tr>
<tr class="separator:a22a25b92fbd26db5f10fa4bec8d611e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab38f3619ed2c3c117a833b21d3223b61" id="r_ab38f3619ed2c3c117a833b21d3223b61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ab38f3619ed2c3c117a833b21d3223b61">~DeviceContext</a> ()</td></tr>
<tr class="memdesc:ab38f3619ed2c3c117a833b21d3223b61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="separator:ab38f3619ed2c3c117a833b21d3223b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77f02b7b4dc653665c239c61bbe6cee0" id="r_a77f02b7b4dc653665c239c61bbe6cee0"><td class="memItemLeft" align="right" valign="top">cublasLtHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a77f02b7b4dc653665c239c61bbe6cee0">getCublasLtHandle</a> ()</td></tr>
<tr class="memdesc:a77f02b7b4dc653665c239c61bbe6cee0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the cuBLASLt handle, initializing it if necessary.  <br /></td></tr>
<tr class="separator:a77f02b7b4dc653665c239c61bbe6cee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cbfe23abf282a478ca3333b11cbc576" id="r_a6cbfe23abf282a478ca3333b11cbc576"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputeDevice.html">ComputeDevice</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a6cbfe23abf282a478ca3333b11cbc576">getDevice</a> () const</td></tr>
<tr class="memdesc:a6cbfe23abf282a478ca3333b11cbc576"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current device.  <br /></td></tr>
<tr class="separator:a6cbfe23abf282a478ca3333b11cbc576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27d011f69f1b145adc30a0d6bd9347ba" id="r_a27d011f69f1b145adc30a0d6bd9347ba"><td class="memItemLeft" align="right" valign="top">cudaStream_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a27d011f69f1b145adc30a0d6bd9347ba">getStream</a> () const</td></tr>
<tr class="memdesc:a27d011f69f1b145adc30a0d6bd9347ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current CUDA stream.  <br /></td></tr>
<tr class="separator:a27d011f69f1b145adc30a0d6bd9347ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0be82bb15781cc2d3239b7cea4da717" id="r_aa0be82bb15781cc2d3239b7cea4da717"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa0be82bb15781cc2d3239b7cea4da717">isCudaDevice</a> () const</td></tr>
<tr class="memdesc:aa0be82bb15781cc2d3239b7cea4da717"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the current device is a CUDA device.  <br /></td></tr>
<tr class="separator:aa0be82bb15781cc2d3239b7cea4da717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4105deade514dfadccff3d9b21a6c4ed" id="r_a4105deade514dfadccff3d9b21a6c4ed"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a4105deade514dfadccff3d9b21a6c4ed">isDeviceType</a> (<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> type) const</td></tr>
<tr class="memdesc:a4105deade514dfadccff3d9b21a6c4ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the current device is of a specific type.  <br /></td></tr>
<tr class="separator:a4105deade514dfadccff3d9b21a6c4ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf003ce328f957580880f66d6b31facd" id="r_acf003ce328f957580880f66d6b31facd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#acf003ce328f957580880f66d6b31facd">operator=</a> (const <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;)=delete</td></tr>
<tr class="separator:acf003ce328f957580880f66d6b31facd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a883e401e8e1be2c8513a95e99a7e4235" id="r_a883e401e8e1be2c8513a95e99a7e4235"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a883e401e8e1be2c8513a95e99a7e4235">operator=</a> (<a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;other) noexcept</td></tr>
<tr class="separator:a883e401e8e1be2c8513a95e99a7e4235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adec58c226e24c7d4a0d9ba6b5119874d" id="r_adec58c226e24c7d4a0d9ba6b5119874d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#adec58c226e24c7d4a0d9ba6b5119874d">synchronize</a> ()</td></tr>
<tr class="memdesc:adec58c226e24c7d4a0d9ba6b5119874d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the cuDNN handle, initializing it if necessary.  <br /></td></tr>
<tr class="separator:adec58c226e24c7d4a0d9ba6b5119874d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a439bcf09aae78c73d84fd6bc5b3d4469" id="r_a439bcf09aae78c73d84fd6bc5b3d4469"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a439bcf09aae78c73d84fd6bc5b3d4469">initializeDeviceResources</a> ()</td></tr>
<tr class="memdesc:a439bcf09aae78c73d84fd6bc5b3d4469"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes resources specific to the current device.  <br /></td></tr>
<tr class="separator:a439bcf09aae78c73d84fd6bc5b3d4469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9c7afccb46ad4b1afbe83bc5d861b32" id="r_aa9c7afccb46ad4b1afbe83bc5d861b32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#aa9c7afccb46ad4b1afbe83bc5d861b32">moveFrom</a> (<a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;other)</td></tr>
<tr class="memdesc:aa9c7afccb46ad4b1afbe83bc5d861b32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Moves resources from another <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a>.  <br /></td></tr>
<tr class="separator:aa9c7afccb46ad4b1afbe83bc5d861b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3da2632ad08d0ef326d3a51ed3c46284" id="r_a3da2632ad08d0ef326d3a51ed3c46284"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a3da2632ad08d0ef326d3a51ed3c46284">releaseResources</a> ()</td></tr>
<tr class="memdesc:a3da2632ad08d0ef326d3a51ed3c46284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases all device-specific resources.  <br /></td></tr>
<tr class="separator:a3da2632ad08d0ef326d3a51ed3c46284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e36e81342090136e9f33153a73165e0" id="r_a8e36e81342090136e9f33153a73165e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a8e36e81342090136e9f33153a73165e0">setDevice</a> (const std::string &amp;device_name)</td></tr>
<tr class="memdesc:a8e36e81342090136e9f33153a73165e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the current device by name.  <br /></td></tr>
<tr class="separator:a8e36e81342090136e9f33153a73165e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a136f6950f3a605a18f610b031e9a0f39" id="r_a136f6950f3a605a18f610b031e9a0f39"><td class="memItemLeft" align="right" valign="top">cublasLtHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a136f6950f3a605a18f610b031e9a0f39">cublasLtHandle_</a> = nullptr</td></tr>
<tr class="separator:a136f6950f3a605a18f610b031e9a0f39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c82a66fd608ea99c9aef3baf4b173ce" id="r_a7c82a66fd608ea99c9aef3baf4b173ce"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputeDevice.html">ComputeDevice</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a7c82a66fd608ea99c9aef3baf4b173ce">device_</a></td></tr>
<tr class="separator:a7c82a66fd608ea99c9aef3baf4b173ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae80a515e01d0f15cf53d30f4a52c76be" id="r_ae80a515e01d0f15cf53d30f4a52c76be"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#ae80a515e01d0f15cf53d30f4a52c76be">handle_mutex_</a></td></tr>
<tr class="separator:ae80a515e01d0f15cf53d30f4a52c76be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17a79f6d2f52b8ba67087d4085c2dc8d" id="r_a17a79f6d2f52b8ba67087d4085c2dc8d"><td class="memItemLeft" align="right" valign="top">cudaStream_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a17a79f6d2f52b8ba67087d4085c2dc8d">stream_</a> = nullptr</td></tr>
<tr class="separator:a17a79f6d2f52b8ba67087d4085c2dc8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a273d229110a273c367e37339148e2034" id="r_a273d229110a273c367e37339148e2034"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html#a273d229110a273c367e37339148e2034">stream_created_</a> = false</td></tr>
<tr class="separator:a273d229110a273c367e37339148e2034"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a> class manages device contexts for module and tensor computations. </p>
<p>This class provides functionality for managing compute devices and their associated resources, such as CUDA streams and optional cuBLASLt and cuDNN handles. Multiple instances can be created to manage different devices. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a66052215400fe2b037fc7e490722ebf0" name="a66052215400fe2b037fc7e490722ebf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66052215400fe2b037fc7e490722ebf0">&#9670;&#160;</a></span>DeviceContext() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Compute::DeviceContext::DeviceContext </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>device_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor with a specific device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device_name</td><td>The name of the device to use (e.g., "CUDA:0", "CPU"). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab38f3619ed2c3c117a833b21d3223b61" name="ab38f3619ed2c3c117a833b21d3223b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab38f3619ed2c3c117a833b21d3223b61">&#9670;&#160;</a></span>~DeviceContext()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Compute::DeviceContext::~DeviceContext </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<p>Cleans up any associated resources. </p>

</div>
</div>
<a id="a6f44384ca21e685f62cefe14e717fb7a" name="a6f44384ca21e685f62cefe14e717fb7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f44384ca21e685f62cefe14e717fb7a">&#9670;&#160;</a></span>DeviceContext() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Compute::DeviceContext::DeviceContext </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a22a25b92fbd26db5f10fa4bec8d611e2" name="a22a25b92fbd26db5f10fa4bec8d611e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22a25b92fbd26db5f10fa4bec8d611e2">&#9670;&#160;</a></span>DeviceContext() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Compute::DeviceContext::DeviceContext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a77f02b7b4dc653665c239c61bbe6cee0" name="a77f02b7b4dc653665c239c61bbe6cee0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77f02b7b4dc653665c239c61bbe6cee0">&#9670;&#160;</a></span>getCublasLtHandle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cublasLtHandle_t Mila::Dnn::Compute::DeviceContext::getCublasLtHandle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the cuBLASLt handle, initializing it if necessary. </p>
<dl class="section return"><dt>Returns</dt><dd>The cuBLASLt handle. </dd></dl>

</div>
</div>
<a id="a6cbfe23abf282a478ca3333b11cbc576" name="a6cbfe23abf282a478ca3333b11cbc576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cbfe23abf282a478ca3333b11cbc576">&#9670;&#160;</a></span>getDevice()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputeDevice.html">ComputeDevice</a> &gt; Mila::Dnn::Compute::DeviceContext::getDevice </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the current device. </p>
<dl class="section return"><dt>Returns</dt><dd>A shared pointer to the current device. </dd></dl>

</div>
</div>
<a id="a27d011f69f1b145adc30a0d6bd9347ba" name="a27d011f69f1b145adc30a0d6bd9347ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27d011f69f1b145adc30a0d6bd9347ba">&#9670;&#160;</a></span>getStream()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cudaStream_t Mila::Dnn::Compute::DeviceContext::getStream </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the current CUDA stream. </p>
<dl class="section return"><dt>Returns</dt><dd>The current CUDA stream, or nullptr if not using CUDA. </dd></dl>

</div>
</div>
<a id="a439bcf09aae78c73d84fd6bc5b3d4469" name="a439bcf09aae78c73d84fd6bc5b3d4469"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a439bcf09aae78c73d84fd6bc5b3d4469">&#9670;&#160;</a></span>initializeDeviceResources()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::DeviceContext::initializeDeviceResources </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes resources specific to the current device. </p>

</div>
</div>
<a id="aa0be82bb15781cc2d3239b7cea4da717" name="aa0be82bb15781cc2d3239b7cea4da717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0be82bb15781cc2d3239b7cea4da717">&#9670;&#160;</a></span>isCudaDevice()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Mila::Dnn::Compute::DeviceContext::isCudaDevice </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the current device is a CUDA device. </p>
<dl class="section return"><dt>Returns</dt><dd>bool True if the device is a CUDA device </dd></dl>

</div>
</div>
<a id="a4105deade514dfadccff3d9b21a6c4ed" name="a4105deade514dfadccff3d9b21a6c4ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4105deade514dfadccff3d9b21a6c4ed">&#9670;&#160;</a></span>isDeviceType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Mila::Dnn::Compute::DeviceContext::isDeviceType </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the current device is of a specific type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>The device type to check against </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool True if the device matches the specified type </dd></dl>

</div>
</div>
<a id="aa9c7afccb46ad4b1afbe83bc5d861b32" name="aa9c7afccb46ad4b1afbe83bc5d861b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9c7afccb46ad4b1afbe83bc5d861b32">&#9670;&#160;</a></span>moveFrom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::DeviceContext::moveFrom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Moves resources from another <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html" title="The DeviceContext class manages device contexts for module and tensor computations.">DeviceContext</a> to move from. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acf003ce328f957580880f66d6b31facd" name="acf003ce328f957580880f66d6b31facd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf003ce328f957580880f66d6b31facd">&#9670;&#160;</a></span>operator=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp; Mila::Dnn::Compute::DeviceContext::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a883e401e8e1be2c8513a95e99a7e4235" name="a883e401e8e1be2c8513a95e99a7e4235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a883e401e8e1be2c8513a95e99a7e4235">&#9670;&#160;</a></span>operator=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp; Mila::Dnn::Compute::DeviceContext::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3da2632ad08d0ef326d3a51ed3c46284" name="a3da2632ad08d0ef326d3a51ed3c46284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3da2632ad08d0ef326d3a51ed3c46284">&#9670;&#160;</a></span>releaseResources()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::DeviceContext::releaseResources </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Releases all device-specific resources. </p>

</div>
</div>
<a id="a8e36e81342090136e9f33153a73165e0" name="a8e36e81342090136e9f33153a73165e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e36e81342090136e9f33153a73165e0">&#9670;&#160;</a></span>setDevice()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::DeviceContext::setDevice </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>device_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the current device by name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device_name</td><td>The name of the device to set. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>if the device name is invalid. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adec58c226e24c7d4a0d9ba6b5119874d" name="adec58c226e24c7d4a0d9ba6b5119874d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adec58c226e24c7d4a0d9ba6b5119874d">&#9670;&#160;</a></span>synchronize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::DeviceContext::synchronize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the cuDNN handle, initializing it if necessary. </p>
<dl class="section return"><dt>Returns</dt><dd>The cuDNN handle.</dd></dl>
<p>Synchronizes the device, waiting for all operations to complete. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a136f6950f3a605a18f610b031e9a0f39" name="a136f6950f3a605a18f610b031e9a0f39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a136f6950f3a605a18f610b031e9a0f39">&#9670;&#160;</a></span>cublasLtHandle_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cublasLtHandle_t Mila::Dnn::Compute::DeviceContext::cublasLtHandle_ = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7c82a66fd608ea99c9aef3baf4b173ce" name="a7c82a66fd608ea99c9aef3baf4b173ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c82a66fd608ea99c9aef3baf4b173ce">&#9670;&#160;</a></span>device_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputeDevice.html">ComputeDevice</a>&gt; Mila::Dnn::Compute::DeviceContext::device_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae80a515e01d0f15cf53d30f4a52c76be" name="ae80a515e01d0f15cf53d30f4a52c76be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae80a515e01d0f15cf53d30f4a52c76be">&#9670;&#160;</a></span>handle_mutex_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex Mila::Dnn::Compute::DeviceContext::handle_mutex_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a17a79f6d2f52b8ba67087d4085c2dc8d" name="a17a79f6d2f52b8ba67087d4085c2dc8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17a79f6d2f52b8ba67087d4085c2dc8d">&#9670;&#160;</a></span>stream_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cudaStream_t Mila::Dnn::Compute::DeviceContext::stream_ = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a273d229110a273c367e37339148e2034" name="a273d229110a273c367e37339148e2034"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a273d229110a273c367e37339148e2034">&#9670;&#160;</a></span>stream_created_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Mila::Dnn::Compute::DeviceContext::stream_created_ = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Src/Dnn/Compute/<a class="el" href="DeviceContext_8ixx.html">DeviceContext.ixx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceMila.html">Mila</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn.html">Dnn</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html">Compute</a></li><li class="navelem"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
