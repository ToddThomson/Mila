<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mila: Mila::Dnn::Gpt2::DatasetReader Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mila
   </div>
   <div id="projectbrief">Deep Neural Network Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Mila::Dnn::Gpt2::DatasetReader Class Reference<span class="mlabels"><span class="mlabel">export</span></span><div class="ingroups">module <a class="el" href="module_Dnn_8Gpt2_8DatasetReader.html">Dnn.Gpt2.DatasetReader</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>High-performance data loading class for GPT-2 tokenized datasets with multi-threaded processing.  
 <a href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Mila::Dnn::Gpt2::DatasetReader:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader__coll__graph.png" border="0" usemap="#aMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_coll__map" alt="Collaboration graph"/></div>
<map name="aMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_coll__map" id="aMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_coll__map">
<area shape="rect" title="High&#45;performance data loading class for GPT&#45;2 tokenized datasets with multi&#45;threaded processing." alt="" coords="5,108,188,148"/>
<area shape="rect" href="structMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_1_1Config.html" title="Configuration parameters for the DatasetReader." alt="" coords="5,5,188,45"/>
<area shape="poly" title=" " alt="" coords="99,59,99,108,94,108,94,59"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_1_1Config.html">Config</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration parameters for the <a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html" title="High-performance data loading class for GPT-2 tokenized datasets with multi-threaded processing.">DatasetReader</a>.  <a href="structMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_1_1Config.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad0becd1ab2c5ad4476ffc1641695be46" id="r_ad0becd1ab2c5ad4476ffc1641695be46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#ad0becd1ab2c5ad4476ffc1641695be46">DatasetReader</a> (const std::string &amp;file_path, size_t batch_size, size_t seq_len, const <a class="el" href="structMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_1_1Config.html">Config</a> &amp;config=<a class="el" href="structMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_1_1Config.html">Config</a>())</td></tr>
<tr class="memdesc:ad0becd1ab2c5ad4476ffc1641695be46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new <a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html" title="High-performance data loading class for GPT-2 tokenized datasets with multi-threaded processing.">DatasetReader</a> object.  <br /></td></tr>
<tr class="separator:ad0becd1ab2c5ad4476ffc1641695be46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78a086d97f70ba9e65b1523ba5f3ed6b" id="r_a78a086d97f70ba9e65b1523ba5f3ed6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a78a086d97f70ba9e65b1523ba5f3ed6b">~DatasetReader</a> ()</td></tr>
<tr class="memdesc:a78a086d97f70ba9e65b1523ba5f3ed6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the <a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html" title="High-performance data loading class for GPT-2 tokenized datasets with multi-threaded processing.">DatasetReader</a> object.  <br /></td></tr>
<tr class="separator:a78a086d97f70ba9e65b1523ba5f3ed6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1005b191ed88ad8a8339b79fd4cfcf88" id="r_a1005b191ed88ad8a8339b79fd4cfcf88"><td class="memTemplParams" colspan="2">template&lt;typename <a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a>  = DeviceTensor&lt;int&gt;&gt; <br />
requires (std::same_as&lt;<a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a>, <a class="el" href="namespaceMila_1_1Dnn.html#afde383107a015717518430d36c30e47d">HostTensor</a>&lt;int&gt;&gt; || std::same_as&lt;<a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a>, <a class="el" href="namespaceMila_1_1Dnn.html#ae60b4150d02b2ba1bb5ebbd08020da10">PinnedTensor</a>&lt;int&gt;&gt; || std::same_as&lt;<a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a>, <a class="el" href="namespaceMila_1_1Dnn.html#aeb0a38da8dd43e6946ab760de52cccd5">DeviceTensor</a>&lt;int&gt;&gt;)</td></tr>
<tr class="memitem:a1005b191ed88ad8a8339b79fd4cfcf88"><td class="memTemplItemLeft" align="right" valign="top">std::pair&lt; <a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a>, <a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a1005b191ed88ad8a8339b79fd4cfcf88">next_batch</a> ()</td></tr>
<tr class="memdesc:a1005b191ed88ad8a8339b79fd4cfcf88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetches the next batch of training data with inputs and targets.  <br /></td></tr>
<tr class="separator:a1005b191ed88ad8a8339b79fd4cfcf88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b9299498ee1856adf7cec6f3de33ad2" id="r_a7b9299498ee1856adf7cec6f3de33ad2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a7b9299498ee1856adf7cec6f3de33ad2">pause</a> ()</td></tr>
<tr class="memdesc:a7b9299498ee1856adf7cec6f3de33ad2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pauses the background loading threads.  <br /></td></tr>
<tr class="separator:a7b9299498ee1856adf7cec6f3de33ad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e737054014353f50b829494783d6ca" id="r_a92e737054014353f50b829494783d6ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a92e737054014353f50b829494783d6ca">resume</a> ()</td></tr>
<tr class="memdesc:a92e737054014353f50b829494783d6ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resumes the background loading threads after being paused.  <br /></td></tr>
<tr class="separator:a92e737054014353f50b829494783d6ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a8bc5d3c2343b4b8a195a8cf181321dfe" id="r_a8bc5d3c2343b4b8a195a8cf181321dfe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a8bc5d3c2343b4b8a195a8cf181321dfe">allocate_memory</a> (int *&amp;buffer)</td></tr>
<tr class="memdesc:a8bc5d3c2343b4b8a195a8cf181321dfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates memory for tensor buffers.  <br /></td></tr>
<tr class="separator:a8bc5d3c2343b4b8a195a8cf181321dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7435f4b9336c4cabf538a9d822e39b2e" id="r_a7435f4b9336c4cabf538a9d822e39b2e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a7435f4b9336c4cabf538a9d822e39b2e">free_memory</a> (int *&amp;buffer)</td></tr>
<tr class="memdesc:a7435f4b9336c4cabf538a9d822e39b2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees previously allocated memory.  <br /></td></tr>
<tr class="separator:a7435f4b9336c4cabf538a9d822e39b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e653608603d8507891d91ba3271e21e" id="r_a5e653608603d8507891d91ba3271e21e"><td class="memItemLeft" align="right" valign="top">std::span&lt; const int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a5e653608603d8507891d91ba3271e21e">get_tokens</a> (size_t position, size_t count)</td></tr>
<tr class="memdesc:a5e653608603d8507891d91ba3271e21e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a non-owning view of tokens at the specified position.  <br /></td></tr>
<tr class="separator:a5e653608603d8507891d91ba3271e21e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11045457f4f74e62434b7f9bb3dbf3a" id="r_ab11045457f4f74e62434b7f9bb3dbf3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#ab11045457f4f74e62434b7f9bb3dbf3a">initialize_dataset</a> ()</td></tr>
<tr class="memdesc:ab11045457f4f74e62434b7f9bb3dbf3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the dataset access without loading the entire file into memory.  <br /></td></tr>
<tr class="separator:ab11045457f4f74e62434b7f9bb3dbf3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a543827d3e6b6b4cfe18e7ee0311b8db6" id="r_a543827d3e6b6b4cfe18e7ee0311b8db6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a543827d3e6b6b4cfe18e7ee0311b8db6">load_window</a> (size_t start_token)</td></tr>
<tr class="memdesc:a543827d3e6b6b4cfe18e7ee0311b8db6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads a specific window of tokens from the dataset file.  <br /></td></tr>
<tr class="separator:a543827d3e6b6b4cfe18e7ee0311b8db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a349b72115549800243e8d0b887179520" id="r_a349b72115549800243e8d0b887179520"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a349b72115549800243e8d0b887179520">log</a> (const std::string &amp;message, int level)</td></tr>
<tr class="memdesc:a349b72115549800243e8d0b887179520"><td class="mdescLeft">&#160;</td><td class="mdescRight">Logs messages through the configured logger.  <br /></td></tr>
<tr class="separator:a349b72115549800243e8d0b887179520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa225047bffb4b063e6083798f82b9dae" id="r_aa225047bffb4b063e6083798f82b9dae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#aa225047bffb4b063e6083798f82b9dae">preprocess_batches</a> ()</td></tr>
<tr class="memdesc:aa225047bffb4b063e6083798f82b9dae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Background thread function that preprocesses raw data into input/target pairs.  <br /></td></tr>
<tr class="separator:aa225047bffb4b063e6083798f82b9dae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85bf5d58022ab1c18ae4e45d5a43293a" id="r_a85bf5d58022ab1c18ae4e45d5a43293a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a85bf5d58022ab1c18ae4e45d5a43293a">read_from_disk</a> ()</td></tr>
<tr class="memdesc:a85bf5d58022ab1c18ae4e45d5a43293a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Background thread function that reads data from the dataset file.  <br /></td></tr>
<tr class="separator:a85bf5d58022ab1c18ae4e45d5a43293a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a0856874191d8878481bbeac18749634b" id="r_a0856874191d8878481bbeac18749634b"><td class="memItemLeft" align="right" valign="top">std::queue&lt; std::pair&lt; int *, int * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a0856874191d8878481bbeac18749634b">batch_queue_</a></td></tr>
<tr class="memdesc:a0856874191d8878481bbeac18749634b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue for preprocessed input/target pairs.  <br /></td></tr>
<tr class="separator:a0856874191d8878481bbeac18749634b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85c842f2c0c2714a2f3fd692e8854775" id="r_a85c842f2c0c2714a2f3fd692e8854775"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a85c842f2c0c2714a2f3fd692e8854775">batch_size_</a></td></tr>
<tr class="memdesc:a85c842f2c0c2714a2f3fd692e8854775"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of sequences in each batch.  <br /></td></tr>
<tr class="separator:a85c842f2c0c2714a2f3fd692e8854775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa564f0411e5c37be03bd516a71ba3647" id="r_aa564f0411e5c37be03bd516a71ba3647"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_1_1Config.html">Config</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#aa564f0411e5c37be03bd516a71ba3647">config_</a></td></tr>
<tr class="memdesc:aa564f0411e5c37be03bd516a71ba3647"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration settings.  <br /></td></tr>
<tr class="separator:aa564f0411e5c37be03bd516a71ba3647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1fab35adb39ab4d45ef2a4fda016cc5" id="r_ac1fab35adb39ab4d45ef2a4fda016cc5"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#ac1fab35adb39ab4d45ef2a4fda016cc5">control_mutex_</a></td></tr>
<tr class="memdesc:ac1fab35adb39ab4d45ef2a4fda016cc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex for control operations.  <br /></td></tr>
<tr class="separator:ac1fab35adb39ab4d45ef2a4fda016cc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bd7b5600ced0142dff86c6bb2137583" id="r_a2bd7b5600ced0142dff86c6bb2137583"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a2bd7b5600ced0142dff86c6bb2137583">current_window_end_</a></td></tr>
<tr class="memdesc:a2bd7b5600ced0142dff86c6bb2137583"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last token index in current window.  <br /></td></tr>
<tr class="separator:a2bd7b5600ced0142dff86c6bb2137583"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a388a45156a769b6303ffb90b5ae3a6f5" id="r_a388a45156a769b6303ffb90b5ae3a6f5"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a388a45156a769b6303ffb90b5ae3a6f5">current_window_start_</a></td></tr>
<tr class="memdesc:a388a45156a769b6303ffb90b5ae3a6f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">First token index in current window.  <br /></td></tr>
<tr class="separator:a388a45156a769b6303ffb90b5ae3a6f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03725d33f0075e55e71ad327961f8829" id="r_a03725d33f0075e55e71ad327961f8829"><td class="memItemLeft" align="right" valign="top">std::condition_variable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a03725d33f0075e55e71ad327961f8829">cv_io_</a></td></tr>
<tr class="memdesc:a03725d33f0075e55e71ad327961f8829"><td class="mdescLeft">&#160;</td><td class="mdescRight">Condition variable for I/O thread synchronization.  <br /></td></tr>
<tr class="separator:a03725d33f0075e55e71ad327961f8829"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107cd1ce267cd1a9bda272fc5599479f" id="r_a107cd1ce267cd1a9bda272fc5599479f"><td class="memItemLeft" align="right" valign="top">std::condition_variable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a107cd1ce267cd1a9bda272fc5599479f">cv_processing_</a></td></tr>
<tr class="memdesc:a107cd1ce267cd1a9bda272fc5599479f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Condition variable for processing thread synchronization.  <br /></td></tr>
<tr class="separator:a107cd1ce267cd1a9bda272fc5599479f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c2d0cecb62785875ca7958bcff2d76" id="r_a21c2d0cecb62785875ca7958bcff2d76"><td class="memItemLeft" align="right" valign="top">std::ifstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a21c2d0cecb62785875ca7958bcff2d76">file_</a></td></tr>
<tr class="memdesc:a21c2d0cecb62785875ca7958bcff2d76"><td class="mdescLeft">&#160;</td><td class="mdescRight">File stream for the dataset.  <br /></td></tr>
<tr class="separator:a21c2d0cecb62785875ca7958bcff2d76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6043dc52370b5ae8804eea1a422cd001" id="r_a6043dc52370b5ae8804eea1a422cd001"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a6043dc52370b5ae8804eea1a422cd001">file_path_</a></td></tr>
<tr class="memdesc:a6043dc52370b5ae8804eea1a422cd001"><td class="mdescLeft">&#160;</td><td class="mdescRight">Path to the dataset file.  <br /></td></tr>
<tr class="separator:a6043dc52370b5ae8804eea1a422cd001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3013230574ed2626886c4d555f96ed02" id="r_a3013230574ed2626886c4d555f96ed02"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a3013230574ed2626886c4d555f96ed02">file_size_</a></td></tr>
<tr class="memdesc:a3013230574ed2626886c4d555f96ed02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the dataset file in bytes.  <br /></td></tr>
<tr class="separator:a3013230574ed2626886c4d555f96ed02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d0f191730c3553cee5f9ad24e5edf14" id="r_a0d0f191730c3553cee5f9ad24e5edf14"><td class="memItemLeft" align="right" valign="top">std::thread&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a0d0f191730c3553cee5f9ad24e5edf14">io_thread_</a></td></tr>
<tr class="memdesc:a0d0f191730c3553cee5f9ad24e5edf14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread for disk I/O operations.  <br /></td></tr>
<tr class="separator:a0d0f191730c3553cee5f9ad24e5edf14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dbfc511cd10726090486c17dca9fa07" id="r_a9dbfc511cd10726090486c17dca9fa07"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a9dbfc511cd10726090486c17dca9fa07">mutex_</a></td></tr>
<tr class="memdesc:a9dbfc511cd10726090486c17dca9fa07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex for protecting shared queues.  <br /></td></tr>
<tr class="separator:a9dbfc511cd10726090486c17dca9fa07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa2e24c32ef16233e7ee6a4c7464230" id="r_a3fa2e24c32ef16233e7ee6a4c7464230"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a3fa2e24c32ef16233e7ee6a4c7464230">num_tokens_</a></td></tr>
<tr class="memdesc:a3fa2e24c32ef16233e7ee6a4c7464230"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of tokens in the dataset.  <br /></td></tr>
<tr class="separator:a3fa2e24c32ef16233e7ee6a4c7464230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37826a7817e59d325540397f97a44308" id="r_a37826a7817e59d325540397f97a44308"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a37826a7817e59d325540397f97a44308">paused_</a> { false }</td></tr>
<tr class="memdesc:a37826a7817e59d325540397f97a44308"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to signal threads to pause.  <br /></td></tr>
<tr class="separator:a37826a7817e59d325540397f97a44308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b7fdeb547045cfceaaaf800e5a5da40" id="r_a6b7fdeb547045cfceaaaf800e5a5da40"><td class="memItemLeft" align="right" valign="top">int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a6b7fdeb547045cfceaaaf800e5a5da40">pinned_inputs_</a></td></tr>
<tr class="memdesc:a6b7fdeb547045cfceaaaf800e5a5da40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer for input tensors.  <br /></td></tr>
<tr class="separator:a6b7fdeb547045cfceaaaf800e5a5da40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a351f816b912efdbe20e995ba59c54bdd" id="r_a351f816b912efdbe20e995ba59c54bdd"><td class="memItemLeft" align="right" valign="top">int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a351f816b912efdbe20e995ba59c54bdd">pinned_targets_</a></td></tr>
<tr class="memdesc:a351f816b912efdbe20e995ba59c54bdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer for target tensors.  <br /></td></tr>
<tr class="separator:a351f816b912efdbe20e995ba59c54bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa176d5820bf776fd58916bf4885e524a" id="r_aa176d5820bf776fd58916bf4885e524a"><td class="memItemLeft" align="right" valign="top">std::thread&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#aa176d5820bf776fd58916bf4885e524a">processing_thread_</a></td></tr>
<tr class="memdesc:aa176d5820bf776fd58916bf4885e524a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread for data preprocessing.  <br /></td></tr>
<tr class="separator:aa176d5820bf776fd58916bf4885e524a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c9434637fcaa733fec38b9bb1ad0f9d" id="r_a2c9434637fcaa733fec38b9bb1ad0f9d"><td class="memItemLeft" align="right" valign="top">std::queue&lt; int * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a2c9434637fcaa733fec38b9bb1ad0f9d">raw_data_queue_</a></td></tr>
<tr class="memdesc:a2c9434637fcaa733fec38b9bb1ad0f9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue for raw data batches.  <br /></td></tr>
<tr class="separator:a2c9434637fcaa733fec38b9bb1ad0f9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f13345adc3a44482cb47dbd8b6fbbf4" id="r_a3f13345adc3a44482cb47dbd8b6fbbf4"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a3f13345adc3a44482cb47dbd8b6fbbf4">seq_len_</a></td></tr>
<tr class="memdesc:a3f13345adc3a44482cb47dbd8b6fbbf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Length of each sequence in tokens.  <br /></td></tr>
<tr class="separator:a3f13345adc3a44482cb47dbd8b6fbbf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a7a8e2b3c026be767e82cc57e124a39" id="r_a2a7a8e2b3c026be767e82cc57e124a39"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a2a7a8e2b3c026be767e82cc57e124a39">stop_</a> { false }</td></tr>
<tr class="memdesc:a2a7a8e2b3c026be767e82cc57e124a39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to signal threads to stop.  <br /></td></tr>
<tr class="separator:a2a7a8e2b3c026be767e82cc57e124a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a216d3a3eff65eb540aa444cc693bdc7f" id="r_a216d3a3eff65eb540aa444cc693bdc7f"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; int[]&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a216d3a3eff65eb540aa444cc693bdc7f">token_window_</a></td></tr>
<tr class="memdesc:a216d3a3eff65eb540aa444cc693bdc7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Window buffer for tokens.  <br /></td></tr>
<tr class="separator:a216d3a3eff65eb540aa444cc693bdc7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a438cd8013d3a4aeb624d6cede65ac5d7" id="r_a438cd8013d3a4aeb624d6cede65ac5d7"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a438cd8013d3a4aeb624d6cede65ac5d7">token_window_size_</a></td></tr>
<tr class="memdesc:a438cd8013d3a4aeb624d6cede65ac5d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of token window in tokens.  <br /></td></tr>
<tr class="separator:a438cd8013d3a4aeb624d6cede65ac5d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>High-performance data loading class for GPT-2 tokenized datasets with multi-threaded processing. </p>
<p>The <a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html" title="High-performance data loading class for GPT-2 tokenized datasets with multi-threaded processing.">DatasetReader</a> class provides an efficient way to read, preprocess, and batch tokenized datasets for language model training. It implements a multi-threaded pipeline with background I/O operations and preprocessing to minimize training latency:</p><ul>
<li>Streams data from files using a sliding window approach</li>
<li>Supports pinned memory allocation for efficient GPU transfers</li>
<li>Implements a producer-consumer pattern with configurable queue sizes</li>
<li>Can be paused and resumed for controlled resource utilization</li>
<li>Automatically handles dataset wrap-around for continuous training </li>
</ul>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad0becd1ab2c5ad4476ffc1641695be46" name="ad0becd1ab2c5ad4476ffc1641695be46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0becd1ab2c5ad4476ffc1641695be46">&#9670;&#160;</a></span>DatasetReader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Gpt2::DatasetReader::DatasetReader </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>file_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>batch_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>seq_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_1_1Config.html">Config</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em> = <code><a class="el" href="structMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_1_1Config.html">Config</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new <a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html" title="High-performance data loading class for GPT-2 tokenized datasets with multi-threaded processing.">DatasetReader</a> object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file_path</td><td>Path to the tokenized dataset file containing integers. </td></tr>
    <tr><td class="paramname">batch_size</td><td>Number of sequences in each batch. </td></tr>
    <tr><td class="paramname">seq_len</td><td>Length of each sequence in tokens. </td></tr>
    <tr><td class="paramname">config</td><td>Additional configuration parameters.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>If batch_size or seq_len is zero. </td></tr>
    <tr><td class="paramname">std::runtime_error</td><td>If file operations fail or memory allocation fails.</td></tr>
  </table>
  </dd>
</dl>
<p>The constructor performs several initialization steps:</p><ol type="1">
<li>Opens the dataset file and initializes window-based streaming access</li>
<li>Allocates memory for input/target tensors (using pinned memory if CUDA is available)</li>
<li>Starts background threads for parallel I/O and preprocessing </li>
</ol>

</div>
</div>
<a id="a78a086d97f70ba9e65b1523ba5f3ed6b" name="a78a086d97f70ba9e65b1523ba5f3ed6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78a086d97f70ba9e65b1523ba5f3ed6b">&#9670;&#160;</a></span>~DatasetReader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Gpt2::DatasetReader::~DatasetReader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroys the <a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html" title="High-performance data loading class for GPT-2 tokenized datasets with multi-threaded processing.">DatasetReader</a> object. </p>
<p>Safely stops all background threads and releases allocated memory. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8bc5d3c2343b4b8a195a8cf181321dfe" name="a8bc5d3c2343b4b8a195a8cf181321dfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bc5d3c2343b4b8a195a8cf181321dfe">&#9670;&#160;</a></span>allocate_memory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Gpt2::DatasetReader::allocate_memory </td>
          <td>(</td>
          <td class="paramtype">int *&amp;&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocates memory for tensor buffers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>Reference to pointer that will hold the allocated memory.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If CUDA memory allocation fails. </td></tr>
    <tr><td class="paramname">std::bad_alloc</td><td>If standard memory allocation fails.</td></tr>
  </table>
  </dd>
</dl>
<p>Attempts to allocate CUDA pinned memory for optimal performance. Falls back to standard allocation if CUDA is not available. </p>

</div>
</div>
<a id="a7435f4b9336c4cabf538a9d822e39b2e" name="a7435f4b9336c4cabf538a9d822e39b2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7435f4b9336c4cabf538a9d822e39b2e">&#9670;&#160;</a></span>free_memory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Gpt2::DatasetReader::free_memory </td>
          <td>(</td>
          <td class="paramtype">int *&amp;&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Frees previously allocated memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>Reference to pointer to free and nullify. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5e653608603d8507891d91ba3271e21e" name="a5e653608603d8507891d91ba3271e21e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e653608603d8507891d91ba3271e21e">&#9670;&#160;</a></span>get_tokens()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::span&lt; const int &gt; Mila::Dnn::Gpt2::DatasetReader::get_tokens </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a non-owning view of tokens at the specified position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">position</td><td>Starting token position </td></tr>
    <tr><td class="paramname">count</td><td>Number of tokens to access </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::span&lt;const int&gt; A view of the requested tokens </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If the position is invalid or reading fails. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab11045457f4f74e62434b7f9bb3dbf3a" name="ab11045457f4f74e62434b7f9bb3dbf3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab11045457f4f74e62434b7f9bb3dbf3a">&#9670;&#160;</a></span>initialize_dataset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Gpt2::DatasetReader::initialize_dataset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes the dataset access without loading the entire file into memory. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If reading fails or initialization fails.</td></tr>
  </table>
  </dd>
</dl>
<p>Uses a streaming approach to access the dataset file with a fixed-size token window buffer, using std::span for safe, non-owning memory views. </p>

</div>
</div>
<a id="a543827d3e6b6b4cfe18e7ee0311b8db6" name="a543827d3e6b6b4cfe18e7ee0311b8db6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a543827d3e6b6b4cfe18e7ee0311b8db6">&#9670;&#160;</a></span>load_window()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Gpt2::DatasetReader::load_window </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>start_token</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Loads a specific window of tokens from the dataset file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_token</td><td>Index of the first token in the window to load. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If reading fails. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a349b72115549800243e8d0b887179520" name="a349b72115549800243e8d0b887179520"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a349b72115549800243e8d0b887179520">&#9670;&#160;</a></span>log()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Gpt2::DatasetReader::log </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Logs messages through the configured logger. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>The message text to log. </td></tr>
    <tr><td class="paramname">level</td><td>The log level (higher values mean less important). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1005b191ed88ad8a8339b79fd4cfcf88" name="a1005b191ed88ad8a8339b79fd4cfcf88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1005b191ed88ad8a8339b79fd4cfcf88">&#9670;&#160;</a></span>next_batch()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename <a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a>  = DeviceTensor&lt;int&gt;&gt; <br />
requires (std::same_as&lt;<a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a>, <a class="el" href="namespaceMila_1_1Dnn.html#afde383107a015717518430d36c30e47d">HostTensor</a>&lt;int&gt;&gt; || std::same_as&lt;<a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a>, <a class="el" href="namespaceMila_1_1Dnn.html#ae60b4150d02b2ba1bb5ebbd08020da10">PinnedTensor</a>&lt;int&gt;&gt; || std::same_as&lt;<a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a>, <a class="el" href="namespaceMila_1_1Dnn.html#aeb0a38da8dd43e6946ab760de52cccd5">DeviceTensor</a>&lt;int&gt;&gt;)</div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; <a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a>, <a class="el" href="namespaceMila_1_1Dnn.html#a03cccd3c96cc492881f91a265d873cea">TensorType</a> &gt; Mila::Dnn::Gpt2::DatasetReader::next_batch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fetches the next batch of training data with inputs and targets. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TensorType</td><td>The tensor type to return (defaults to DeviceTensor&lt;int&gt;). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::pair&lt;TensorType, TensorType&gt; A pair containing (input tensor, target tensor).</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If timeout occurs waiting for batch or if the reader was stopped.</td></tr>
  </table>
  </dd>
</dl>
<p>This method blocks until a preprocessed batch is available (up to 5 seconds timeout). The returned tensors contain shifted versions of the same data - targets are inputs shifted by one position (implementing language modeling next-token prediction). </p>

</div>
</div>
<a id="a7b9299498ee1856adf7cec6f3de33ad2" name="a7b9299498ee1856adf7cec6f3de33ad2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b9299498ee1856adf7cec6f3de33ad2">&#9670;&#160;</a></span>pause()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Gpt2::DatasetReader::pause </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pauses the background loading threads. </p>
<p>This can be used to temporarily reduce system load without destroying the reader. Background threads will wait until <a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html#a92e737054014353f50b829494783d6ca" title="Resumes the background loading threads after being paused.">resume()</a> is called. </p>

</div>
</div>
<a id="aa225047bffb4b063e6083798f82b9dae" name="aa225047bffb4b063e6083798f82b9dae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa225047bffb4b063e6083798f82b9dae">&#9670;&#160;</a></span>preprocess_batches()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Gpt2::DatasetReader::preprocess_batches </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Background thread function that preprocesses raw data into input/target pairs. </p>
<p>Takes raw data from raw_data_queue_, creates input/target pairs by shifting sequences, and places results in batch_queue_ for consumption. </p>

</div>
</div>
<a id="a85bf5d58022ab1c18ae4e45d5a43293a" name="a85bf5d58022ab1c18ae4e45d5a43293a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85bf5d58022ab1c18ae4e45d5a43293a">&#9670;&#160;</a></span>read_from_disk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Gpt2::DatasetReader::read_from_disk </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Background thread function that reads data from the dataset file. </p>
<p>Continuously reads batches from the dataset file using the window buffer and pushes them to the raw_data_queue_ for preprocessing. </p>

</div>
</div>
<a id="a92e737054014353f50b829494783d6ca" name="a92e737054014353f50b829494783d6ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92e737054014353f50b829494783d6ca">&#9670;&#160;</a></span>resume()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Gpt2::DatasetReader::resume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resumes the background loading threads after being paused. </p>
<p>Wakes up the background threads and continues data loading operations. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a0856874191d8878481bbeac18749634b" name="a0856874191d8878481bbeac18749634b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0856874191d8878481bbeac18749634b">&#9670;&#160;</a></span>batch_queue_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::queue&lt;std::pair&lt;int*, int*&gt; &gt; Mila::Dnn::Gpt2::DatasetReader::batch_queue_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Queue for preprocessed input/target pairs. </p>

</div>
</div>
<a id="a85c842f2c0c2714a2f3fd692e8854775" name="a85c842f2c0c2714a2f3fd692e8854775"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85c842f2c0c2714a2f3fd692e8854775">&#9670;&#160;</a></span>batch_size_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Mila::Dnn::Gpt2::DatasetReader::batch_size_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of sequences in each batch. </p>

</div>
</div>
<a id="aa564f0411e5c37be03bd516a71ba3647" name="aa564f0411e5c37be03bd516a71ba3647"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa564f0411e5c37be03bd516a71ba3647">&#9670;&#160;</a></span>config_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structMila_1_1Dnn_1_1Gpt2_1_1DatasetReader_1_1Config.html">Config</a> Mila::Dnn::Gpt2::DatasetReader::config_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configuration settings. </p>

</div>
</div>
<a id="ac1fab35adb39ab4d45ef2a4fda016cc5" name="ac1fab35adb39ab4d45ef2a4fda016cc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1fab35adb39ab4d45ef2a4fda016cc5">&#9670;&#160;</a></span>control_mutex_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex Mila::Dnn::Gpt2::DatasetReader::control_mutex_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mutex for control operations. </p>

</div>
</div>
<a id="a2bd7b5600ced0142dff86c6bb2137583" name="a2bd7b5600ced0142dff86c6bb2137583"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bd7b5600ced0142dff86c6bb2137583">&#9670;&#160;</a></span>current_window_end_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Mila::Dnn::Gpt2::DatasetReader::current_window_end_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Last token index in current window. </p>

</div>
</div>
<a id="a388a45156a769b6303ffb90b5ae3a6f5" name="a388a45156a769b6303ffb90b5ae3a6f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a388a45156a769b6303ffb90b5ae3a6f5">&#9670;&#160;</a></span>current_window_start_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Mila::Dnn::Gpt2::DatasetReader::current_window_start_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>First token index in current window. </p>

</div>
</div>
<a id="a03725d33f0075e55e71ad327961f8829" name="a03725d33f0075e55e71ad327961f8829"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03725d33f0075e55e71ad327961f8829">&#9670;&#160;</a></span>cv_io_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::condition_variable Mila::Dnn::Gpt2::DatasetReader::cv_io_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Condition variable for I/O thread synchronization. </p>

</div>
</div>
<a id="a107cd1ce267cd1a9bda272fc5599479f" name="a107cd1ce267cd1a9bda272fc5599479f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a107cd1ce267cd1a9bda272fc5599479f">&#9670;&#160;</a></span>cv_processing_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::condition_variable Mila::Dnn::Gpt2::DatasetReader::cv_processing_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Condition variable for processing thread synchronization. </p>

</div>
</div>
<a id="a21c2d0cecb62785875ca7958bcff2d76" name="a21c2d0cecb62785875ca7958bcff2d76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21c2d0cecb62785875ca7958bcff2d76">&#9670;&#160;</a></span>file_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ifstream Mila::Dnn::Gpt2::DatasetReader::file_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>File stream for the dataset. </p>

</div>
</div>
<a id="a6043dc52370b5ae8804eea1a422cd001" name="a6043dc52370b5ae8804eea1a422cd001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6043dc52370b5ae8804eea1a422cd001">&#9670;&#160;</a></span>file_path_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Mila::Dnn::Gpt2::DatasetReader::file_path_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Path to the dataset file. </p>

</div>
</div>
<a id="a3013230574ed2626886c4d555f96ed02" name="a3013230574ed2626886c4d555f96ed02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3013230574ed2626886c4d555f96ed02">&#9670;&#160;</a></span>file_size_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Mila::Dnn::Gpt2::DatasetReader::file_size_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Size of the dataset file in bytes. </p>

</div>
</div>
<a id="a0d0f191730c3553cee5f9ad24e5edf14" name="a0d0f191730c3553cee5f9ad24e5edf14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d0f191730c3553cee5f9ad24e5edf14">&#9670;&#160;</a></span>io_thread_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::thread Mila::Dnn::Gpt2::DatasetReader::io_thread_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thread for disk I/O operations. </p>

</div>
</div>
<a id="a9dbfc511cd10726090486c17dca9fa07" name="a9dbfc511cd10726090486c17dca9fa07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dbfc511cd10726090486c17dca9fa07">&#9670;&#160;</a></span>mutex_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex Mila::Dnn::Gpt2::DatasetReader::mutex_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mutex for protecting shared queues. </p>

</div>
</div>
<a id="a3fa2e24c32ef16233e7ee6a4c7464230" name="a3fa2e24c32ef16233e7ee6a4c7464230"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fa2e24c32ef16233e7ee6a4c7464230">&#9670;&#160;</a></span>num_tokens_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Mila::Dnn::Gpt2::DatasetReader::num_tokens_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of tokens in the dataset. </p>

</div>
</div>
<a id="a37826a7817e59d325540397f97a44308" name="a37826a7817e59d325540397f97a44308"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37826a7817e59d325540397f97a44308">&#9670;&#160;</a></span>paused_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;bool&gt; Mila::Dnn::Gpt2::DatasetReader::paused_ { false }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag to signal threads to pause. </p>

</div>
</div>
<a id="a6b7fdeb547045cfceaaaf800e5a5da40" name="a6b7fdeb547045cfceaaaf800e5a5da40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b7fdeb547045cfceaaaf800e5a5da40">&#9670;&#160;</a></span>pinned_inputs_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int* Mila::Dnn::Gpt2::DatasetReader::pinned_inputs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer for input tensors. </p>

</div>
</div>
<a id="a351f816b912efdbe20e995ba59c54bdd" name="a351f816b912efdbe20e995ba59c54bdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a351f816b912efdbe20e995ba59c54bdd">&#9670;&#160;</a></span>pinned_targets_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int* Mila::Dnn::Gpt2::DatasetReader::pinned_targets_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer for target tensors. </p>

</div>
</div>
<a id="aa176d5820bf776fd58916bf4885e524a" name="aa176d5820bf776fd58916bf4885e524a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa176d5820bf776fd58916bf4885e524a">&#9670;&#160;</a></span>processing_thread_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::thread Mila::Dnn::Gpt2::DatasetReader::processing_thread_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thread for data preprocessing. </p>

</div>
</div>
<a id="a2c9434637fcaa733fec38b9bb1ad0f9d" name="a2c9434637fcaa733fec38b9bb1ad0f9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c9434637fcaa733fec38b9bb1ad0f9d">&#9670;&#160;</a></span>raw_data_queue_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::queue&lt;int*&gt; Mila::Dnn::Gpt2::DatasetReader::raw_data_queue_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Queue for raw data batches. </p>

</div>
</div>
<a id="a3f13345adc3a44482cb47dbd8b6fbbf4" name="a3f13345adc3a44482cb47dbd8b6fbbf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f13345adc3a44482cb47dbd8b6fbbf4">&#9670;&#160;</a></span>seq_len_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Mila::Dnn::Gpt2::DatasetReader::seq_len_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Length of each sequence in tokens. </p>

</div>
</div>
<a id="a2a7a8e2b3c026be767e82cc57e124a39" name="a2a7a8e2b3c026be767e82cc57e124a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a7a8e2b3c026be767e82cc57e124a39">&#9670;&#160;</a></span>stop_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;bool&gt; Mila::Dnn::Gpt2::DatasetReader::stop_ { false }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag to signal threads to stop. </p>

</div>
</div>
<a id="a216d3a3eff65eb540aa444cc693bdc7f" name="a216d3a3eff65eb540aa444cc693bdc7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a216d3a3eff65eb540aa444cc693bdc7f">&#9670;&#160;</a></span>token_window_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;int[]&gt; Mila::Dnn::Gpt2::DatasetReader::token_window_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Window buffer for tokens. </p>

</div>
</div>
<a id="a438cd8013d3a4aeb624d6cede65ac5d7" name="a438cd8013d3a4aeb624d6cede65ac5d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a438cd8013d3a4aeb624d6cede65ac5d7">&#9670;&#160;</a></span>token_window_size_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Mila::Dnn::Gpt2::DatasetReader::token_window_size_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Size of token window in tokens. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Src/Dnn/Models/Gpt2/<a class="el" href="Gpt2DatasetReader_8ixx.html">Gpt2DatasetReader.ixx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceMila.html">Mila</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn.html">Dnn</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn_1_1Gpt2.html">Gpt2</a></li><li class="navelem"><a class="el" href="classMila_1_1Dnn_1_1Gpt2_1_1DatasetReader.html">DatasetReader</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
