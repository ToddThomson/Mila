<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mila: Mila::Dnn::TensorBuffer&lt; T, MR, TrackMemory &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mila
   </div>
   <div id="projectbrief">Deep Neural Network Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classMila_1_1Dnn_1_1TensorBuffer.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classMila_1_1Dnn_1_1TensorBuffer-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Mila::Dnn::TensorBuffer&lt; T, MR, TrackMemory &gt; Class Template Reference<span class="mlabels"><span class="mlabel">export</span></span><div class="ingroups">module <a class="el" href="module_Dnn_8TensorBuffer.html">Dnn.TensorBuffer</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>A buffer for storing tensor data with configurable memory management.  
 <a href="classMila_1_1Dnn_1_1TensorBuffer.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a94900accdc1021c275e11c9d72de050e" id="r_a94900accdc1021c275e11c9d72de050e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a94900accdc1021c275e11c9d72de050e">TensorBuffer</a> (const <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">TensorBuffer</a> &amp;)=delete</td></tr>
<tr class="memdesc:a94900accdc1021c275e11c9d72de050e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy operations are explicitly deleted.  <br /></td></tr>
<tr class="separator:a94900accdc1021c275e11c9d72de050e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eff8d3ca394888d6266c5973c14daa5" id="r_a6eff8d3ca394888d6266c5973c14daa5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a6eff8d3ca394888d6266c5973c14daa5">TensorBuffer</a> (size_t <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a042a6f822b605e5edf279e4295c46260">size</a>, T *data_ptr)</td></tr>
<tr class="memdesc:a6eff8d3ca394888d6266c5973c14daa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object with externally managed memory.  <br /></td></tr>
<tr class="separator:a6eff8d3ca394888d6266c5973c14daa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0743d21e0f9e30fc802c1c8d2251fb41" id="r_a0743d21e0f9e30fc802c1c8d2251fb41"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a0743d21e0f9e30fc802c1c8d2251fb41">TensorBuffer</a> (size_t <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a042a6f822b605e5edf279e4295c46260">size</a>, T value=T{})</td></tr>
<tr class="memdesc:a0743d21e0f9e30fc802c1c8d2251fb41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object with owned memory and optional value initialization.  <br /></td></tr>
<tr class="separator:a0743d21e0f9e30fc802c1c8d2251fb41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5152f6b3065715257e82c365d700081d" id="r_a5152f6b3065715257e82c365d700081d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a5152f6b3065715257e82c365d700081d">~TensorBuffer</a> ()</td></tr>
<tr class="memdesc:a5152f6b3065715257e82c365d700081d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object and deallocates memory if owned.  <br /></td></tr>
<tr class="separator:a5152f6b3065715257e82c365d700081d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f8912b6490cb47eb30e548dae6c4187" id="r_a6f8912b6490cb47eb30e548dae6c4187"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a6f8912b6490cb47eb30e548dae6c4187">aligned_size</a> () const</td></tr>
<tr class="memdesc:a6f8912b6490cb47eb30e548dae6c4187"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the aligned size of the buffer in bytes.  <br /></td></tr>
<tr class="separator:a6f8912b6490cb47eb30e548dae6c4187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a795a293f1c49fccef33a9ed0c95f0c7b" id="r_a795a293f1c49fccef33a9ed0c95f0c7b"><td class="memItemLeft" align="right" valign="top">T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a795a293f1c49fccef33a9ed0c95f0c7b">data</a> ()</td></tr>
<tr class="memdesc:a795a293f1c49fccef33a9ed0c95f0c7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a pointer to the buffer's data.  <br /></td></tr>
<tr class="separator:a795a293f1c49fccef33a9ed0c95f0c7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0864454519f83435c203384e7e5e30e" id="r_af0864454519f83435c203384e7e5e30e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#af0864454519f83435c203384e7e5e30e">is_aligned</a> () const noexcept</td></tr>
<tr class="memdesc:af0864454519f83435c203384e7e5e30e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the buffer's data pointer is properly aligned.  <br /></td></tr>
<tr class="separator:af0864454519f83435c203384e7e5e30e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e02a438d9f2db8926300063f87df5e7" id="r_a5e02a438d9f2db8926300063f87df5e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">TensorBuffer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a5e02a438d9f2db8926300063f87df5e7">operator=</a> (const <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">TensorBuffer</a> &amp;)=delete</td></tr>
<tr class="separator:a5e02a438d9f2db8926300063f87df5e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d6a1db3f2401e0a42aeb2b2e6524222" id="r_a7d6a1db3f2401e0a42aeb2b2e6524222"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a7d6a1db3f2401e0a42aeb2b2e6524222">resize</a> (size_t new_size)</td></tr>
<tr class="memdesc:a7d6a1db3f2401e0a42aeb2b2e6524222"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resizes the buffer to a new size, preserving existing data when possible.  <br /></td></tr>
<tr class="separator:a7d6a1db3f2401e0a42aeb2b2e6524222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a042a6f822b605e5edf279e4295c46260" id="r_a042a6f822b605e5edf279e4295c46260"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a042a6f822b605e5edf279e4295c46260">size</a> () const</td></tr>
<tr class="memdesc:a042a6f822b605e5edf279e4295c46260"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the size of the buffer.  <br /></td></tr>
<tr class="separator:a042a6f822b605e5edf279e4295c46260"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a226f9b72f6fdba785dcbafd60759a5c9" id="r_a226f9b72f6fdba785dcbafd60759a5c9"><td class="memItemLeft" align="right" valign="top">static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a226f9b72f6fdba785dcbafd60759a5c9">alignment</a> = <a class="el" href="namespaceMila_1_1Dnn_1_1detail.html#af137c7018cb88c2251064731685714a7">detail::get_alignment</a>&lt;MR&gt;()</td></tr>
<tr class="memdesc:a226f9b72f6fdba785dcbafd60759a5c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The alignment boundary for memory allocation based on the memory resource type.  <br /></td></tr>
<tr class="separator:a226f9b72f6fdba785dcbafd60759a5c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a2c9260159493bf0b3ac8a93bdb8d2f44" id="r_a2c9260159493bf0b3ac8a93bdb8d2f44"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a2c9260159493bf0b3ac8a93bdb8d2f44">calculateAlignedSize</a> (size_t num_elements) const</td></tr>
<tr class="memdesc:a2c9260159493bf0b3ac8a93bdb8d2f44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the aligned size in bytes for a given number of elements.  <br /></td></tr>
<tr class="separator:a2c9260159493bf0b3ac8a93bdb8d2f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e52614a94a6a7be459965028d7f5fb9" id="r_a5e52614a94a6a7be459965028d7f5fb9"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a7b8ae76f48eea1ab92fc10a619f1b666">Compute::MemoryResource</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a5e52614a94a6a7be459965028d7f5fb9">createMemoryResource</a> ()</td></tr>
<tr class="memdesc:a5e52614a94a6a7be459965028d7f5fb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a memory resource based on the template parameter.  <br /></td></tr>
<tr class="separator:a5e52614a94a6a7be459965028d7f5fb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af36c60b774be00c443830869c45f62c7" id="r_af36c60b774be00c443830869c45f62c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#af36c60b774be00c443830869c45f62c7">fillBuffer</a> (T value=T{})</td></tr>
<tr class="memdesc:af36c60b774be00c443830869c45f62c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the buffer with a specified value.  <br /></td></tr>
<tr class="separator:af36c60b774be00c443830869c45f62c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a7d1d2a4888d805e038a0d201bc4966d8" id="r_a7d1d2a4888d805e038a0d201bc4966d8"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a7d1d2a4888d805e038a0d201bc4966d8">aligned_size_</a> { 0 }</td></tr>
<tr class="memdesc:a7d1d2a4888d805e038a0d201bc4966d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The actual size in bytes of the allocated memory, including alignment padding.  <br /></td></tr>
<tr class="separator:a7d1d2a4888d805e038a0d201bc4966d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8d0b0e5fa2403a71cb4add6e9e0ad16" id="r_ae8d0b0e5fa2403a71cb4add6e9e0ad16"><td class="memItemLeft" align="right" valign="top">T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#ae8d0b0e5fa2403a71cb4add6e9e0ad16">data_</a> { nullptr }</td></tr>
<tr class="memdesc:ae8d0b0e5fa2403a71cb4add6e9e0ad16"><td class="mdescLeft">&#160;</td><td class="mdescRight">A pointer to the allocated memory containing the buffer's data.  <br /></td></tr>
<tr class="separator:ae8d0b0e5fa2403a71cb4add6e9e0ad16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5e98db884bf5308b324d899ed91caff" id="r_ac5e98db884bf5308b324d899ed91caff"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a7b8ae76f48eea1ab92fc10a619f1b666">Compute::MemoryResource</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#ac5e98db884bf5308b324d899ed91caff">mr_</a> { nullptr }</td></tr>
<tr class="memdesc:ac5e98db884bf5308b324d899ed91caff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory resource used for allocation/deallocation (null for externally managed buffers).  <br /></td></tr>
<tr class="separator:ac5e98db884bf5308b324d899ed91caff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fe10c0b4a8bbf58fcbb65a4beb033c5" id="r_a9fe10c0b4a8bbf58fcbb65a4beb033c5"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a9fe10c0b4a8bbf58fcbb65a4beb033c5">size_</a> { 0 }</td></tr>
<tr class="memdesc:a9fe10c0b4a8bbf58fcbb65a4beb033c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of elements in the buffer.  <br /></td></tr>
<tr class="separator:a9fe10c0b4a8bbf58fcbb65a4beb033c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename T, typename MR, bool TrackMemory = true&gt;<br />
requires std::is_base_of_v&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a7b8ae76f48eea1ab92fc10a619f1b666">Compute::MemoryResource</a>, MR&gt;<br />
class Mila::Dnn::TensorBuffer&lt; T, MR, TrackMemory &gt;</div><p>A buffer for storing tensor data with configurable memory management. </p>
<p><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> provides a generic container for tensor data that can be stored either in CPU or GPU memory based on the memory resource type. It supports both owned and externally managed memory.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TElementType</td><td>The type of the elements stored in the buffer. </td></tr>
    <tr><td class="paramname">MR</td><td>The memory resource type that determines where and how memory is allocated. Must derive from <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a7b8ae76f48eea1ab92fc10a619f1b666" title="An alias for the standard polymorphic memory resource.">Compute::MemoryResource</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Thread Safety: The buffer is not thread-safe. Multiple threads accessing the same buffer must be synchronized externally.</dd>
<dd>
Exception Safety: Basic guarantee - if an exception occurs during operations, no memory is leaked but the buffer may be left in an undefined state.</dd></dl>
<p>Example usage: </p><div class="fragment"><div class="line"><span class="comment">// Create a CPU buffer with 100 floats initialized to 0.0f</span></div>
<div class="line"><a class="code hl_class" href="classMila_1_1Dnn_1_1TensorBuffer.html">TensorBuffer&lt;float, Compute::HostMemoryResource&gt;</a> cpuBuffer(100, 0.0f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a GPU buffer with 100 floats</span></div>
<div class="line"><a class="code hl_class" href="classMila_1_1Dnn_1_1TensorBuffer.html">TensorBuffer&lt;float, Compute::DeviceMemoryResource&gt;</a> gpuBuffer(100);</div>
<div class="ttc" id="aclassMila_1_1Dnn_1_1TensorBuffer_html"><div class="ttname"><a href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a></div><div class="ttdoc">A buffer for storing tensor data with configurable memory management.</div><div class="ttdef"><b>Definition</b> TensorBuffer.ixx:91</div></div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a0743d21e0f9e30fc802c1c8d2251fb41" name="a0743d21e0f9e30fc802c1c8d2251fb41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0743d21e0f9e30fc802c1c8d2251fb41">&#9670;&#160;</a></span>TensorBuffer() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::TensorBuffer </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>value</em> = <code>T{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object with owned memory and optional value initialization. </p>
<p>This constructor allocates memory using the specified memory resource and optionally initializes all elements to the provided value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>The number of elements in the buffer. </td></tr>
    <tr><td class="paramname">value</td><td>Value to initialize the buffer with (default: default-constructed TElementType).</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::overflow_error</td><td>If size is too large, causing overflow in aligned size calculation. </td></tr>
    <tr><td class="paramname">std::bad_alloc</td><td>If memory allocation fails. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6eff8d3ca394888d6266c5973c14daa5" name="a6eff8d3ca394888d6266c5973c14daa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eff8d3ca394888d6266c5973c14daa5">&#9670;&#160;</a></span>TensorBuffer() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::TensorBuffer </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>data_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object with externally managed memory. </p>
<p>This constructor does not allocate memory but instead wraps the provided pre-allocated memory. The buffer does not take ownership of this memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>The number of elements in the buffer. </td></tr>
    <tr><td class="paramname">data_ptr</td><td>Pointer to the pre-allocated memory.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>If data_ptr is null. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5152f6b3065715257e82c365d700081d" name="a5152f6b3065715257e82c365d700081d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5152f6b3065715257e82c365d700081d">&#9670;&#160;</a></span>~TensorBuffer()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::~<a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">TensorBuffer</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroys the <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> object and deallocates memory if owned. </p>
<p>If the buffer owns its memory (mr_ is not null), it will deallocate the memory using the memory resource. If the buffer uses externally managed memory, it will not deallocate anything. </p>

</div>
</div>
<a id="a94900accdc1021c275e11c9d72de050e" name="a94900accdc1021c275e11c9d72de050e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94900accdc1021c275e11c9d72de050e">&#9670;&#160;</a></span>TensorBuffer() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::TensorBuffer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">TensorBuffer</a>&lt; T, MR, TrackMemory &gt; &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy operations are explicitly deleted. </p>
<p><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html" title="A buffer for storing tensor data with configurable memory management.">TensorBuffer</a> does not support copying since it may involve deep copying of large memory blocks across different memory spaces. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6f8912b6490cb47eb30e548dae6c4187" name="a6f8912b6490cb47eb30e548dae6c4187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f8912b6490cb47eb30e548dae6c4187">&#9670;&#160;</a></span>aligned_size()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::aligned_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the aligned size of the buffer in bytes. </p>
<p>This is the actual memory size allocated, which may be larger than <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html#a042a6f822b605e5edf279e4295c46260" title="Gets the size of the buffer.">size()</a> * sizeof(T) due to alignment padding.</p>
<dl class="section return"><dt>Returns</dt><dd>size_t The aligned size in bytes. </dd></dl>

</div>
</div>
<a id="a2c9260159493bf0b3ac8a93bdb8d2f44" name="a2c9260159493bf0b3ac8a93bdb8d2f44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c9260159493bf0b3ac8a93bdb8d2f44">&#9670;&#160;</a></span>calculateAlignedSize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::calculateAlignedSize </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_elements</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the aligned size in bytes for a given number of elements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_elements</td><td>The number of elements. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size_t The aligned size in bytes. </dd></dl>

</div>
</div>
<a id="a5e52614a94a6a7be459965028d7f5fb9" name="a5e52614a94a6a7be459965028d7f5fb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e52614a94a6a7be459965028d7f5fb9">&#9670;&#160;</a></span>createMemoryResource()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a7b8ae76f48eea1ab92fc10a619f1b666">Compute::MemoryResource</a> &gt; <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::createMemoryResource </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a memory resource based on the template parameter. </p>
<dl class="section return"><dt>Returns</dt><dd>std::unique_ptr&lt;Compute::MemoryResource&gt; The created memory resource. </dd></dl>

</div>
</div>
<a id="a795a293f1c49fccef33a9ed0c95f0c7b" name="a795a293f1c49fccef33a9ed0c95f0c7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a795a293f1c49fccef33a9ed0c95f0c7b">&#9670;&#160;</a></span>data()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T * <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a pointer to the buffer's data. </p>
<dl class="section return"><dt>Returns</dt><dd>TElementType* A pointer to the data stored in the buffer. </dd></dl>

</div>
</div>
<a id="af36c60b774be00c443830869c45f62c7" name="af36c60b774be00c443830869c45f62c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af36c60b774be00c443830869c45f62c7">&#9670;&#160;</a></span>fillBuffer()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::fillBuffer </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>value</em> = <code>T{}</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes the buffer with a specified value. </p>
<p>This method fills the buffer with the specified value, using different approaches depending on whether the buffer is in CPU or GPU memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>Value to initialize the buffer with (default: default-constructed TElementType).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>For CPU memory, SIMD optimizations may be used for larger trivially copyable types. </dd>
<dd>
For GPU memory, a temporary host buffer is created and copied to the device. </dd></dl>

</div>
</div>
<a id="af0864454519f83435c203384e7e5e30e" name="af0864454519f83435c203384e7e5e30e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0864454519f83435c203384e7e5e30e">&#9670;&#160;</a></span>is_aligned()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::is_aligned </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the buffer's data pointer is properly aligned. </p>
<p>This method verifies that the buffer's data pointer is aligned according to the alignment requirements of the memory resource.</p>
<dl class="section return"><dt>Returns</dt><dd>bool True if the data pointer is properly aligned, false otherwise. </dd></dl>

</div>
</div>
<a id="a5e02a438d9f2db8926300063f87df5e7" name="a5e02a438d9f2db8926300063f87df5e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e02a438d9f2db8926300063f87df5e7">&#9670;&#160;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">TensorBuffer</a> &amp; <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">TensorBuffer</a>&lt; T, MR, TrackMemory &gt; &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7d6a1db3f2401e0a42aeb2b2e6524222" name="a7d6a1db3f2401e0a42aeb2b2e6524222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d6a1db3f2401e0a42aeb2b2e6524222">&#9670;&#160;</a></span>resize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::resize </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>new_size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resizes the buffer to a new size, preserving existing data when possible. </p>
<p>This method allocates a new buffer of the specified size, copies data from the old buffer to the new one (up to the smaller of the old and new sizes), and then deallocates the old buffer. If the new size is larger than the old size, the additional elements are default-initialized.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_size</td><td>The new size of the buffer. Can be zero.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If the buffer is externally managed. </td></tr>
    <tr><td class="paramname">std::overflow_error</td><td>If new_size is too large, causing overflow in aligned size calculation. </td></tr>
    <tr><td class="paramname">std::bad_alloc</td><td>If memory allocation fails. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a042a6f822b605e5edf279e4295c46260" name="a042a6f822b605e5edf279e4295c46260"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a042a6f822b605e5edf279e4295c46260">&#9670;&#160;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the size of the buffer. </p>
<dl class="section return"><dt>Returns</dt><dd>size_t The number of elements in the buffer. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7d1d2a4888d805e038a0d201bc4966d8" name="a7d1d2a4888d805e038a0d201bc4966d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d1d2a4888d805e038a0d201bc4966d8">&#9670;&#160;</a></span>aligned_size_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::aligned_size_ { 0 }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The actual size in bytes of the allocated memory, including alignment padding. </p>

</div>
</div>
<a id="a226f9b72f6fdba785dcbafd60759a5c9" name="a226f9b72f6fdba785dcbafd60759a5c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a226f9b72f6fdba785dcbafd60759a5c9">&#9670;&#160;</a></span>alignment</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::alignment = <a class="el" href="namespaceMila_1_1Dnn_1_1detail.html#af137c7018cb88c2251064731685714a7">detail::get_alignment</a>&lt;MR&gt;()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The alignment boundary for memory allocation based on the memory resource type. </p>
<p>This value is determined at compile time to ensure optimal memory access patterns for the specific memory resource type (CPU or GPU). </p>

</div>
</div>
<a id="ae8d0b0e5fa2403a71cb4add6e9e0ad16" name="ae8d0b0e5fa2403a71cb4add6e9e0ad16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8d0b0e5fa2403a71cb4add6e9e0ad16">&#9670;&#160;</a></span>data_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T* <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::data_ { nullptr }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A pointer to the allocated memory containing the buffer's data. </p>

</div>
</div>
<a id="ac5e98db884bf5308b324d899ed91caff" name="ac5e98db884bf5308b324d899ed91caff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5e98db884bf5308b324d899ed91caff">&#9670;&#160;</a></span>mr_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a7b8ae76f48eea1ab92fc10a619f1b666">Compute::MemoryResource</a>&gt; <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::mr_ { nullptr }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Memory resource used for allocation/deallocation (null for externally managed buffers). </p>

</div>
</div>
<a id="a9fe10c0b4a8bbf58fcbb65a4beb033c5" name="a9fe10c0b4a8bbf58fcbb65a4beb033c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fe10c0b4a8bbf58fcbb65a4beb033c5">&#9670;&#160;</a></span>size_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename MR , bool TrackMemory = true&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">Mila::Dnn::TensorBuffer</a>&lt; T, MR, TrackMemory &gt;::size_ { 0 }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of elements in the buffer. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Src/Dnn/Core/<a class="el" href="TensorBuffer_8ixx.html">TensorBuffer.ixx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceMila.html">Mila</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn.html">Dnn</a></li><li class="navelem"><a class="el" href="classMila_1_1Dnn_1_1TensorBuffer.html">TensorBuffer</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
