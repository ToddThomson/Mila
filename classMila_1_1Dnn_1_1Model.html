<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mila: Mila::Dnn::Model&lt; TDeviceType, TInput, TOutput &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mila
   </div>
   <div id="projectbrief">Deep Neural Network Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classMila_1_1Dnn_1_1Model.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classMila_1_1Dnn_1_1Model-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Mila::Dnn::Model&lt; TDeviceType, TInput, TOutput &gt; Class Template Reference<span class="mlabels"><span class="mlabel">export</span></span><div class="ingroups">module <a class="el" href="module_Dnn_8Model.html">Dnn.Model</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>A class representing a neural network model.  
 <a href="classMila_1_1Dnn_1_1Model.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for Mila::Dnn::Model&lt; TDeviceType, TInput, TOutput &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model__inherit__graph.png" border="0" usemap="#aMila_1_1Dnn_1_1Model_3_01TDeviceType_00_01TInput_00_01TOutput_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="aMila_1_1Dnn_1_1Model_3_01TDeviceType_00_01TInput_00_01TOutput_01_4_inherit__map" id="aMila_1_1Dnn_1_1Model_3_01TDeviceType_00_01TInput_00_01TOutput_01_4_inherit__map">
<area shape="rect" title="A class representing a neural network model." alt="" coords="5,108,205,148"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html" title="Abstract base class for all modules in the Mila DNN framework." alt="" coords="24,5,187,60"/>
<area shape="poly" title=" " alt="" coords="108,74,108,108,103,108,103,74"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Mila::Dnn::Model&lt; TDeviceType, TInput, TOutput &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model__coll__graph.png" border="0" usemap="#aMila_1_1Dnn_1_1Model_3_01TDeviceType_00_01TInput_00_01TOutput_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="aMila_1_1Dnn_1_1Model_3_01TDeviceType_00_01TInput_00_01TOutput_01_4_coll__map" id="aMila_1_1Dnn_1_1Model_3_01TDeviceType_00_01TInput_00_01TOutput_01_4_coll__map">
<area shape="rect" title="A class representing a neural network model." alt="" coords="99,225,299,265"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html" title="Abstract base class for all modules in the Mila DNN framework." alt="" coords="28,93,191,148"/>
<area shape="poly" title=" " alt="" coords="139,158,187,224,183,227,135,161"/>
<area shape="rect" href="classMila_1_1Dnn_1_1ComponentConfig.html" title="Base configuration class for all neural network components." alt="" coords="5,5,213,31"/>
<area shape="poly" title=" " alt="" coords="112,45,112,93,107,93,107,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html" title=" " alt="" coords="215,101,361,141"/>
<area shape="poly" title=" " alt="" coords="268,154,215,227,210,223,264,151"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a00faee3dac2291892822902b6a7316b3" id="r_a00faee3dac2291892822902b6a7316b3"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a00faee3dac2291892822902b6a7316b3">ModuleBase</a> = <a class="el" href="classMila_1_1Dnn_1_1Module.html">Module</a>&lt; TDeviceType, TInput, TOutput &gt;</td></tr>
<tr class="memdesc:a00faee3dac2291892822902b6a7316b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base class type for the module.  <br /></td></tr>
<tr class="separator:a00faee3dac2291892822902b6a7316b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62884a84c2df2ac4b92b42234bca4bdf" id="r_a62884a84c2df2ac4b92b42234bca4bdf"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a62884a84c2df2ac4b92b42234bca4bdf">MR</a> = std::conditional_t&lt; TDeviceType==DeviceType::Cuda, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaMemoryResource.html">CudaMemoryResource</a>, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuMemoryResource.html">CpuMemoryResource</a> &gt;</td></tr>
<tr class="memdesc:a62884a84c2df2ac4b92b42234bca4bdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory resource type.  <br /></td></tr>
<tr class="separator:a62884a84c2df2ac4b92b42234bca4bdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_types_classMila_1_1Dnn_1_1Module"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classMila_1_1Dnn_1_1Module')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classMila_1_1Dnn_1_1Module.html">Mila::Dnn::Module&lt; TDeviceType, TInput, TOutput &gt;</a></td></tr>
<tr class="memitem:a30d5b0cc3f9fa994c166180483b2ea51 inherit pub_types_classMila_1_1Dnn_1_1Module" id="r_a30d5b0cc3f9fa994c166180483b2ea51"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a30d5b0cc3f9fa994c166180483b2ea51">MR</a> = std::conditional_t&lt; TDeviceType==DeviceType::Cuda, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaMemoryResource.html">CudaMemoryResource</a>, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuMemoryResource.html">CpuMemoryResource</a> &gt;</td></tr>
<tr class="separator:a30d5b0cc3f9fa994c166180483b2ea51 inherit pub_types_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a213f48c2d2127c2c4f08b01cfa2cb109" id="r_a213f48c2d2127c2c4f08b01cfa2cb109"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a213f48c2d2127c2c4f08b01cfa2cb109">Model</a> ()</td></tr>
<tr class="memdesc:a213f48c2d2127c2c4f08b01cfa2cb109"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new <a class="el" href="classMila_1_1Dnn_1_1Model.html" title="A class representing a neural network model.">Model</a> object with the default device context.  <br /></td></tr>
<tr class="separator:a213f48c2d2127c2c4f08b01cfa2cb109"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93f0b38d530576a5f93316dc00047b13" id="r_a93f0b38d530576a5f93316dc00047b13"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a93f0b38d530576a5f93316dc00047b13">Model</a> (const std::string &amp;device_name)</td></tr>
<tr class="memdesc:a93f0b38d530576a5f93316dc00047b13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new <a class="el" href="classMila_1_1Dnn_1_1Model.html" title="A class representing a neural network model.">Model</a> object with a specific device name.  <br /></td></tr>
<tr class="separator:a93f0b38d530576a5f93316dc00047b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab169844bb0aacc1d069d7f651624370c" id="r_ab169844bb0aacc1d069d7f651624370c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#ab169844bb0aacc1d069d7f651624370c">Model</a> (std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt; context)</td></tr>
<tr class="memdesc:ab169844bb0aacc1d069d7f651624370c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new <a class="el" href="classMila_1_1Dnn_1_1Model.html" title="A class representing a neural network model.">Model</a> object with a specific device context.  <br /></td></tr>
<tr class="separator:ab169844bb0aacc1d069d7f651624370c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03db5df5372ccbfcac84cb58d9730986" id="r_a03db5df5372ccbfcac84cb58d9730986"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a03db5df5372ccbfcac84cb58d9730986">~Model</a> ()</td></tr>
<tr class="memdesc:a03db5df5372ccbfcac84cb58d9730986"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the <a class="el" href="classMila_1_1Dnn_1_1Model.html" title="A class representing a neural network model.">Model</a> object.  <br /></td></tr>
<tr class="separator:a03db5df5372ccbfcac84cb58d9730986"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acde701a4d3bb955a43483631119f0859" id="r_acde701a4d3bb955a43483631119f0859"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#acde701a4d3bb955a43483631119f0859">backward</a> ()</td></tr>
<tr class="memdesc:acde701a4d3bb955a43483631119f0859"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a backward pass through the model.  <br /></td></tr>
<tr class="separator:acde701a4d3bb955a43483631119f0859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8735b9d7aa4e4a84ff9ea2bcea46e993" id="r_a8735b9d7aa4e4a84ff9ea2bcea46e993"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a8735b9d7aa4e4a84ff9ea2bcea46e993">build</a> ()</td></tr>
<tr class="memdesc:a8735b9d7aa4e4a84ff9ea2bcea46e993"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds the model.  <br /></td></tr>
<tr class="separator:a8735b9d7aa4e4a84ff9ea2bcea46e993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae33c8f6f72dc13d99e15278057c6fd03" id="r_ae33c8f6f72dc13d99e15278057c6fd03"><td class="memTemplParams" colspan="2">template&lt;typename TMR &gt; </td></tr>
<tr class="memitem:ae33c8f6f72dc13d99e15278057c6fd03"><td class="memTemplItemLeft" align="right" valign="top">float&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#ae33c8f6f72dc13d99e15278057c6fd03">calculateLoss</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, TMR &gt; &amp;targets)</td></tr>
<tr class="memdesc:ae33c8f6f72dc13d99e15278057c6fd03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the loss for the given targets and current model outputs.  <br /></td></tr>
<tr class="separator:ae33c8f6f72dc13d99e15278057c6fd03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81b4080be583521185ac736a9f6db23f" id="r_a81b4080be583521185ac736a9f6db23f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a81b4080be583521185ac736a9f6db23f">captureGraphBegin</a> ()</td></tr>
<tr class="memdesc:a81b4080be583521185ac736a9f6db23f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start capturing operations for a CUDA graph.  <br /></td></tr>
<tr class="separator:a81b4080be583521185ac736a9f6db23f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa63470db21258487f07bf096edcd99aa" id="r_aa63470db21258487f07bf096edcd99aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#aa63470db21258487f07bf096edcd99aa">captureGraphEnd</a> ()</td></tr>
<tr class="memdesc:aa63470db21258487f07bf096edcd99aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">End capturing operations for a CUDA graph.  <br /></td></tr>
<tr class="separator:aa63470db21258487f07bf096edcd99aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa81d44981751eb9ce8223f3bd255aba4" id="r_aa81d44981751eb9ce8223f3bd255aba4"><td class="memTemplParams" colspan="2">template&lt;typename TDataLoader &gt; </td></tr>
<tr class="memitem:aa81d44981751eb9ce8223f3bd255aba4"><td class="memTemplItemLeft" align="right" valign="top">float&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#aa81d44981751eb9ce8223f3bd255aba4">evaluate</a> (TDataLoader &amp;data_loader, bool verbose=false)</td></tr>
<tr class="memdesc:aa81d44981751eb9ce8223f3bd255aba4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the model on a dataset.  <br /></td></tr>
<tr class="separator:aa81d44981751eb9ce8223f3bd255aba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6464fe4d7a422f617e588a642c04971" id="r_ac6464fe4d7a422f617e588a642c04971"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#ac6464fe4d7a422f617e588a642c04971">executeGraph</a> ()</td></tr>
<tr class="memdesc:ac6464fe4d7a422f617e588a642c04971"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the captured CUDA graph.  <br /></td></tr>
<tr class="separator:ac6464fe4d7a422f617e588a642c04971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d73c2f1afbb01476f9ba61844508f5b" id="r_a5d73c2f1afbb01476f9ba61844508f5b"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a5d73c2f1afbb01476f9ba61844508f5b">forward</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Model.html#a62884a84c2df2ac4b92b42234bca4bdf">MR</a> &gt; &amp;inputs, const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Model.html#a62884a84c2df2ac4b92b42234bca4bdf">MR</a> &gt; &amp;targets)</td></tr>
<tr class="memdesc:a5d73c2f1afbb01476f9ba61844508f5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a forward pass through the model.  <br /></td></tr>
<tr class="separator:a5d73c2f1afbb01476f9ba61844508f5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6632abec2ee05c8ddece16bcfd216217" id="r_a6632abec2ee05c8ddece16bcfd216217"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputeDevice.html">Compute::ComputeDevice</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a6632abec2ee05c8ddece16bcfd216217">getDevice</a> () const</td></tr>
<tr class="memdesc:a6632abec2ee05c8ddece16bcfd216217"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the compute device for this model.  <br /></td></tr>
<tr class="separator:a6632abec2ee05c8ddece16bcfd216217"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66ecbc608d680933a9f3d9f9b323af29" id="r_a66ecbc608d680933a9f3d9f9b323af29"><td class="memItemLeft" align="right" valign="top">cudaStream_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a66ecbc608d680933a9f3d9f9b323af29">getStream</a> () const</td></tr>
<tr class="memdesc:a66ecbc608d680933a9f3d9f9b323af29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current CUDA stream.  <br /></td></tr>
<tr class="separator:a66ecbc608d680933a9f3d9f9b323af29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15d9a5fd835693873e3e7b501af38464" id="r_a15d9a5fd835693873e3e7b501af38464"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a15d9a5fd835693873e3e7b501af38464">loadCheckpoint</a> (const std::string &amp;filename)</td></tr>
<tr class="memdesc:a15d9a5fd835693873e3e7b501af38464"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads the model's state from a checkpoint file.  <br /></td></tr>
<tr class="separator:a15d9a5fd835693873e3e7b501af38464"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13832fb45674627c3bdbe3e9abe5141a" id="r_a13832fb45674627c3bdbe3e9abe5141a"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a13832fb45674627c3bdbe3e9abe5141a">parameters</a> () const</td></tr>
<tr class="memdesc:a13832fb45674627c3bdbe3e9abe5141a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the total number of parameters in the model.  <br /></td></tr>
<tr class="separator:a13832fb45674627c3bdbe3e9abe5141a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6d1b284a6a4426716842127fc0d3de9" id="r_ad6d1b284a6a4426716842127fc0d3de9"><td class="memTemplParams" colspan="2">template&lt;typename TMR &gt; </td></tr>
<tr class="memitem:ad6d1b284a6a4426716842127fc0d3de9"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, TMR &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#ad6d1b284a6a4426716842127fc0d3de9">predict</a> (const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, TMR &gt; &amp;inputs)</td></tr>
<tr class="memdesc:ad6d1b284a6a4426716842127fc0d3de9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predict outputs for the given inputs.  <br /></td></tr>
<tr class="separator:ad6d1b284a6a4426716842127fc0d3de9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d7e81eeb43446ce683e4990cbcf34c" id="r_ab1d7e81eeb43446ce683e4990cbcf34c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#ab1d7e81eeb43446ce683e4990cbcf34c">print</a> () const</td></tr>
<tr class="memdesc:ab1d7e81eeb43446ce683e4990cbcf34c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the model's structure and total number of parameters.  <br /></td></tr>
<tr class="separator:ab1d7e81eeb43446ce683e4990cbcf34c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace6557fba6d0369620f807c6112fad42" id="r_ace6557fba6d0369620f807c6112fad42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#ace6557fba6d0369620f807c6112fad42">saveCheckpoint</a> (const std::string &amp;filename) const</td></tr>
<tr class="memdesc:ace6557fba6d0369620f807c6112fad42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves the model's state to a checkpoint file.  <br /></td></tr>
<tr class="separator:ace6557fba6d0369620f807c6112fad42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a028247ab95727a904493b18c1d73a588" id="r_a028247ab95727a904493b18c1d73a588"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a028247ab95727a904493b18c1d73a588">setDevice</a> (const std::string &amp;device_name)</td></tr>
<tr class="memdesc:a028247ab95727a904493b18c1d73a588"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the device to use for this model by name.  <br /></td></tr>
<tr class="separator:a028247ab95727a904493b18c1d73a588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa90eec602d8cc14c8a4e95680f25ae44" id="r_aa90eec602d8cc14c8a4e95680f25ae44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#aa90eec602d8cc14c8a4e95680f25ae44">setDevice</a> (int device_id)</td></tr>
<tr class="memdesc:aa90eec602d8cc14c8a4e95680f25ae44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the device to use for this model by CUDA device ID.  <br /></td></tr>
<tr class="separator:aa90eec602d8cc14c8a4e95680f25ae44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d17b2f7212ced5f886ab7b0a6fdb5d1" id="r_a4d17b2f7212ced5f886ab7b0a6fdb5d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a4d17b2f7212ced5f886ab7b0a6fdb5d1">setTrainingMode</a> (bool training)</td></tr>
<tr class="memdesc:a4d17b2f7212ced5f886ab7b0a6fdb5d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the training mode for the model.  <br /></td></tr>
<tr class="separator:a4d17b2f7212ced5f886ab7b0a6fdb5d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ff401d7efa05a64ef397f6b97781068" id="r_a2ff401d7efa05a64ef397f6b97781068"><td class="memTemplParams" colspan="2">template&lt;typename TDataLoader &gt; </td></tr>
<tr class="memitem:a2ff401d7efa05a64ef397f6b97781068"><td class="memTemplItemLeft" align="right" valign="top">std::unordered_map&lt; std::string, float &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a2ff401d7efa05a64ef397f6b97781068">train</a> (TDataLoader &amp;train_loader, TDataLoader *val_loader=nullptr, const <a class="el" href="structMila_1_1Dnn_1_1TrainingConfig.html">TrainingConfig</a> &amp;config={}, const std::vector&lt; <a class="el" href="classMila_1_1Dnn_1_1ModelCallback.html">ModelCallback</a>&lt; TInput, TOutput &gt; * &gt; &amp;callbacks={})</td></tr>
<tr class="memdesc:a2ff401d7efa05a64ef397f6b97781068"><td class="mdescLeft">&#160;</td><td class="mdescRight">Train the model using the provided data loader and configuration.  <br /></td></tr>
<tr class="separator:a2ff401d7efa05a64ef397f6b97781068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa744cf6af25ebcf4e5a3147682485026" id="r_aa744cf6af25ebcf4e5a3147682485026"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#aa744cf6af25ebcf4e5a3147682485026">updateParameters</a> (float learning_rate, float beta1=0.9f, float beta2=0.999f, float epsilon=1e-8f, float weight_decay=0.0f, size_t step=1)</td></tr>
<tr class="memdesc:aa744cf6af25ebcf4e5a3147682485026"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the model parameters using the computed gradients.  <br /></td></tr>
<tr class="separator:aa744cf6af25ebcf4e5a3147682485026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35d2a68047dec5a60388ba287430c212" id="r_a35d2a68047dec5a60388ba287430c212"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a35d2a68047dec5a60388ba287430c212">zeroGrads</a> ()</td></tr>
<tr class="memdesc:a35d2a68047dec5a60388ba287430c212"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zeros out all gradients in the model.  <br /></td></tr>
<tr class="separator:a35d2a68047dec5a60388ba287430c212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classMila_1_1Dnn_1_1Module"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classMila_1_1Dnn_1_1Module')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classMila_1_1Dnn_1_1Module.html">Mila::Dnn::Module&lt; TDeviceType, TInput, TOutput &gt;</a></td></tr>
<tr class="memitem:a9c68c425ffc1643d090c881f935b1d81 inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a9c68c425ffc1643d090c881f935b1d81"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a9c68c425ffc1643d090c881f935b1d81">Module</a> (const std::string &amp;device_name, const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a> &amp;config)</td></tr>
<tr class="memdesc:a9c68c425ffc1643d090c881f935b1d81 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor with device name.  <br /></td></tr>
<tr class="separator:a9c68c425ffc1643d090c881f935b1d81 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c3a64e5bc2b0d9464d341a86bf52a69 inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a2c3a64e5bc2b0d9464d341a86bf52a69"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a2c3a64e5bc2b0d9464d341a86bf52a69">Module</a> (std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt; context, const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a> &amp;config)</td></tr>
<tr class="memdesc:a2c3a64e5bc2b0d9464d341a86bf52a69 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor with a specific device context.  <br /></td></tr>
<tr class="separator:a2c3a64e5bc2b0d9464d341a86bf52a69 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a325c8ef88aae9f988c8ba90b815b85b3 inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a325c8ef88aae9f988c8ba90b815b85b3"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a325c8ef88aae9f988c8ba90b815b85b3">~Module</a> ()=default</td></tr>
<tr class="memdesc:a325c8ef88aae9f988c8ba90b815b85b3 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor for proper cleanup in derived classes.  <br /></td></tr>
<tr class="separator:a325c8ef88aae9f988c8ba90b815b85b3 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1163624b16a6518b2ed573f51827759d inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a1163624b16a6518b2ed573f51827759d"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">Compute::DeviceContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a1163624b16a6518b2ed573f51827759d">getDeviceContext</a> () const</td></tr>
<tr class="memdesc:a1163624b16a6518b2ed573f51827759d inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the device context for this module.  <br /></td></tr>
<tr class="separator:a1163624b16a6518b2ed573f51827759d inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94b3a479c6e9c49879ef2079d34df471 inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a94b3a479c6e9c49879ef2079d34df471"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">Compute::DeviceType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a94b3a479c6e9c49879ef2079d34df471">getDeviceType</a> () const</td></tr>
<tr class="memdesc:a94b3a479c6e9c49879ef2079d34df471 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the device type of the current device context.  <br /></td></tr>
<tr class="separator:a94b3a479c6e9c49879ef2079d34df471 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c8e8735eaf75d6bad6d454f7d23b2ca inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a2c8e8735eaf75d6bad6d454f7d23b2ca"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a2c8e8735eaf75d6bad6d454f7d23b2ca">getName</a> () const</td></tr>
<tr class="memdesc:a2c8e8735eaf75d6bad6d454f7d23b2ca inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the name of the module.  <br /></td></tr>
<tr class="separator:a2c8e8735eaf75d6bad6d454f7d23b2ca inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a980423a0db37b7680c3668a579d342 inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a4a980423a0db37b7680c3668a579d342"><td class="memItemLeft" align="right" valign="top">const auto &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a4a980423a0db37b7680c3668a579d342">getParameterTensors</a> () const</td></tr>
<tr class="memdesc:a4a980423a0db37b7680c3668a579d342 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the parameter tensors of this module.  <br /></td></tr>
<tr class="separator:a4a980423a0db37b7680c3668a579d342 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e2d974ab30511a0bafd4477bc9117f3 inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a2e2d974ab30511a0bafd4477bc9117f3"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputePrecision.html#af05f57f23853ffa03a13e968cd141b9d">ComputePrecision::Policy</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a2e2d974ab30511a0bafd4477bc9117f3">getPrecision</a> () const</td></tr>
<tr class="separator:a2e2d974ab30511a0bafd4477bc9117f3 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e8be0bc8f91844acfdce17c8cc85364 inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a8e8be0bc8f91844acfdce17c8cc85364"><td class="memItemLeft" align="right" valign="top">const auto &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a8e8be0bc8f91844acfdce17c8cc85364">getStateTensors</a> () const</td></tr>
<tr class="memdesc:a8e8be0bc8f91844acfdce17c8cc85364 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the state tensors of this module.  <br /></td></tr>
<tr class="separator:a8e8be0bc8f91844acfdce17c8cc85364 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af676dd818a0afaa6f2839b53c42fb72b inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_af676dd818a0afaa6f2839b53c42fb72b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#af676dd818a0afaa6f2839b53c42fb72b">isTraining</a> () const</td></tr>
<tr class="memdesc:af676dd818a0afaa6f2839b53c42fb72b inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the module is in training mode.  <br /></td></tr>
<tr class="separator:af676dd818a0afaa6f2839b53c42fb72b inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79dd1f9148ec935bc9bdf1a1f062019b inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a79dd1f9148ec935bc9bdf1a1f062019b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a79dd1f9148ec935bc9bdf1a1f062019b">load</a> (<a class="el" href="classMila_1_1Dnn_1_1Serialization_1_1ModelArchive.html">ModelArchive</a> &amp;archive)=0</td></tr>
<tr class="memdesc:a79dd1f9148ec935bc9bdf1a1f062019b inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load the module state from a zip archive.  <br /></td></tr>
<tr class="separator:a79dd1f9148ec935bc9bdf1a1f062019b inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1d548970ec07a9850fdad0dc1e4c1c2 inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_ae1d548970ec07a9850fdad0dc1e4c1c2"><td class="memItemLeft" align="right" valign="top">virtual size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#ae1d548970ec07a9850fdad0dc1e4c1c2">parameterCount</a> () const =0</td></tr>
<tr class="memdesc:ae1d548970ec07a9850fdad0dc1e4c1c2 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of trainable parameters in the module.  <br /></td></tr>
<tr class="separator:ae1d548970ec07a9850fdad0dc1e4c1c2 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d60df81d5e0f1db4e56aa0fb8d1319 inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a20d60df81d5e0f1db4e56aa0fb8d1319"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a20d60df81d5e0f1db4e56aa0fb8d1319">save</a> (<a class="el" href="classMila_1_1Dnn_1_1Serialization_1_1ModelArchive.html">ModelArchive</a> &amp;archive) const =0</td></tr>
<tr class="memdesc:a20d60df81d5e0f1db4e56aa0fb8d1319 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the module state to a zip archive.  <br /></td></tr>
<tr class="separator:a20d60df81d5e0f1db4e56aa0fb8d1319 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7b2a55c5d4108aa8eceb96c8db55004 inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_ac7b2a55c5d4108aa8eceb96c8db55004"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#ac7b2a55c5d4108aa8eceb96c8db55004">setTraining</a> (bool is_training)</td></tr>
<tr class="memdesc:ac7b2a55c5d4108aa8eceb96c8db55004 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the training mode of this module.  <br /></td></tr>
<tr class="separator:ac7b2a55c5d4108aa8eceb96c8db55004 inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a594cb38f73a3f8df511b582b3ec6c0ab inherit pub_methods_classMila_1_1Dnn_1_1Module" id="r_a594cb38f73a3f8df511b582b3ec6c0ab"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a594cb38f73a3f8df511b582b3ec6c0ab">toString</a> () const =0</td></tr>
<tr class="memdesc:a594cb38f73a3f8df511b582b3ec6c0ab inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert the module to a string representation.  <br /></td></tr>
<tr class="separator:a594cb38f73a3f8df511b582b3ec6c0ab inherit pub_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab59901a659ff871ef05ece757b127a3b" id="r_ab59901a659ff871ef05ece757b127a3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Model.html#a62884a84c2df2ac4b92b42234bca4bdf">MR</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#ab59901a659ff871ef05ece757b127a3b">last_inputs_</a></td></tr>
<tr class="memdesc:ab59901a659ff871ef05ece757b127a3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The most recent input tensor provided to <a class="el" href="classMila_1_1Dnn_1_1Model.html#a5d73c2f1afbb01476f9ba61844508f5b" title="Performs a forward pass through the model.">forward()</a>.  <br /></td></tr>
<tr class="separator:ab59901a659ff871ef05ece757b127a3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09cf523231abf6766c818d69f0ad3550" id="r_a09cf523231abf6766c818d69f0ad3550"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Model.html#a62884a84c2df2ac4b92b42234bca4bdf">MR</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a09cf523231abf6766c818d69f0ad3550">last_targets_</a></td></tr>
<tr class="memdesc:a09cf523231abf6766c818d69f0ad3550"><td class="mdescLeft">&#160;</td><td class="mdescRight">The most recent target tensor provided to <a class="el" href="classMila_1_1Dnn_1_1Model.html#a5d73c2f1afbb01476f9ba61844508f5b" title="Performs a forward pass through the model.">forward()</a>.  <br /></td></tr>
<tr class="separator:a09cf523231abf6766c818d69f0ad3550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classMila_1_1Dnn_1_1Module"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classMila_1_1Dnn_1_1Module')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classMila_1_1Dnn_1_1Module.html">Mila::Dnn::Module&lt; TDeviceType, TInput, TOutput &gt;</a></td></tr>
<tr class="memitem:a9f7fbe15857ace6c72f48003df61a06c inherit pro_attribs_classMila_1_1Dnn_1_1Module" id="r_a9f7fbe15857ace6c72f48003df61a06c"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::string, std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Module.html#a30d5b0cc3f9fa994c166180483b2ea51">MR</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a9f7fbe15857ace6c72f48003df61a06c">parameter_map_</a> = {}</td></tr>
<tr class="memdesc:a9f7fbe15857ace6c72f48003df61a06c inherit pro_attribs_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map of parameter names to parameter tensors.  <br /></td></tr>
<tr class="separator:a9f7fbe15857ace6c72f48003df61a06c inherit pro_attribs_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78cc537819a1c1a5f48b99782ad8315d inherit pro_attribs_classMila_1_1Dnn_1_1Module" id="r_a78cc537819a1c1a5f48b99782ad8315d"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::string, std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Module.html#a30d5b0cc3f9fa994c166180483b2ea51">MR</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a78cc537819a1c1a5f48b99782ad8315d">state_map_</a> = {}</td></tr>
<tr class="memdesc:a78cc537819a1c1a5f48b99782ad8315d inherit pro_attribs_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map of state names to state tensors.  <br /></td></tr>
<tr class="separator:a78cc537819a1c1a5f48b99782ad8315d inherit pro_attribs_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a0ca10625fcafe2818b9b1268be9dba0a" id="r_a0ca10625fcafe2818b9b1268be9dba0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a0ca10625fcafe2818b9b1268be9dba0a">initializeDevice</a> ()</td></tr>
<tr class="memdesc:a0ca10625fcafe2818b9b1268be9dba0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes device-specific resources.  <br /></td></tr>
<tr class="separator:a0ca10625fcafe2818b9b1268be9dba0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ac14e499c2facd7ba97b7e54935e9e842" id="r_ac14e499c2facd7ba97b7e54935e9e842"><td class="memItemLeft" align="right" valign="top">cudaGraph_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#ac14e499c2facd7ba97b7e54935e9e842">cuda_graph_</a> { nullptr }</td></tr>
<tr class="memdesc:ac14e499c2facd7ba97b7e54935e9e842"><td class="mdescLeft">&#160;</td><td class="mdescRight">CUDA graph for optimized execution.  <br /></td></tr>
<tr class="separator:ac14e499c2facd7ba97b7e54935e9e842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1db38704e7b4f4dcf1ca5ddfe405f75c" id="r_a1db38704e7b4f4dcf1ca5ddfe405f75c"><td class="memItemLeft" align="right" valign="top">cudaGraphExec_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a1db38704e7b4f4dcf1ca5ddfe405f75c">cuda_graph_exec_</a> { nullptr }</td></tr>
<tr class="memdesc:a1db38704e7b4f4dcf1ca5ddfe405f75c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executable instance of the CUDA graph.  <br /></td></tr>
<tr class="separator:a1db38704e7b4f4dcf1ca5ddfe405f75c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27fc9d50e11d20a787862020d22b22e4" id="r_a27fc9d50e11d20a787862020d22b22e4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a27fc9d50e11d20a787862020d22b22e4">graph_capture_active_</a> { false }</td></tr>
<tr class="memdesc:a27fc9d50e11d20a787862020d22b22e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag indicating whether CUDA graph capture is active.  <br /></td></tr>
<tr class="separator:a27fc9d50e11d20a787862020d22b22e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66f98188063483b7659d61e9b7856c0c" id="r_a66f98188063483b7659d61e9b7856c0c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a66f98188063483b7659d61e9b7856c0c">graph_initialized_</a> { false }</td></tr>
<tr class="memdesc:a66f98188063483b7659d61e9b7856c0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag indicating whether CUDA graph has been initialized.  <br /></td></tr>
<tr class="separator:a66f98188063483b7659d61e9b7856c0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3546c95d95f362bf58ecb90ab40ec6aa" id="r_a3546c95d95f362bf58ecb90ab40ec6aa"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a3546c95d95f362bf58ecb90ab40ec6aa">is_built_</a> { false }</td></tr>
<tr class="memdesc:a3546c95d95f362bf58ecb90ab40ec6aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates whether the model has been built.  <br /></td></tr>
<tr class="separator:a3546c95d95f362bf58ecb90ab40ec6aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefee73fae81d08e5dfd50c36865f0f14" id="r_aefee73fae81d08e5dfd50c36865f0f14"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#aefee73fae81d08e5dfd50c36865f0f14">is_training_</a> { false }</td></tr>
<tr class="memdesc:aefee73fae81d08e5dfd50c36865f0f14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates whether the model is in training mode.  <br /></td></tr>
<tr class="separator:aefee73fae81d08e5dfd50c36865f0f14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a235f872e086ac6960fc8674833e3d2a8" id="r_a235f872e086ac6960fc8674833e3d2a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">Compute::DeviceType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a235f872e086ac6960fc8674833e3d2a8">old_device_type_</a> { <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4a54c82ef76ecbbd4c2293e09bae01b54e">Compute::DeviceType::Cpu</a> }</td></tr>
<tr class="memdesc:a235f872e086ac6960fc8674833e3d2a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Previous device type for cleanup.  <br /></td></tr>
<tr class="separator:a235f872e086ac6960fc8674833e3d2a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade293b247ecd47c0a880999836aaeb5d" id="r_ade293b247ecd47c0a880999836aaeb5d"><td class="memItemLeft" align="right" valign="top">cudaStream_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#ade293b247ecd47c0a880999836aaeb5d">stream_</a> { nullptr }</td></tr>
<tr class="memdesc:ade293b247ecd47c0a880999836aaeb5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The CUDA stream for device memory resource.  <br /></td></tr>
<tr class="separator:ade293b247ecd47c0a880999836aaeb5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62d8f1fbf9613044fdeca64dff704e9d" id="r_a62d8f1fbf9613044fdeca64dff704e9d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Model.html#a62d8f1fbf9613044fdeca64dff704e9d">stream_created_</a> { false }</td></tr>
<tr class="memdesc:a62d8f1fbf9613044fdeca64dff704e9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag indicating whether we created the stream.  <br /></td></tr>
<tr class="separator:a62d8f1fbf9613044fdeca64dff704e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classMila_1_1Dnn_1_1Module"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classMila_1_1Dnn_1_1Module')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classMila_1_1Dnn_1_1Module.html">Mila::Dnn::Module&lt; TDeviceType, TInput, TOutput &gt;</a></td></tr>
<tr class="memitem:aa9c385b11a63c2e17eed36c807209c50 inherit pro_methods_classMila_1_1Dnn_1_1Module" id="r_aa9c385b11a63c2e17eed36c807209c50"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#aa9c385b11a63c2e17eed36c807209c50">parametersToString</a> () const</td></tr>
<tr class="memdesc:aa9c385b11a63c2e17eed36c807209c50 inherit pro_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method to convert parameters to string representation.  <br /></td></tr>
<tr class="separator:aa9c385b11a63c2e17eed36c807209c50 inherit pro_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a301bf2920ad45f578126c1a68d2b37a0 inherit pro_methods_classMila_1_1Dnn_1_1Module" id="r_a301bf2920ad45f578126c1a68d2b37a0"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Module.html#a301bf2920ad45f578126c1a68d2b37a0">stateToString</a> () const</td></tr>
<tr class="memdesc:a301bf2920ad45f578126c1a68d2b37a0 inherit pro_methods_classMila_1_1Dnn_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method to convert state tensors to string representation.  <br /></td></tr>
<tr class="separator:a301bf2920ad45f578126c1a68d2b37a0 inherit pro_methods_classMila_1_1Dnn_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput = float, typename TOutput = TInput&gt;<br />
requires ValidTensorTypes&lt;TInput, TOutput&gt;<br />
class Mila::Dnn::Model&lt; TDeviceType, TInput, TOutput &gt;</div><p>A class representing a neural network model. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TDeviceType</td><td>The device type (CPU or CUDA) on which to perform computations. </td></tr>
    <tr><td class="paramname">TInput</td><td>The input data type for the model. </td></tr>
    <tr><td class="paramname">TOutput</td><td>The output data type for the model, defaults to TInput. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a00faee3dac2291892822902b6a7316b3" name="a00faee3dac2291892822902b6a7316b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00faee3dac2291892822902b6a7316b3">&#9670;&#160;</a></span>ModuleBase</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::ModuleBase =  <a class="el" href="classMila_1_1Dnn_1_1Module.html">Module</a>&lt;TDeviceType, TInput, TOutput&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Base class type for the module. </p>

</div>
</div>
<a id="a62884a84c2df2ac4b92b42234bca4bdf" name="a62884a84c2df2ac4b92b42234bca4bdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62884a84c2df2ac4b92b42234bca4bdf">&#9670;&#160;</a></span>MR</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::MR =  std::conditional_t&lt;TDeviceType == DeviceType::Cuda, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CudaMemoryResource.html">CudaMemoryResource</a>, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1CpuMemoryResource.html">CpuMemoryResource</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Memory resource type. </p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a213f48c2d2127c2c4f08b01cfa2cb109" name="a213f48c2d2127c2c4f08b01cfa2cb109"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a213f48c2d2127c2c4f08b01cfa2cb109">&#9670;&#160;</a></span>Model() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::Model </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new <a class="el" href="classMila_1_1Dnn_1_1Model.html" title="A class representing a neural network model.">Model</a> object with the default device context. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a213f48c2d2127c2c4f08b01cfa2cb109_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a213f48c2d2127c2c4f08b01cfa2cb109_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a213f48c2d2127c2c4f08b01cfa2cb109_cgraph" id="aclassMila_1_1Dnn_1_1Model_a213f48c2d2127c2c4f08b01cfa2cb109_cgraph">
<area shape="rect" title="Constructs a new Model object with the default device context." alt="" coords="5,13,185,38"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a0ca10625fcafe2818b9b1268be9dba0a" title="Initializes device&#45;specific resources." alt="" coords="233,5,429,45"/>
<area shape="poly" title=" " alt="" coords="186,23,220,23,220,28,186,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a1163624b16a6518b2ed573f51827759d" title="Get the device context for this module." alt="" coords="477,5,625,45"/>
<area shape="poly" title=" " alt="" coords="430,23,464,23,464,28,430,28"/>
</map>
</div>

</div>
</div>
<a id="ab169844bb0aacc1d069d7f651624370c" name="ab169844bb0aacc1d069d7f651624370c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab169844bb0aacc1d069d7f651624370c">&#9670;&#160;</a></span>Model() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::Model </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new <a class="el" href="classMila_1_1Dnn_1_1Model.html" title="A class representing a neural network model.">Model</a> object with a specific device context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>The device context to use for this model. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_ab169844bb0aacc1d069d7f651624370c_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_ab169844bb0aacc1d069d7f651624370c_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_ab169844bb0aacc1d069d7f651624370c_cgraph" id="aclassMila_1_1Dnn_1_1Model_ab169844bb0aacc1d069d7f651624370c_cgraph">
<area shape="rect" title="Constructs a new Model object with a specific device context." alt="" coords="5,13,185,38"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a0ca10625fcafe2818b9b1268be9dba0a" title="Initializes device&#45;specific resources." alt="" coords="233,5,429,45"/>
<area shape="poly" title=" " alt="" coords="186,23,220,23,220,28,186,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a1163624b16a6518b2ed573f51827759d" title="Get the device context for this module." alt="" coords="477,5,625,45"/>
<area shape="poly" title=" " alt="" coords="430,23,464,23,464,28,430,28"/>
</map>
</div>

</div>
</div>
<a id="a93f0b38d530576a5f93316dc00047b13" name="a93f0b38d530576a5f93316dc00047b13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93f0b38d530576a5f93316dc00047b13">&#9670;&#160;</a></span>Model() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::Model </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>device_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new <a class="el" href="classMila_1_1Dnn_1_1Model.html" title="A class representing a neural network model.">Model</a> object with a specific device name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device_name</td><td>The name of the device to use (e.g., "CUDA:0", "CPU"). </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a93f0b38d530576a5f93316dc00047b13_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a93f0b38d530576a5f93316dc00047b13_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a93f0b38d530576a5f93316dc00047b13_cgraph" id="aclassMila_1_1Dnn_1_1Model_a93f0b38d530576a5f93316dc00047b13_cgraph">
<area shape="rect" title="Constructs a new Model object with a specific device name." alt="" coords="5,13,185,38"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a0ca10625fcafe2818b9b1268be9dba0a" title="Initializes device&#45;specific resources." alt="" coords="233,5,429,45"/>
<area shape="poly" title=" " alt="" coords="186,23,220,23,220,28,186,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a1163624b16a6518b2ed573f51827759d" title="Get the device context for this module." alt="" coords="477,5,625,45"/>
<area shape="poly" title=" " alt="" coords="430,23,464,23,464,28,430,28"/>
</map>
</div>

</div>
</div>
<a id="a03db5df5372ccbfcac84cb58d9730986" name="a03db5df5372ccbfcac84cb58d9730986"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03db5df5372ccbfcac84cb58d9730986">&#9670;&#160;</a></span>~Model()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::~<a class="el" href="classMila_1_1Dnn_1_1Model.html">Model</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroys the <a class="el" href="classMila_1_1Dnn_1_1Model.html" title="A class representing a neural network model.">Model</a> object. </p>
<p>Cleans up resources such as CUDA streams. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a03db5df5372ccbfcac84cb58d9730986_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a03db5df5372ccbfcac84cb58d9730986_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a03db5df5372ccbfcac84cb58d9730986_cgraph" id="aclassMila_1_1Dnn_1_1Model_a03db5df5372ccbfcac84cb58d9730986_cgraph">
<area shape="rect" title="Destroys the Model object." alt="" coords="5,5,145,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a1163624b16a6518b2ed573f51827759d" title="Get the device context for this module." alt="" coords="193,5,341,45"/>
<area shape="poly" title=" " alt="" coords="146,23,179,23,179,28,146,28"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="acde701a4d3bb955a43483631119f0859" name="acde701a4d3bb955a43483631119f0859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acde701a4d3bb955a43483631119f0859">&#9670;&#160;</a></span>backward()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::backward </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs a backward pass through the model. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>if the model has not been built or if forward was not called with targets. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_acde701a4d3bb955a43483631119f0859_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_acde701a4d3bb955a43483631119f0859_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_acde701a4d3bb955a43483631119f0859_cgraph" id="aclassMila_1_1Dnn_1_1Model_acde701a4d3bb955a43483631119f0859_cgraph">
<area shape="rect" title="Performs a backward pass through the model." alt="" coords="5,13,208,38"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#af676dd818a0afaa6f2839b53c42fb72b" title="Check if the module is in training mode." alt="" coords="256,5,404,45"/>
<area shape="poly" title=" " alt="" coords="208,23,242,23,242,28,208,28"/>
</map>
</div>

</div>
</div>
<a id="a8735b9d7aa4e4a84ff9ea2bcea46e993" name="a8735b9d7aa4e4a84ff9ea2bcea46e993"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8735b9d7aa4e4a84ff9ea2bcea46e993">&#9670;&#160;</a></span>build()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::build </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Builds the model. </p>
<p>Sets the training mode for all modules and performs any necessary graph validation or optimizations. </p><dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>if the model has already been built. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae33c8f6f72dc13d99e15278057c6fd03" name="ae33c8f6f72dc13d99e15278057c6fd03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae33c8f6f72dc13d99e15278057c6fd03">&#9670;&#160;</a></span>calculateLoss()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<div class="memtemplate">
template&lt;typename TMR &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::calculateLoss </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, TMR &gt; &amp;&#160;</td>
          <td class="paramname"><em>targets</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the loss for the given targets and current model outputs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">targets</td><td>The target tensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The loss value. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_ae33c8f6f72dc13d99e15278057c6fd03_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_ae33c8f6f72dc13d99e15278057c6fd03_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_ae33c8f6f72dc13d99e15278057c6fd03_icgraph" id="aclassMila_1_1Dnn_1_1Model_ae33c8f6f72dc13d99e15278057c6fd03_icgraph">
<area shape="rect" title="Calculate the loss for the given targets and current model outputs." alt="" coords="489,31,717,56"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a5d73c2f1afbb01476f9ba61844508f5b" title="Performs a forward pass through the model." alt="" coords="251,31,441,56"/>
<area shape="poly" title=" " alt="" coords="476,46,441,46,441,41,476,41"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#aa81d44981751eb9ce8223f3bd255aba4" title="Evaluate the model on a dataset." alt="" coords="5,5,203,31"/>
<area shape="poly" title=" " alt="" coords="237,35,203,31,203,26,237,29"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#ad6d1b284a6a4426716842127fc0d3de9" title="Predict outputs for the given inputs." alt="" coords="11,55,197,80"/>
<area shape="poly" title=" " alt="" coords="237,57,197,61,196,56,237,51"/>
</map>
</div>

</div>
</div>
<a id="a81b4080be583521185ac736a9f6db23f" name="a81b4080be583521185ac736a9f6db23f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81b4080be583521185ac736a9f6db23f">&#9670;&#160;</a></span>captureGraphBegin()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::captureGraphBegin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Start capturing operations for a CUDA graph. </p>
<p>This begins recording operations to a CUDA graph for later replay. Only applicable for CUDA devices. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a81b4080be583521185ac736a9f6db23f_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a81b4080be583521185ac736a9f6db23f_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a81b4080be583521185ac736a9f6db23f_cgraph" id="aclassMila_1_1Dnn_1_1Model_a81b4080be583521185ac736a9f6db23f_cgraph">
<area shape="rect" title="Start capturing operations for a CUDA graph." alt="" coords="5,49,195,89"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a6632abec2ee05c8ddece16bcfd216217" title="Gets the compute device for this model." alt="" coords="243,5,449,31"/>
<area shape="poly" title=" " alt="" coords="194,47,269,31,270,36,195,52"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a1163624b16a6518b2ed573f51827759d" title="Get the device context for this module." alt="" coords="497,23,645,63"/>
<area shape="poly" title=" " alt="" coords="195,61,483,45,484,51,195,66"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a94b3a479c6e9c49879ef2079d34df471" title="Get the device type of the current device context." alt="" coords="272,106,420,146"/>
<area shape="poly" title=" " alt="" coords="187,86,259,103,258,108,186,91"/>
<area shape="poly" title=" " alt="" coords="450,27,484,31,483,36,449,32"/>
</map>
</div>

</div>
</div>
<a id="aa63470db21258487f07bf096edcd99aa" name="aa63470db21258487f07bf096edcd99aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa63470db21258487f07bf096edcd99aa">&#9670;&#160;</a></span>captureGraphEnd()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::captureGraphEnd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>End capturing operations for a CUDA graph. </p>
<p>This finalizes the CUDA graph and prepares it for execution. Only applicable for CUDA devices. </p>

</div>
</div>
<a id="aa81d44981751eb9ce8223f3bd255aba4" name="aa81d44981751eb9ce8223f3bd255aba4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa81d44981751eb9ce8223f3bd255aba4">&#9670;&#160;</a></span>evaluate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<div class="memtemplate">
template&lt;typename TDataLoader &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::evaluate </td>
          <td>(</td>
          <td class="paramtype">TDataLoader &amp;&#160;</td>
          <td class="paramname"><em>data_loader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate the model on a dataset. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data_loader</td><td>The data loader for evaluation data. </td></tr>
    <tr><td class="paramname">verbose</td><td>Whether to print evaluation progress. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The average loss on the evaluation dataset. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_aa81d44981751eb9ce8223f3bd255aba4_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_aa81d44981751eb9ce8223f3bd255aba4_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_aa81d44981751eb9ce8223f3bd255aba4_cgraph" id="aclassMila_1_1Dnn_1_1Model_aa81d44981751eb9ce8223f3bd255aba4_cgraph">
<area shape="rect" title="Evaluate the model on a dataset." alt="" coords="5,60,203,85"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a5d73c2f1afbb01476f9ba61844508f5b" title="Performs a forward pass through the model." alt="" coords="279,35,469,60"/>
<area shape="poly" title=" " alt="" coords="203,61,265,55,265,60,203,66"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a4d17b2f7212ced5f886ab7b0a6fdb5d1" title="Sets the training mode for the model." alt="" coords="251,84,497,109"/>
<area shape="poly" title=" " alt="" coords="203,79,237,82,237,87,203,84"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#ae33c8f6f72dc13d99e15278057c6fd03" title="Calculate the loss for the given targets and current model outputs." alt="" coords="545,5,773,31"/>
<area shape="poly" title=" " alt="" coords="469,35,531,28,532,34,470,40"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html#aea6f6d11627444aba7d2069f1cef01d4" title=" " alt="" coords="588,55,731,95"/>
<area shape="poly" title=" " alt="" coords="470,54,575,64,574,70,469,59"/>
</map>
</div>

</div>
</div>
<a id="ac6464fe4d7a422f617e588a642c04971" name="ac6464fe4d7a422f617e588a642c04971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6464fe4d7a422f617e588a642c04971">&#9670;&#160;</a></span>executeGraph()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::executeGraph </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Execute the captured CUDA graph. </p>
<p>Replays the previously captured operations for fast execution. Only applicable for CUDA devices with a previously captured graph. </p>

</div>
</div>
<a id="a5d73c2f1afbb01476f9ba61844508f5b" name="a5d73c2f1afbb01476f9ba61844508f5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d73c2f1afbb01476f9ba61844508f5b">&#9670;&#160;</a></span>forward()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::forward </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, <a class="el" href="classMila_1_1Dnn_1_1Model.html#a62884a84c2df2ac4b92b42234bca4bdf">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>inputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, <a class="el" href="classMila_1_1Dnn_1_1Model.html#a62884a84c2df2ac4b92b42234bca4bdf">MR</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>targets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs a forward pass through the model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inputs</td><td>The input tensor. </td></tr>
    <tr><td class="paramname">targets</td><td>Optional target tensor for loss calculation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>if the model has not been built. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The loss value if targets are provided, otherwise -1.0. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a5d73c2f1afbb01476f9ba61844508f5b_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a5d73c2f1afbb01476f9ba61844508f5b_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a5d73c2f1afbb01476f9ba61844508f5b_cgraph" id="aclassMila_1_1Dnn_1_1Model_a5d73c2f1afbb01476f9ba61844508f5b_cgraph">
<area shape="rect" title="Performs a forward pass through the model." alt="" coords="5,35,196,60"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#ae33c8f6f72dc13d99e15278057c6fd03" title="Calculate the loss for the given targets and current model outputs." alt="" coords="244,5,472,31"/>
<area shape="poly" title=" " alt="" coords="196,34,233,30,233,35,196,39"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html#aea6f6d11627444aba7d2069f1cef01d4" title=" " alt="" coords="287,55,429,95"/>
<area shape="poly" title=" " alt="" coords="196,55,273,63,273,69,196,60"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a5d73c2f1afbb01476f9ba61844508f5b_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a5d73c2f1afbb01476f9ba61844508f5b_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a5d73c2f1afbb01476f9ba61844508f5b_icgraph" id="aclassMila_1_1Dnn_1_1Model_a5d73c2f1afbb01476f9ba61844508f5b_icgraph">
<area shape="rect" title="Performs a forward pass through the model." alt="" coords="251,31,441,56"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#aa81d44981751eb9ce8223f3bd255aba4" title="Evaluate the model on a dataset." alt="" coords="5,5,203,31"/>
<area shape="poly" title=" " alt="" coords="237,35,203,31,203,26,237,29"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#ad6d1b284a6a4426716842127fc0d3de9" title="Predict outputs for the given inputs." alt="" coords="11,55,197,80"/>
<area shape="poly" title=" " alt="" coords="237,57,197,61,196,56,237,51"/>
</map>
</div>

</div>
</div>
<a id="a6632abec2ee05c8ddece16bcfd216217" name="a6632abec2ee05c8ddece16bcfd216217"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6632abec2ee05c8ddece16bcfd216217">&#9670;&#160;</a></span>getDevice()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1ComputeDevice.html">Compute::ComputeDevice</a> &amp; <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::getDevice </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the compute device for this model. </p>
<dl class="section return"><dt>Returns</dt><dd>Reference to the model's compute device. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a6632abec2ee05c8ddece16bcfd216217_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a6632abec2ee05c8ddece16bcfd216217_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a6632abec2ee05c8ddece16bcfd216217_cgraph" id="aclassMila_1_1Dnn_1_1Model_a6632abec2ee05c8ddece16bcfd216217_cgraph">
<area shape="rect" title="Gets the compute device for this model." alt="" coords="5,13,212,38"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a1163624b16a6518b2ed573f51827759d" title="Get the device context for this module." alt="" coords="260,5,408,45"/>
<area shape="poly" title=" " alt="" coords="212,23,246,23,246,28,212,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a6632abec2ee05c8ddece16bcfd216217_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a6632abec2ee05c8ddece16bcfd216217_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a6632abec2ee05c8ddece16bcfd216217_icgraph" id="aclassMila_1_1Dnn_1_1Model_a6632abec2ee05c8ddece16bcfd216217_icgraph">
<area shape="rect" title="Gets the compute device for this model." alt="" coords="243,42,449,67"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a81b4080be583521185ac736a9f6db23f" title="Start capturing operations for a CUDA graph." alt="" coords="5,5,195,45"/>
<area shape="poly" title=" " alt="" coords="229,43,194,39,195,34,229,38"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#ab1d7e81eeb43446ce683e4990cbcf34c" title="Prints the model&#39;s structure and total number of parameters." alt="" coords="15,70,185,95"/>
<area shape="poly" title=" " alt="" coords="229,71,186,76,185,70,229,65"/>
</map>
</div>

</div>
</div>
<a id="a66ecbc608d680933a9f3d9f9b323af29" name="a66ecbc608d680933a9f3d9f9b323af29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66ecbc608d680933a9f3d9f9b323af29">&#9670;&#160;</a></span>getStream()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cudaStream_t <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::getStream </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the current CUDA stream. </p>
<dl class="section return"><dt>Returns</dt><dd>The CUDA stream used by this model. </dd></dl>

</div>
</div>
<a id="a0ca10625fcafe2818b9b1268be9dba0a" name="a0ca10625fcafe2818b9b1268be9dba0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ca10625fcafe2818b9b1268be9dba0a">&#9670;&#160;</a></span>initializeDevice()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::initializeDevice </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes device-specific resources. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a0ca10625fcafe2818b9b1268be9dba0a_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a0ca10625fcafe2818b9b1268be9dba0a_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a0ca10625fcafe2818b9b1268be9dba0a_cgraph" id="aclassMila_1_1Dnn_1_1Model_a0ca10625fcafe2818b9b1268be9dba0a_cgraph">
<area shape="rect" title="Initializes device&#45;specific resources." alt="" coords="5,5,201,45"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a1163624b16a6518b2ed573f51827759d" title="Get the device context for this module." alt="" coords="249,5,397,45"/>
<area shape="poly" title=" " alt="" coords="202,23,236,23,236,28,202,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a0ca10625fcafe2818b9b1268be9dba0a_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a0ca10625fcafe2818b9b1268be9dba0a_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a0ca10625fcafe2818b9b1268be9dba0a_icgraph" id="aclassMila_1_1Dnn_1_1Model_a0ca10625fcafe2818b9b1268be9dba0a_icgraph">
<area shape="rect" title="Initializes device&#45;specific resources." alt="" coords="512,73,708,113"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a213f48c2d2127c2c4f08b01cfa2cb109" title="Constructs a new Model object with the default device context." alt="" coords="271,5,451,31"/>
<area shape="poly" title=" " alt="" coords="542,70,463,45,420,33,421,28,465,39,544,65"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a93f0b38d530576a5f93316dc00047b13" title="Constructs a new Model object with a specific device name." alt="" coords="271,55,451,80"/>
<area shape="poly" title=" " alt="" coords="498,84,451,79,452,74,498,79"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#ab169844bb0aacc1d069d7f651624370c" title="Constructs a new Model object with a specific device context." alt="" coords="271,104,451,129"/>
<area shape="poly" title=" " alt="" coords="498,106,452,111,451,105,498,101"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a028247ab95727a904493b18c1d73a588" title="Sets the device to use for this model by name." alt="" coords="259,153,464,179"/>
<area shape="poly" title=" " alt="" coords="540,120,465,143,418,156,416,151,463,138,538,114"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#aa90eec602d8cc14c8a4e95680f25ae44" title="Sets the device to use for this model by CUDA device ID." alt="" coords="5,153,211,179"/>
<area shape="poly" title=" " alt="" coords="245,169,211,169,211,163,245,163"/>
</map>
</div>

</div>
</div>
<a id="a15d9a5fd835693873e3e7b501af38464" name="a15d9a5fd835693873e3e7b501af38464"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15d9a5fd835693873e3e7b501af38464">&#9670;&#160;</a></span>loadCheckpoint()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::loadCheckpoint </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Loads the model's state from a checkpoint file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The path to the checkpoint file to load. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a13832fb45674627c3bdbe3e9abe5141a" name="a13832fb45674627c3bdbe3e9abe5141a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13832fb45674627c3bdbe3e9abe5141a">&#9670;&#160;</a></span>parameters()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the total number of parameters in the model. </p>
<dl class="section return"><dt>Returns</dt><dd>size_t The total number of parameters. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a13832fb45674627c3bdbe3e9abe5141a_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a13832fb45674627c3bdbe3e9abe5141a_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a13832fb45674627c3bdbe3e9abe5141a_icgraph" id="aclassMila_1_1Dnn_1_1Model_a13832fb45674627c3bdbe3e9abe5141a_icgraph">
<area shape="rect" title="Calculates the total number of parameters in the model." alt="" coords="224,5,439,31"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#ab1d7e81eeb43446ce683e4990cbcf34c" title="Prints the model&#39;s structure and total number of parameters." alt="" coords="5,5,176,31"/>
<area shape="poly" title=" " alt="" coords="210,21,176,21,176,15,210,15"/>
</map>
</div>

</div>
</div>
<a id="ad6d1b284a6a4426716842127fc0d3de9" name="ad6d1b284a6a4426716842127fc0d3de9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6d1b284a6a4426716842127fc0d3de9">&#9670;&#160;</a></span>predict()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<div class="memtemplate">
template&lt;typename TMR &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TOutput, TMR &gt; <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::predict </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt; TInput, TMR &gt; &amp;&#160;</td>
          <td class="paramname"><em>inputs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Predict outputs for the given inputs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inputs</td><td>The input tensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The output tensor. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_ad6d1b284a6a4426716842127fc0d3de9_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_ad6d1b284a6a4426716842127fc0d3de9_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_ad6d1b284a6a4426716842127fc0d3de9_cgraph" id="aclassMila_1_1Dnn_1_1Model_ad6d1b284a6a4426716842127fc0d3de9_cgraph">
<area shape="rect" title="Predict outputs for the given inputs." alt="" coords="5,60,191,85"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a5d73c2f1afbb01476f9ba61844508f5b" title="Performs a forward pass through the model." alt="" coords="267,35,457,60"/>
<area shape="poly" title=" " alt="" coords="190,61,253,55,253,60,191,66"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a4d17b2f7212ced5f886ab7b0a6fdb5d1" title="Sets the training mode for the model." alt="" coords="239,84,485,109"/>
<area shape="poly" title=" " alt="" coords="191,78,225,82,225,87,190,84"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#ae33c8f6f72dc13d99e15278057c6fd03" title="Calculate the loss for the given targets and current model outputs." alt="" coords="533,5,761,31"/>
<area shape="poly" title=" " alt="" coords="457,35,519,28,520,34,458,40"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Tensor.html#aea6f6d11627444aba7d2069f1cef01d4" title=" " alt="" coords="576,55,719,95"/>
<area shape="poly" title=" " alt="" coords="458,54,563,64,562,70,457,59"/>
</map>
</div>

</div>
</div>
<a id="ab1d7e81eeb43446ce683e4990cbcf34c" name="ab1d7e81eeb43446ce683e4990cbcf34c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1d7e81eeb43446ce683e4990cbcf34c">&#9670;&#160;</a></span>print()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::print </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prints the model's structure and total number of parameters. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_ab1d7e81eeb43446ce683e4990cbcf34c_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_ab1d7e81eeb43446ce683e4990cbcf34c_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_ab1d7e81eeb43446ce683e4990cbcf34c_cgraph" id="aclassMila_1_1Dnn_1_1Model_ab1d7e81eeb43446ce683e4990cbcf34c_cgraph">
<area shape="rect" title="Prints the model&#39;s structure and total number of parameters." alt="" coords="5,121,176,146"/>
<area shape="rect" href="namespaceMila_1_1Dnn_1_1Compute.html#abc57784bcbd77f21ea2524f0161e7e4f" title="Converts a DeviceType to its string representation." alt="" coords="256,5,407,45"/>
<area shape="poly" title=" " alt="" coords="110,118,160,87,223,55,242,47,244,52,225,60,162,92,112,123"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a6632abec2ee05c8ddece16bcfd216217" title="Gets the compute device for this model." alt="" coords="228,70,435,95"/>
<area shape="poly" title=" " alt="" coords="152,118,257,96,258,101,153,123"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a1163624b16a6518b2ed573f51827759d" title="Get the device context for this module." alt="" coords="487,88,635,128"/>
<area shape="poly" title=" " alt="" coords="176,126,473,110,473,115,176,131"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a94b3a479c6e9c49879ef2079d34df471" title="Get the device type of the current device context." alt="" coords="257,171,405,211"/>
<area shape="poly" title=" " alt="" coords="145,143,245,167,243,173,144,149"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a13832fb45674627c3bdbe3e9abe5141a" title="Calculates the total number of parameters in the model." alt="" coords="224,235,439,261"/>
<area shape="poly" title=" " alt="" coords="108,144,158,182,191,202,225,220,249,229,247,234,223,225,188,207,155,186,105,148"/>
<area shape="poly" title=" " alt="" coords="435,91,473,96,473,101,434,97"/>
</map>
</div>

</div>
</div>
<a id="ace6557fba6d0369620f807c6112fad42" name="ace6557fba6d0369620f807c6112fad42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace6557fba6d0369620f807c6112fad42">&#9670;&#160;</a></span>saveCheckpoint()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::saveCheckpoint </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Saves the model's state to a checkpoint file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The path where the checkpoint will be saved. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a028247ab95727a904493b18c1d73a588" name="a028247ab95727a904493b18c1d73a588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a028247ab95727a904493b18c1d73a588">&#9670;&#160;</a></span>setDevice() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::setDevice </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>device_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the device to use for this model by name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device_name</td><td>The name of the device to use (e.g., "CUDA:0", "CPU"). </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a028247ab95727a904493b18c1d73a588_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a028247ab95727a904493b18c1d73a588_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a028247ab95727a904493b18c1d73a588_cgraph" id="aclassMila_1_1Dnn_1_1Model_a028247ab95727a904493b18c1d73a588_cgraph">
<area shape="rect" title="Sets the device to use for this model by name." alt="" coords="5,13,211,38"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a0ca10625fcafe2818b9b1268be9dba0a" title="Initializes device&#45;specific resources." alt="" coords="259,5,455,45"/>
<area shape="poly" title=" " alt="" coords="211,23,245,23,245,28,211,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a1163624b16a6518b2ed573f51827759d" title="Get the device context for this module." alt="" coords="503,5,651,45"/>
<area shape="poly" title=" " alt="" coords="455,23,489,23,489,28,455,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a028247ab95727a904493b18c1d73a588_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a028247ab95727a904493b18c1d73a588_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a028247ab95727a904493b18c1d73a588_icgraph" id="aclassMila_1_1Dnn_1_1Model_a028247ab95727a904493b18c1d73a588_icgraph">
<area shape="rect" title="Sets the device to use for this model by name." alt="" coords="259,5,464,31"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#aa90eec602d8cc14c8a4e95680f25ae44" title="Sets the device to use for this model by CUDA device ID." alt="" coords="5,5,211,31"/>
<area shape="poly" title=" " alt="" coords="245,21,211,21,211,15,245,15"/>
</map>
</div>

</div>
</div>
<a id="aa90eec602d8cc14c8a4e95680f25ae44" name="aa90eec602d8cc14c8a4e95680f25ae44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa90eec602d8cc14c8a4e95680f25ae44">&#9670;&#160;</a></span>setDevice() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::setDevice </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the device to use for this model by CUDA device ID. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device_id</td><td>The ID of the CUDA device to use. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_aa90eec602d8cc14c8a4e95680f25ae44_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_aa90eec602d8cc14c8a4e95680f25ae44_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_aa90eec602d8cc14c8a4e95680f25ae44_cgraph" id="aclassMila_1_1Dnn_1_1Model_aa90eec602d8cc14c8a4e95680f25ae44_cgraph">
<area shape="rect" title="Sets the device to use for this model by CUDA device ID." alt="" coords="5,13,211,38"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a028247ab95727a904493b18c1d73a588" title="Sets the device to use for this model by name." alt="" coords="259,13,464,38"/>
<area shape="poly" title=" " alt="" coords="211,23,245,23,245,28,211,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#a0ca10625fcafe2818b9b1268be9dba0a" title="Initializes device&#45;specific resources." alt="" coords="512,5,708,45"/>
<area shape="poly" title=" " alt="" coords="464,23,498,23,498,28,464,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Module.html#a1163624b16a6518b2ed573f51827759d" title="Get the device context for this module." alt="" coords="756,5,904,45"/>
<area shape="poly" title=" " alt="" coords="709,23,742,23,742,28,709,28"/>
</map>
</div>

</div>
</div>
<a id="a4d17b2f7212ced5f886ab7b0a6fdb5d1" name="a4d17b2f7212ced5f886ab7b0a6fdb5d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d17b2f7212ced5f886ab7b0a6fdb5d1">&#9670;&#160;</a></span>setTrainingMode()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::setTrainingMode </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>training</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the training mode for the model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">training</td><td>The training mode to set. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Model_a4d17b2f7212ced5f886ab7b0a6fdb5d1_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Model_a4d17b2f7212ced5f886ab7b0a6fdb5d1_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Model_a4d17b2f7212ced5f886ab7b0a6fdb5d1_icgraph" id="aclassMila_1_1Dnn_1_1Model_a4d17b2f7212ced5f886ab7b0a6fdb5d1_icgraph">
<area shape="rect" title="Sets the training mode for the model." alt="" coords="251,31,497,56"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#aa81d44981751eb9ce8223f3bd255aba4" title="Evaluate the model on a dataset." alt="" coords="5,5,203,31"/>
<area shape="poly" title=" " alt="" coords="237,33,203,30,203,25,237,28"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Model.html#ad6d1b284a6a4426716842127fc0d3de9" title="Predict outputs for the given inputs." alt="" coords="11,55,197,80"/>
<area shape="poly" title=" " alt="" coords="237,58,197,62,197,56,237,53"/>
</map>
</div>

</div>
</div>
<a id="a2ff401d7efa05a64ef397f6b97781068" name="a2ff401d7efa05a64ef397f6b97781068"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ff401d7efa05a64ef397f6b97781068">&#9670;&#160;</a></span>train()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<div class="memtemplate">
template&lt;typename TDataLoader &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt; std::string, float &gt; <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::train </td>
          <td>(</td>
          <td class="paramtype">TDataLoader &amp;&#160;</td>
          <td class="paramname"><em>train_loader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TDataLoader *&#160;</td>
          <td class="paramname"><em>val_loader</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMila_1_1Dnn_1_1TrainingConfig.html">TrainingConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classMila_1_1Dnn_1_1ModelCallback.html">ModelCallback</a>&lt; TInput, TOutput &gt; * &gt; &amp;&#160;</td>
          <td class="paramname"><em>callbacks</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Train the model using the provided data loader and configuration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">train_loader</td><td>The data loader for training data. </td></tr>
    <tr><td class="paramname">val_loader</td><td>Optional data loader for validation data. </td></tr>
    <tr><td class="paramname">config</td><td>Training configuration parameters. </td></tr>
    <tr><td class="paramname">callbacks</td><td>Optional list of callbacks to be invoked during training. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A map of final training metrics. </dd></dl>

</div>
</div>
<a id="aa744cf6af25ebcf4e5a3147682485026" name="aa744cf6af25ebcf4e5a3147682485026"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa744cf6af25ebcf4e5a3147682485026">&#9670;&#160;</a></span>updateParameters()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::updateParameters </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>learning_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>beta1</em> = <code>0.9f</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>beta2</em> = <code>0.999f</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code>1e-8f</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>weight_decay</em> = <code>0.0f</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>step</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Updates the model parameters using the computed gradients. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">learning_rate</td><td>The learning rate for the update. </td></tr>
    <tr><td class="paramname">beta1</td><td>Beta1 parameter for Adam optimizer. </td></tr>
    <tr><td class="paramname">beta2</td><td>Beta2 parameter for Adam optimizer. </td></tr>
    <tr><td class="paramname">epsilon</td><td>Epsilon parameter for Adam optimizer. </td></tr>
    <tr><td class="paramname">weight_decay</td><td>Weight decay parameter for regularization. </td></tr>
    <tr><td class="paramname">step</td><td>Current optimization step for Adam. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a35d2a68047dec5a60388ba287430c212" name="a35d2a68047dec5a60388ba287430c212"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35d2a68047dec5a60388ba287430c212">&#9670;&#160;</a></span>zeroGrads()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::zeroGrads </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Zeros out all gradients in the model. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac14e499c2facd7ba97b7e54935e9e842" name="ac14e499c2facd7ba97b7e54935e9e842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac14e499c2facd7ba97b7e54935e9e842">&#9670;&#160;</a></span>cuda_graph_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cudaGraph_t <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::cuda_graph_ { nullptr }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CUDA graph for optimized execution. </p>

</div>
</div>
<a id="a1db38704e7b4f4dcf1ca5ddfe405f75c" name="a1db38704e7b4f4dcf1ca5ddfe405f75c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1db38704e7b4f4dcf1ca5ddfe405f75c">&#9670;&#160;</a></span>cuda_graph_exec_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cudaGraphExec_t <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::cuda_graph_exec_ { nullptr }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Executable instance of the CUDA graph. </p>

</div>
</div>
<a id="a27fc9d50e11d20a787862020d22b22e4" name="a27fc9d50e11d20a787862020d22b22e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27fc9d50e11d20a787862020d22b22e4">&#9670;&#160;</a></span>graph_capture_active_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::graph_capture_active_ { false }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag indicating whether CUDA graph capture is active. </p>

</div>
</div>
<a id="a66f98188063483b7659d61e9b7856c0c" name="a66f98188063483b7659d61e9b7856c0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66f98188063483b7659d61e9b7856c0c">&#9670;&#160;</a></span>graph_initialized_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::graph_initialized_ { false }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag indicating whether CUDA graph has been initialized. </p>

</div>
</div>
<a id="a3546c95d95f362bf58ecb90ab40ec6aa" name="a3546c95d95f362bf58ecb90ab40ec6aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3546c95d95f362bf58ecb90ab40ec6aa">&#9670;&#160;</a></span>is_built_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::is_built_ { false }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Indicates whether the model has been built. </p>

</div>
</div>
<a id="aefee73fae81d08e5dfd50c36865f0f14" name="aefee73fae81d08e5dfd50c36865f0f14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefee73fae81d08e5dfd50c36865f0f14">&#9670;&#160;</a></span>is_training_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::is_training_ { false }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Indicates whether the model is in training mode. </p>

</div>
</div>
<a id="ab59901a659ff871ef05ece757b127a3b" name="ab59901a659ff871ef05ece757b127a3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab59901a659ff871ef05ece757b127a3b">&#9670;&#160;</a></span>last_inputs_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt;TInput, <a class="el" href="classMila_1_1Dnn_1_1Model.html#a62884a84c2df2ac4b92b42234bca4bdf">MR</a>&gt; <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::last_inputs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The most recent input tensor provided to <a class="el" href="classMila_1_1Dnn_1_1Model.html#a5d73c2f1afbb01476f9ba61844508f5b" title="Performs a forward pass through the model.">forward()</a>. </p>

</div>
</div>
<a id="a09cf523231abf6766c818d69f0ad3550" name="a09cf523231abf6766c818d69f0ad3550"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09cf523231abf6766c818d69f0ad3550">&#9670;&#160;</a></span>last_targets_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMila_1_1Dnn_1_1Tensor.html">Tensor</a>&lt;TOutput, <a class="el" href="classMila_1_1Dnn_1_1Model.html#a62884a84c2df2ac4b92b42234bca4bdf">MR</a>&gt; <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::last_targets_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The most recent target tensor provided to <a class="el" href="classMila_1_1Dnn_1_1Model.html#a5d73c2f1afbb01476f9ba61844508f5b" title="Performs a forward pass through the model.">forward()</a>. </p>

</div>
</div>
<a id="a235f872e086ac6960fc8674833e3d2a8" name="a235f872e086ac6960fc8674833e3d2a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a235f872e086ac6960fc8674833e3d2a8">&#9670;&#160;</a></span>old_device_type_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">Compute::DeviceType</a> <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::old_device_type_ { <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4a54c82ef76ecbbd4c2293e09bae01b54e">Compute::DeviceType::Cpu</a> }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Previous device type for cleanup. </p>

</div>
</div>
<a id="ade293b247ecd47c0a880999836aaeb5d" name="ade293b247ecd47c0a880999836aaeb5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade293b247ecd47c0a880999836aaeb5d">&#9670;&#160;</a></span>stream_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cudaStream_t <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::stream_ { nullptr }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The CUDA stream for device memory resource. </p>

</div>
</div>
<a id="a62d8f1fbf9613044fdeca64dff704e9d" name="a62d8f1fbf9613044fdeca64dff704e9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62d8f1fbf9613044fdeca64dff704e9d">&#9670;&#160;</a></span>stream_created_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classMila_1_1Dnn_1_1Model.html">Mila::Dnn::Model</a>&lt; TDeviceType, TInput, TOutput &gt;::stream_created_ { false }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag indicating whether we created the stream. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/runner/work/Mila/Mila/Mila/Src/Dnn/Models/<a class="el" href="Model_8ixx.html">Model.ixx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceMila.html">Mila</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn.html">Dnn</a></li><li class="navelem"><a class="el" href="classMila_1_1Dnn_1_1Model.html">Model</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
