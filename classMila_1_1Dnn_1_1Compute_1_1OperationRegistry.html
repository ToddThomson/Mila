<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mila: Mila::Dnn::Compute::OperationRegistry Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mila
   </div>
   <div id="projectbrief">Deep Neural Network Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Mila::Dnn::Compute::OperationRegistry Class Reference<span class="mlabels"><span class="mlabel">export</span></span><div class="ingroups">module <a class="el" href="module_Compute_8OperationRegistry.html">Compute.OperationRegistry</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>A registry for operations that can be created based on operation names, type information, and device type.  
 <a href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationRegistry_1_1TypeID.html">TypeID</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type ID structure to uniquely identify operations based on input types and device type.  <a href="structMila_1_1Dnn_1_1Compute_1_1OperationRegistry_1_1TypeID.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationRegistry_1_1TypeIDHash.html">TypeIDHash</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hash function for <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationRegistry_1_1TypeID.html" title="Type ID structure to uniquely identify operations based on input types and device type.">TypeID</a> to use in unordered_map.  <a href="structMila_1_1Dnn_1_1Compute_1_1OperationRegistry_1_1TypeIDHash.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acf6c6e52c4c686b7547170bcd9857996" id="r_acf6c6e52c4c686b7547170bcd9857996"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType, typename TInput1 , typename TInput2 , typename TOutput &gt; <br />
requires ValidTensorTypes&lt;TInput1, TInput2&gt; &amp;&amp; ValidFloatTensorType&lt;TOutput&gt;</td></tr>
<tr class="memitem:acf6c6e52c4c686b7547170bcd9857996"><td class="memTemplItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html">BinaryOperation</a>&lt; TDeviceType, TInput1, TInput2, TOutput &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#acf6c6e52c4c686b7547170bcd9857996">createBinaryOperation</a> (const std::string &amp;operation_name, std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt; context, const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a> &amp;config) const</td></tr>
<tr class="memdesc:acf6c6e52c4c686b7547170bcd9857996"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a binary operation based on the type information, device type, and operation name.  <br /></td></tr>
<tr class="separator:acf6c6e52c4c686b7547170bcd9857996"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bcbbd6e474b44727458887b4685f43e" id="r_a8bcbbd6e474b44727458887b4685f43e"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType, typename TInput , typename TOutput &gt; </td></tr>
<tr class="memitem:a8bcbbd6e474b44727458887b4685f43e"><td class="memTemplItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html">UnaryOperation</a>&lt; TDeviceType, TInput, TOutput &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#a8bcbbd6e474b44727458887b4685f43e">createUnaryOperation</a> (const std::string &amp;operation_name, std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt; context, const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a> &amp;config) const</td></tr>
<tr class="memdesc:a8bcbbd6e474b44727458887b4685f43e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a unary operation based on the type information, device type, and operation name.  <br /></td></tr>
<tr class="separator:a8bcbbd6e474b44727458887b4685f43e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f844c971dfea81c0b37bd94dc5f0f19" id="r_a2f844c971dfea81c0b37bd94dc5f0f19"><td class="memItemLeft" align="right" valign="top">std::optional&lt; <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1FusedOpMeta.html">FusedOpMeta</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#a2f844c971dfea81c0b37bd94dc5f0f19">findFusedMatch</a> (const std::vector&lt; std::string &gt; &amp;child_types, <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> device_type, std::type_index precision_type, const std::string &amp;variant=&quot;Default&quot;)</td></tr>
<tr class="memdesc:a2f844c971dfea81c0b37bd94dc5f0f19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find a fused operation match for a sequence of module types.  <br /></td></tr>
<tr class="separator:a2f844c971dfea81c0b37bd94dc5f0f19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad057a9748abb405fe69a58bbd7581b6b" id="r_ad057a9748abb405fe69a58bbd7581b6b"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType, typename TInput1 , typename TInput2 , typename TOutput &gt; <br />
requires ValidTensorTypes&lt;TInput1, TInput2&gt;&amp;&amp; ValidFloatTensorType&lt;TOutput&gt;</td></tr>
<tr class="memitem:ad057a9748abb405fe69a58bbd7581b6b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#ad057a9748abb405fe69a58bbd7581b6b">registerBinaryOperation</a> (const std::string &amp;operation_name, std::function&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html">BinaryOperation</a>&lt; TDeviceType, TInput1, TInput2, TOutput &gt; &gt;(std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;, const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a> &amp;)&gt; creator)</td></tr>
<tr class="memdesc:ad057a9748abb405fe69a58bbd7581b6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a binary operation creator for a specific device type.  <br /></td></tr>
<tr class="separator:ad057a9748abb405fe69a58bbd7581b6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa911b14191b4358022447413a6a0260e" id="r_aa911b14191b4358022447413a6a0260e"><td class="memTemplParams" colspan="2">template&lt;typename TOutput &gt; </td></tr>
<tr class="memitem:aa911b14191b4358022447413a6a0260e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#aa911b14191b4358022447413a6a0260e">registerFusedOperation</a> (const std::vector&lt; <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a> &gt; &amp;operation_types, const std::string &amp;fused_op_name, const std::string &amp;variant=&quot;Default&quot;)</td></tr>
<tr class="memdesc:aa911b14191b4358022447413a6a0260e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a fused operation.  <br /></td></tr>
<tr class="separator:aa911b14191b4358022447413a6a0260e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f6cf8041f25ce8339b221d28d4ef022" id="r_a9f6cf8041f25ce8339b221d28d4ef022"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; <br />
requires ValidTensorType&lt;TInput&gt;&amp;&amp; ValidFloatTensorType&lt;TOutput&gt;</td></tr>
<tr class="memitem:a9f6cf8041f25ce8339b221d28d4ef022"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#a9f6cf8041f25ce8339b221d28d4ef022">registerUnaryOperation</a> (const std::string &amp;operation_name, std::function&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html">UnaryOperation</a>&lt; TDeviceType, TInput, TOutput &gt; &gt;(std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;, const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a> &amp;)&gt; creator)</td></tr>
<tr class="memdesc:a9f6cf8041f25ce8339b221d28d4ef022"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a unary operation creator for a specific device type.  <br /></td></tr>
<tr class="separator:a9f6cf8041f25ce8339b221d28d4ef022"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a56e3658d8b09dd388ca379aefcdeb17f" id="r_a56e3658d8b09dd388ca379aefcdeb17f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html">OperationRegistry</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#a56e3658d8b09dd388ca379aefcdeb17f">instance</a> ()</td></tr>
<tr class="memdesc:a56e3658d8b09dd388ca379aefcdeb17f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the singleton instance of the <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html" title="A registry for operations that can be created based on operation names, type information,...">OperationRegistry</a>.  <br /></td></tr>
<tr class="separator:a56e3658d8b09dd388ca379aefcdeb17f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-types" name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:af86abf3e657f9b2824aa4c3727507658" id="r_af86abf3e657f9b2824aa4c3727507658"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#af86abf3e657f9b2824aa4c3727507658">GenericCreator</a> = std::function&lt; std::shared_ptr&lt; void &gt;(std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;, const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a> &amp;)&gt;</td></tr>
<tr class="memdesc:af86abf3e657f9b2824aa4c3727507658"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type alias for a generic operation creator function.  <br /></td></tr>
<tr class="separator:af86abf3e657f9b2824aa4c3727507658"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aed4a5dbc9ba6539a08e4ccdf2d29514d" id="r_aed4a5dbc9ba6539a08e4ccdf2d29514d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#aed4a5dbc9ba6539a08e4ccdf2d29514d">OperationRegistry</a> ()=default</td></tr>
<tr class="memdesc:aed4a5dbc9ba6539a08e4ccdf2d29514d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <br /></td></tr>
<tr class="separator:aed4a5dbc9ba6539a08e4ccdf2d29514d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a0236156236cdf9972ba6ae141390be8b" id="r_a0236156236cdf9972ba6ae141390be8b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1FusedOpMeta.html">FusedOpMeta</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#a0236156236cdf9972ba6ae141390be8b">fused_ops_</a></td></tr>
<tr class="memdesc:a0236156236cdf9972ba6ae141390be8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of registered fused operations.  <br /></td></tr>
<tr class="separator:a0236156236cdf9972ba6ae141390be8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a271d82a0984be86df2b331f015f5f1f7" id="r_a271d82a0984be86df2b331f015f5f1f7"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationRegistry_1_1TypeID.html">TypeID</a>, std::unordered_map&lt; std::string, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#af86abf3e657f9b2824aa4c3727507658">GenericCreator</a> &gt;, <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationRegistry_1_1TypeIDHash.html">TypeIDHash</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#a271d82a0984be86df2b331f015f5f1f7">registry_</a></td></tr>
<tr class="memdesc:a271d82a0984be86df2b331f015f5f1f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registry mapping type info to operations.  <br /></td></tr>
<tr class="separator:a271d82a0984be86df2b331f015f5f1f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A registry for operations that can be created based on operation names, type information, and device type. </p>
<p>This singleton class manages the registration and creation of neural network operations in the <a class="el" href="namespaceMila.html">Mila</a> framework. It provides a unified interface to access different operation implementations across various device types (CPU, CUDA) and with different data types.</p>
<p>The registry supports:</p><ul>
<li>Type-safe registration and lookup of operations</li>
<li>Operation variants for specialized implementations</li>
<li>Fused operations for performance optimization</li>
<li>Automatic device-specific operation selection </li>
</ul>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="af86abf3e657f9b2824aa4c3727507658" name="af86abf3e657f9b2824aa4c3727507658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af86abf3e657f9b2824aa4c3727507658">&#9670;&#160;</a></span>GenericCreator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#af86abf3e657f9b2824aa4c3727507658">Mila::Dnn::Compute::OperationRegistry::GenericCreator</a> =  std::function&lt;std::shared_ptr&lt;void&gt;( std::shared_ptr&lt;<a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a>&gt;, const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a>&amp; )&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Type alias for a generic operation creator function. </p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aed4a5dbc9ba6539a08e4ccdf2d29514d" name="aed4a5dbc9ba6539a08e4ccdf2d29514d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed4a5dbc9ba6539a08e4ccdf2d29514d">&#9670;&#160;</a></span>OperationRegistry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mila::Dnn::Compute::OperationRegistry::OperationRegistry </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default constructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="acf6c6e52c4c686b7547170bcd9857996" name="acf6c6e52c4c686b7547170bcd9857996"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf6c6e52c4c686b7547170bcd9857996">&#9670;&#160;</a></span>createBinaryOperation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType, typename TInput1 , typename TInput2 , typename TOutput &gt; <br />
requires ValidTensorTypes&lt;TInput1, TInput2&gt; &amp;&amp; ValidFloatTensorType&lt;TOutput&gt;</div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html">BinaryOperation</a>&lt; TDeviceType, TInput1, TInput2, TOutput &gt; &gt; Mila::Dnn::Compute::OperationRegistry::createBinaryOperation </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>operation_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a binary operation based on the type information, device type, and operation name. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TDeviceType</td><td>The device type for the operation (defaults to CUDA). </td></tr>
    <tr><td class="paramname">TInput1</td><td>The first input tensor element type. </td></tr>
    <tr><td class="paramname">TInput2</td><td>The second input tensor element type (defaults to TInput1). </td></tr>
    <tr><td class="paramname">TOutput</td><td>The output tensor element type (defaults to TInput2). </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation_name</td><td>The name of the operation. </td></tr>
    <tr><td class="paramname">context</td><td>The device context to use for the operation. </td></tr>
    <tr><td class="paramname">precision_policy</td><td>The compute precision policy to use. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::shared_ptr&lt;BinaryOperation&lt;TDeviceType, TInput1, TInput2, TOutput&gt;&gt; The created binary operation. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If the type combination, device type, or operation name is invalid. </td></tr>
    <tr><td class="paramname">std::invalid_argument</td><td>If the context is null. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry_acf6c6e52c4c686b7547170bcd9857996_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_acf6c6e52c4c686b7547170bcd9857996_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_acf6c6e52c4c686b7547170bcd9857996_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_acf6c6e52c4c686b7547170bcd9857996_icgraph">
<area shape="rect" title="Create a binary operation based on the type information, device type, and operation name." alt="" coords="397,30,575,85"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Residual.html#a9cea89544af42d5db32ef20baeaa969c" title="Adds two tensors element&#45;wise." alt="" coords="201,5,349,45"/>
<area shape="poly" title=" " alt="" coords="383,44,349,39,350,34,384,39"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Residual.html#a64c3c2991d3e560499bf42842cdd2bdf" title="Creates an appropriate operation based on the connection type." alt="" coords="201,69,349,109"/>
<area shape="poly" title=" " alt="" coords="384,76,350,81,349,75,383,70"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Residual.html#ad8ee2a92d41cceaf6376fb0662173388" title="Performs the backward pass of the Residual connection." alt="" coords="5,5,153,45"/>
<area shape="poly" title=" " alt="" coords="187,28,154,28,154,23,187,23"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Residual.html#a84724fe8e4505ba4bfbc76be4bacf221" title="Constructs a new Residual module with a device name." alt="" coords="5,69,153,109"/>
<area shape="poly" title=" " alt="" coords="187,92,154,92,154,87,187,87"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Residual.html#aa688280c3ec68030b734a7a1054839cb" title="Constructs a new Residual module with a provided device context." alt="" coords="5,133,153,173"/>
<area shape="poly" title=" " alt="" coords="202,116,142,136,140,131,200,111"/>
</map>
</div>

</div>
</div>
<a id="a8bcbbd6e474b44727458887b4685f43e" name="a8bcbbd6e474b44727458887b4685f43e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bcbbd6e474b44727458887b4685f43e">&#9670;&#160;</a></span>createUnaryOperation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType, typename TInput , typename TOutput &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html">UnaryOperation</a>&lt; TDeviceType, TInput, TOutput &gt; &gt; Mila::Dnn::Compute::OperationRegistry::createUnaryOperation </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>operation_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a unary operation based on the type information, device type, and operation name. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TDeviceType</td><td>The device type for the operation (defaults to CUDA). </td></tr>
    <tr><td class="paramname">TInput</td><td>The input tensor element type. </td></tr>
    <tr><td class="paramname">TOutput</td><td>The output tensor element type (defaults to TInput). </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation_name</td><td>The name of the operation. </td></tr>
    <tr><td class="paramname">context</td><td>The device context to use for the operation. </td></tr>
    <tr><td class="paramname">precision_policy</td><td>The compute precision policy to use. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::shared_ptr&lt;UnaryOperation&lt;TDeviceType, TInput, TOutput&gt;&gt; The created unary operation. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If the type combination, device type, or operation name is invalid. </td></tr>
    <tr><td class="paramname">std::invalid_argument</td><td>If the context is null. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a8bcbbd6e474b44727458887b4685f43e_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a8bcbbd6e474b44727458887b4685f43e_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a8bcbbd6e474b44727458887b4685f43e_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a8bcbbd6e474b44727458887b4685f43e_icgraph">
<area shape="rect" title="Create a unary operation based on the type information, device type, and operation name." alt="" coords="555,385,729,440"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Gelu.html#aaaac79a17eafdd5d51bd0302c023052b" title="Initializes the appropriate GELU operation implementation." alt="" coords="272,55,507,80"/>
<area shape="poly" title=" " alt="" coords="623,373,577,271,544,213,505,158,457,114,411,82,414,78,460,110,509,155,548,210,582,269,628,371"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Linear.html#a90ab295e91a2bfaf2759c239315ee1b5" title="Creates the appropriate Linear operation based on the current device context." alt="" coords="319,169,459,209"/>
<area shape="poly" title=" " alt="" coords="602,378,505,287,414,211,418,207,508,283,605,374"/>
<area shape="rect" href="classMila_1_1Dnn_1_1MultiHeadAttention.html#aa582f04abff968b547719d6a31320e5a" title="Creates the appropriate attention operation for the current device." alt="" coords="280,297,499,337"/>
<area shape="poly" title=" " alt="" coords="556,383,442,339,444,334,558,378"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Softmax.html#a2c842bf3891bcb72f3e495ba2a6526a6" title="Creates the appropriate softmax operation for the current device." alt="" coords="316,393,463,433"/>
<area shape="poly" title=" " alt="" coords="541,415,463,415,463,410,541,410"/>
<area shape="rect" href="classMila_1_1Dnn_1_1CrossEntropy.html#ab6174e6ecfd871e8b998118110a6a91c" title="Creates the appropriate cross entropy operation for the current device." alt="" coords="300,489,479,529"/>
<area shape="poly" title=" " alt="" coords="558,447,444,491,442,486,556,442"/>
<area shape="rect" href="classMila_1_1Dnn_1_1LayerNorm.html#a25b5ec6b9949754ba93bad41693d6d06" title="Creates the appropriate Layer Normalization operation based on the current device context." alt="" coords="307,617,471,657"/>
<area shape="poly" title=" " alt="" coords="605,452,508,543,418,619,414,615,505,539,602,448"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Dropout.html#a90482512ba2256cd59c9ec2c8651add9" title="Creates the appropriate Dropout operation based on the current device context." alt="" coords="317,745,461,785"/>
<area shape="poly" title=" " alt="" coords="628,454,581,556,548,615,509,670,466,713,423,747,420,742,462,709,505,667,543,612,577,554,623,452"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Gelu.html#a4063fb9a76fae0f96f5145fcd99fd854" title="Constructs a Gelu module using device name and configuration." alt="" coords="35,5,195,31"/>
<area shape="poly" title=" " alt="" coords="304,55,186,33,187,28,305,50"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Gelu.html#a7a3e4f8007a867ea499fdd0534f78526" title="Constructs a Gelu module with an existing device context and configuration." alt="" coords="35,55,195,80"/>
<area shape="poly" title=" " alt="" coords="258,70,195,70,195,65,258,65"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Linear.html#a7d2592ef7cffc2fcbca2a0391d2d6c24" title="Constructs a new Linear module with a device name." alt="" coords="45,105,185,145"/>
<area shape="poly" title=" " alt="" coords="305,172,184,143,186,138,306,167"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Linear.html#a160506d377a764b33f1f33be9502b93a" title="Constructs a new Linear module with a provided device context." alt="" coords="45,169,185,209"/>
<area shape="poly" title=" " alt="" coords="306,191,185,191,185,186,306,186"/>
<area shape="rect" href="classMila_1_1Dnn_1_1MultiHeadAttention.html#a205a226fb09b4c4b083e60e1d4b4311a" title="Constructs a new MultiHeadAttention module with a device name." alt="" coords="5,233,224,273"/>
<area shape="poly" title=" " alt="" coords="289,296,200,275,202,270,290,291"/>
<area shape="rect" href="classMila_1_1Dnn_1_1MultiHeadAttention.html#a2184c5fdc3dffb5dbbe2ba3f00ed48a9" title="Constructs a new MultiHeadAttention module with a provided device context." alt="" coords="5,297,224,337"/>
<area shape="poly" title=" " alt="" coords="266,319,224,319,224,314,266,314"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Softmax.html#a0dfba728e7d60d978cf816f25e5cd2e7" title="Constructs a new Softmax module with a device name." alt="" coords="41,361,188,401"/>
<area shape="poly" title=" " alt="" coords="302,405,188,392,188,386,303,400"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Softmax.html#a6900764a7a23399c3e5e92058b8d2092" title="Constructs a new Softmax module with a provided device context." alt="" coords="41,425,188,465"/>
<area shape="poly" title=" " alt="" coords="303,425,188,439,188,434,302,420"/>
<area shape="rect" href="classMila_1_1Dnn_1_1CrossEntropy.html#a23d8eac6c8330b05931be0f4294548a1" title="Constructs a new CrossEntropy module with a device name." alt="" coords="25,489,204,529"/>
<area shape="poly" title=" " alt="" coords="286,511,204,511,204,506,286,506"/>
<area shape="rect" href="classMila_1_1Dnn_1_1CrossEntropy.html#a839a9539c0ba7487f4ba4b191302f7c6" title="Constructs a new CrossEntropy module with a provided device context." alt="" coords="25,553,204,593"/>
<area shape="poly" title=" " alt="" coords="290,534,202,555,200,550,289,529"/>
<area shape="rect" href="classMila_1_1Dnn_1_1LayerNorm.html#a5639928c52cd01656e74b6872572932b" title="Constructs a new LayerNorm module with a device name." alt="" coords="33,617,197,657"/>
<area shape="poly" title=" " alt="" coords="293,639,197,639,197,634,293,634"/>
<area shape="rect" href="classMila_1_1Dnn_1_1LayerNorm.html#a8bdc4bd7c381f42304cfe1257402df98" title="Constructs a new LayerNorm module with a provided device context." alt="" coords="33,681,197,721"/>
<area shape="poly" title=" " alt="" coords="294,661,198,684,196,679,293,656"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Dropout.html#a1a5f39ab42459dbcac239112a0206b44" title="Constructs a new Dropout module with a device name." alt="" coords="43,745,187,785"/>
<area shape="poly" title=" " alt="" coords="304,767,187,767,187,762,304,762"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Dropout.html#a704e5622fd5fa1a9d9a14a1f705debe2" title="Constructs a new Dropout module with a provided device context." alt="" coords="43,809,187,849"/>
<area shape="poly" title=" " alt="" coords="305,787,187,815,186,809,304,782"/>
</map>
</div>

</div>
</div>
<a id="a2f844c971dfea81c0b37bd94dc5f0f19" name="a2f844c971dfea81c0b37bd94dc5f0f19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f844c971dfea81c0b37bd94dc5f0f19">&#9670;&#160;</a></span>findFusedMatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1FusedOpMeta.html">FusedOpMeta</a> &gt; Mila::Dnn::Compute::OperationRegistry::findFusedMatch </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>child_types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a>&#160;</td>
          <td class="paramname"><em>device_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::type_index&#160;</td>
          <td class="paramname"><em>precision_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>variant</em> = <code>&quot;Default&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find a fused operation match for a sequence of module types. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">child_types</td><td>The sequence of module types to match. </td></tr>
    <tr><td class="paramname">device_type</td><td>The device type. </td></tr>
    <tr><td class="paramname">precision_type</td><td>The precision type. </td></tr>
    <tr><td class="paramname">variant</td><td>The variant of the operation (defaults to "Default"). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::optional&lt;FusedOpMeta&gt; The matched fused operation metadata if found, or nullopt if no match. </dd></dl>

</div>
</div>
<a id="a56e3658d8b09dd388ca379aefcdeb17f" name="a56e3658d8b09dd388ca379aefcdeb17f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56e3658d8b09dd388ca379aefcdeb17f">&#9670;&#160;</a></span>instance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html">OperationRegistry</a> &amp; Mila::Dnn::Compute::OperationRegistry::instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the singleton instance of the <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html" title="A registry for operations that can be created based on operation names, type information,...">OperationRegistry</a>. </p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html" title="A registry for operations that can be created based on operation names, type information,...">OperationRegistry</a>&amp; The singleton instance. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a56e3658d8b09dd388ca379aefcdeb17f_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a56e3658d8b09dd388ca379aefcdeb17f_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a56e3658d8b09dd388ca379aefcdeb17f_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a56e3658d8b09dd388ca379aefcdeb17f_icgraph">
<area shape="rect" title="Get the singleton instance of the OperationRegistry." alt="" coords="949,1150,1100,1205"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Residual.html#a9cea89544af42d5db32ef20baeaa969c" title="Adds two tensors element&#45;wise." alt="" coords="698,29,846,69"/>
<area shape="poly" title=" " alt="" coords="1021,1136,1020,925,1016,778,1007,619,992,460,970,314,956,250,939,193,921,145,899,108,875,85,845,69,848,65,878,81,903,105,925,143,945,191,961,248,975,313,997,460,1012,619,1021,778,1025,925,1027,1136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Gelu.html#aaaac79a17eafdd5d51bd0302c023052b" title="Initializes the appropriate GELU operation implementation." alt="" coords="655,119,889,145"/>
<area shape="poly" title=" " alt="" coords="1020,1136,1013,947,993,677,978,538,957,408,931,300,916,257,899,223,879,198,855,177,804,147,806,143,858,172,883,194,904,220,921,255,936,298,963,407,983,537,999,677,1018,947,1025,1136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Linear.html#a90ab295e91a2bfaf2759c239315ee1b5" title="Creates the appropriate Linear operation based on the current device context." alt="" coords="702,233,842,273"/>
<area shape="poly" title=" " alt="" coords="1019,1136,1008,970,986,738,970,619,950,509,927,417,913,380,899,351,882,327,860,307,814,276,817,271,863,303,886,324,904,348,918,378,932,415,956,508,975,618,991,738,1013,969,1024,1136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1MultiHeadAttention.html#aa582f04abff968b547719d6a31320e5a" title="Creates the appropriate attention operation for the current device." alt="" coords="663,361,881,401"/>
<area shape="poly" title=" " alt="" coords="1018,1137,1004,994,980,800,964,701,945,610,923,533,899,479,881,455,859,435,813,404,816,399,863,431,885,452,904,476,928,532,950,609,969,700,985,799,1009,993,1023,1136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Residual.html#a64c3c2991d3e560499bf42842cdd2bdf" title="Creates an appropriate operation based on the connection type." alt="" coords="698,489,846,529"/>
<area shape="poly" title=" " alt="" coords="1021,1136,1018,1036,1002,899,986,824,965,748,936,675,899,607,881,583,859,563,812,532,815,527,862,559,885,580,904,604,941,673,970,747,992,823,1007,898,1023,1036,1027,1136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Softmax.html#a2c842bf3891bcb72f3e495ba2a6526a6" title="Creates the appropriate softmax operation for the current device." alt="" coords="699,617,845,657"/>
<area shape="poly" title=" " alt="" coords="1016,1137,1002,1027,978,888,962,818,943,756,923,705,899,671,874,654,845,644,846,639,877,649,903,667,927,703,948,754,967,817,983,887,1007,1026,1022,1136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1CrossEntropy.html#ab6174e6ecfd871e8b998118110a6a91c" title="Creates the appropriate cross entropy operation for the current device." alt="" coords="683,681,861,721"/>
<area shape="poly" title=" " alt="" coords="1015,1137,998,1040,973,920,939,807,920,764,899,735,882,722,861,713,863,708,884,717,903,731,925,762,944,805,978,918,1004,1039,1020,1136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1LayerNorm.html#a25b5ec6b9949754ba93bad41693d6d06" title="Creates the appropriate Layer Normalization operation based on the current device context." alt="" coords="690,745,854,785"/>
<area shape="poly" title=" " alt="" coords="1020,1136,1013,1064,995,973,979,925,959,879,932,837,900,799,878,785,853,775,855,770,881,780,903,795,937,833,963,877,984,923,1000,971,1018,1063,1025,1136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Dropout.html#a90482512ba2256cd59c9ec2c8651add9" title="Creates the appropriate Dropout operation based on the current device context." alt="" coords="700,809,844,849"/>
<area shape="poly" title=" " alt="" coords="1017,1137,1006,1076,985,1002,970,964,951,927,928,893,900,863,873,847,843,837,845,832,876,842,903,859,932,890,956,924,975,961,991,1000,1012,1075,1022,1136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuCrossEntropyOpRegistrar.html#ae884ceef79f28161784a86be5c634efd" title="Registers the CpuCrossEntropyOp operation with the OperationRegistry." alt="" coords="663,874,881,929"/>
<area shape="poly" title=" " alt="" coords="1011,1138,996,1092,973,1039,941,987,921,963,900,942,880,929,883,925,903,938,925,959,945,984,977,1037,1001,1090,1016,1136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuEncoderOpRegistrar.html#a8b726011718dc64c51779c47dbc217ee" title="Registers the CpuEncoderOp operation with the OperationRegistry." alt="" coords="680,953,864,1007"/>
<area shape="poly" title=" " alt="" coords="1000,1139,959,1078,931,1047,900,1021,863,1002,865,997,903,1016,935,1043,963,1074,1005,1136"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuGeluOpRegistrar.html#a7c19336fcafa55000c7b944692e59f7c" title="Registers the CpuGeluOp operation with the OperationRegistry." alt="" coords="691,1031,853,1086"/>
<area shape="poly" title=" " alt="" coords="975,1144,939,1121,900,1100,853,1082,854,1077,902,1095,942,1116,978,1140"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuLayerNormOpRegistrar.html#af28cfe56875726c1d731b947e24a5575" title="Registers the CpuLayerNormOp operation with the OperationRegistry." alt="" coords="670,1110,874,1165"/>
<area shape="poly" title=" " alt="" coords="935,1166,874,1156,875,1151,936,1161"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOpRegistrar.html#aaadc17d3d5a5ddfe5efc20ad8c1e1666" title="Registers the CpuLinearOp operation with the OperationRegistry." alt="" coords="686,1189,858,1243"/>
<area shape="poly" title=" " alt="" coords="936,1194,859,1205,858,1200,935,1188"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuMultiHeadAttentionOpRegistrar.html#a9bcf4f4316cc0912e78073e2137a46a0" title="Registers the CpuMultiHeadAttention operation with the OperationRegistry." alt="" coords="643,1267,901,1322"/>
<area shape="poly" title=" " alt="" coords="976,1215,903,1257,871,1270,869,1265,900,1252,973,1210"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuResidualOpRegistrar.html#a4b0d8316c349abf09cdbe2dbdfa8fb61" title="Registers the CpuResidualOp operation with the OperationRegistry." alt="" coords="678,1346,866,1401"/>
<area shape="poly" title=" " alt="" coords="1004,1219,962,1279,934,1309,903,1336,867,1354,865,1349,900,1331,931,1305,958,1275,1000,1216"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuSoftmaxOpRegistrar.html#a4ad56aa913fb3608ff72ac8c12cd04c7" title="Registers the CpuSoftmaxOp operation with the OperationRegistry." alt="" coords="679,1425,865,1479"/>
<area shape="poly" title=" " alt="" coords="1015,1219,1000,1264,977,1317,945,1369,903,1414,867,1435,864,1431,900,1410,940,1366,972,1314,995,1262,1010,1217"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaEncoderOpRegistrar.html#a76bdb404ec3dccc2711fb44030d1ea6a" title="Registers the CudaEncoderOp operation with the OperationRegistry." alt="" coords="676,1503,868,1558"/>
<area shape="poly" title=" " alt="" coords="1021,1219,1010,1279,989,1353,973,1391,954,1428,931,1462,903,1493,870,1514,867,1510,900,1489,927,1459,949,1425,968,1388,984,1351,1005,1278,1016,1218"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaGeluOpRegistrar.html#a0a5eb859f50e2df31f3dbdac4b01bdce" title="Registers the CudaGeluOp operation with the OperationRegistry." alt="" coords="687,1582,857,1637"/>
<area shape="poly" title=" " alt="" coords="1025,1219,1018,1293,1000,1388,984,1437,963,1486,937,1531,903,1571,882,1587,859,1598,857,1593,880,1583,899,1567,932,1528,958,1483,979,1435,994,1386,1013,1293,1020,1218"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaLayerNormOpRegistrar.html#a54db614adb235692ddf32f60418df6cf" title="Registers the CudaLayerNormOp operation with the OperationRegistry." alt="" coords="666,1661,878,1715"/>
<area shape="poly" title=" " alt="" coords="1020,1219,1004,1321,979,1449,945,1570,925,1617,903,1650,880,1667,877,1663,899,1646,921,1615,940,1568,974,1448,999,1320,1015,1218"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaLinearOpRegistrar.html#abf077739f35a65e85910de6e7ed133cc" title="Registers the CudaLinearOp operation with the OperationRegistry." alt="" coords="682,1739,862,1794"/>
<area shape="poly" title=" " alt="" coords="1022,1219,1009,1336,985,1488,969,1564,950,1632,928,1689,903,1728,885,1744,864,1755,861,1750,882,1739,899,1725,923,1687,945,1631,963,1562,979,1487,1003,1335,1017,1218"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaMultiHeadAttentionOpRegistrar.html#aea4ab7e93a215ddd19057ba143fb9039" title="Registers the CudaMultiHeadAttentionOp operation with the OperationRegistry." alt="" coords="667,1818,877,1873"/>
<area shape="poly" title=" " alt="" coords="1023,1218,1012,1351,990,1526,974,1615,954,1695,931,1761,918,1787,903,1807,879,1826,876,1822,899,1803,913,1784,926,1759,949,1693,969,1613,985,1525,1007,1350,1018,1218"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOpRegistrar.html#a43606bb268c5e9ae6e0a60498a9f4e3d" title="Registers the CudaResidualOp operation with the OperationRegistry." alt="" coords="674,1897,870,1951"/>
<area shape="poly" title=" " alt="" coords="1024,1218,1015,1365,995,1565,979,1665,959,1757,934,1833,919,1863,903,1886,889,1899,872,1909,869,1904,886,1895,899,1882,915,1860,929,1831,954,1756,974,1664,990,1564,1010,1365,1019,1218"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaSoftmaxOpRegistrar.html#a2c9df32d01c008a0c819232d2d80c59e" title="Registers the CudaSoftmaxOp operation with the OperationRegistry." alt="" coords="675,1975,869,2030"/>
<area shape="poly" title=" " alt="" coords="1025,1219,1018,1380,1000,1603,984,1716,964,1820,937,1905,921,1939,903,1964,888,1978,871,1988,868,1984,885,1974,899,1961,916,1936,932,1903,958,1818,979,1715,995,1602,1013,1380,1020,1218"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1FusedSoftmaxCrossEntropyOpRegistrar.html#a52d25759b0fbde1854c8212317c6d5aa" title="Registers the FusedSoftmaxCrossEntropyOp operation with the OperationRegistry." alt="" coords="658,2054,886,2109"/>
<area shape="poly" title=" " alt="" coords="1026,1219,1021,1394,1005,1641,989,1767,968,1882,940,1977,923,2014,903,2043,888,2057,885,2053,899,2040,918,2012,935,1975,963,1881,984,1766,999,1640,1016,1394,1020,1218"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaMatMulBiasGeluOpRegistrar.html#a6e56d1bb3b6b684c0925f9b46286f86a" title="Registers the CudaMatMulBiasGeluOp operation with the OperationRegistry." alt="" coords="649,2133,895,2187"/>
<area shape="poly" title=" " alt="" coords="1026,1219,1024,1409,1019,1539,1010,1679,995,1818,973,1945,959,2001,943,2050,924,2091,903,2123,892,2134,888,2130,899,2120,920,2089,938,2048,954,2000,968,1944,989,1817,1004,1679,1014,1539,1019,1409,1021,1219"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Residual.html#ad8ee2a92d41cceaf6376fb0662173388" title="Performs the backward pass of the Residual connection." alt="" coords="411,5,559,45"/>
<area shape="poly" title=" " alt="" coords="684,45,560,34,560,29,684,39"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Gelu.html#a4063fb9a76fae0f96f5145fcd99fd854" title="Constructs a Gelu module using device name and configuration." alt="" coords="405,70,565,95"/>
<area shape="poly" title=" " alt="" coords="684,120,560,98,561,93,685,114"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Gelu.html#a7a3e4f8007a867ea499fdd0534f78526" title="Constructs a Gelu module with an existing device context and configuration." alt="" coords="405,119,565,145"/>
<area shape="poly" title=" " alt="" coords="641,135,566,135,566,129,641,129"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Linear.html#a7d2592ef7cffc2fcbca2a0391d2d6c24" title="Constructs a new Linear module with a device name." alt="" coords="415,169,555,209"/>
<area shape="poly" title=" " alt="" coords="688,237,555,208,556,202,689,232"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Linear.html#a160506d377a764b33f1f33be9502b93a" title="Constructs a new Linear module with a provided device context." alt="" coords="415,233,555,273"/>
<area shape="poly" title=" " alt="" coords="689,256,556,256,556,251,689,251"/>
<area shape="rect" href="classMila_1_1Dnn_1_1MultiHeadAttention.html#a205a226fb09b4c4b083e60e1d4b4311a" title="Constructs a new MultiHeadAttention module with a device name." alt="" coords="376,297,595,337"/>
<area shape="poly" title=" " alt="" coords="668,361,575,340,576,335,669,356"/>
<area shape="rect" href="classMila_1_1Dnn_1_1MultiHeadAttention.html#a2184c5fdc3dffb5dbbe2ba3f00ed48a9" title="Constructs a new MultiHeadAttention module with a provided device context." alt="" coords="376,361,595,401"/>
<area shape="poly" title=" " alt="" coords="649,384,595,384,595,379,649,379"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Residual.html#a84724fe8e4505ba4bfbc76be4bacf221" title="Constructs a new Residual module with a device name." alt="" coords="411,425,559,465"/>
<area shape="poly" title=" " alt="" coords="684,493,559,464,560,459,685,487"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Residual.html#aa688280c3ec68030b734a7a1054839cb" title="Constructs a new Residual module with a provided device context." alt="" coords="411,489,559,529"/>
<area shape="poly" title=" " alt="" coords="684,512,560,512,560,507,684,507"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Softmax.html#a0dfba728e7d60d978cf816f25e5cd2e7" title="Constructs a new Softmax module with a device name." alt="" coords="412,553,559,593"/>
<area shape="poly" title=" " alt="" coords="685,621,559,592,560,587,686,615"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Softmax.html#a6900764a7a23399c3e5e92058b8d2092" title="Constructs a new Softmax module with a provided device context." alt="" coords="412,617,559,657"/>
<area shape="poly" title=" " alt="" coords="685,640,559,640,559,635,685,635"/>
<area shape="rect" href="classMila_1_1Dnn_1_1CrossEntropy.html#a23d8eac6c8330b05931be0f4294548a1" title="Constructs a new CrossEntropy module with a device name." alt="" coords="396,681,575,721"/>
<area shape="poly" title=" " alt="" coords="669,704,575,704,575,699,669,699"/>
<area shape="rect" href="classMila_1_1Dnn_1_1CrossEntropy.html#a839a9539c0ba7487f4ba4b191302f7c6" title="Constructs a new CrossEntropy module with a provided device context." alt="" coords="396,745,575,785"/>
<area shape="poly" title=" " alt="" coords="670,727,576,748,574,743,669,722"/>
<area shape="rect" href="classMila_1_1Dnn_1_1LayerNorm.html#a5639928c52cd01656e74b6872572932b" title="Constructs a new LayerNorm module with a device name." alt="" coords="403,809,567,849"/>
<area shape="poly" title=" " alt="" coords="677,789,568,814,567,808,676,784"/>
<area shape="rect" href="classMila_1_1Dnn_1_1LayerNorm.html#a8bdc4bd7c381f42304cfe1257402df98" title="Constructs a new LayerNorm module with a provided device context." alt="" coords="403,873,567,913"/>
<area shape="poly" title=" " alt="" coords="678,783,644,800,629,814,621,830,612,847,596,863,569,878,567,873,593,859,608,844,616,828,625,811,641,795,676,778"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Dropout.html#a1a5f39ab42459dbcac239112a0206b44" title="Constructs a new Dropout module with a device name." alt="" coords="413,937,557,977"/>
<area shape="poly" title=" " alt="" coords="688,844,644,864,629,878,621,894,612,911,596,928,559,946,556,941,593,923,608,908,616,892,625,875,641,859,685,839"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Dropout.html#a704e5622fd5fa1a9d9a14a1f705debe2" title="Constructs a new Dropout module with a provided device context." alt="" coords="413,1001,557,1041"/>
<area shape="poly" title=" " alt="" coords="688,841,665,850,644,863,632,878,625,893,621,925,617,958,610,975,596,991,579,1004,559,1013,557,1008,576,999,593,987,605,972,612,957,616,925,620,892,627,875,641,859,662,845,686,836"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationsRegistrar.html#a8a24b4f953b5946b39d47eeb0f6d457b" title="Initialize the compute operations." alt="" coords="405,1503,565,1558"/>
<area shape="poly" title=" " alt="" coords="669,1003,644,1021,598,1077,562,1142,535,1211,515,1282,502,1349,494,1411,489,1503,484,1503,489,1411,497,1348,510,1280,530,1210,557,1140,594,1074,641,1017,666,999"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationsRegistrar.html#ae14b3144cca6b6fb56bdcb1ba1eaed39" title="Get the singleton instance of OperationsRegistrar." alt="" coords="168,1503,328,1558"/>
<area shape="poly" title=" " alt="" coords="392,1533,328,1533,328,1528,392,1528"/>
<area shape="poly" title=" " alt="" coords="278,1492,267,1485,248,1482,232,1484,222,1489,217,1495,217,1503,212,1503,212,1493,218,1484,230,1479,248,1477,269,1480,281,1487"/>
<area shape="rect" href="namespaceMila.html#a6d5b9d6d5b8d5e040c23e931f807bf86" title="Initializes the Mila framework." alt="" coords="5,1518,120,1543"/>
<area shape="poly" title=" " alt="" coords="154,1533,120,1533,120,1528,154,1528"/>
<area shape="poly" title=" " alt="" coords="679,1078,644,1099,604,1146,571,1200,545,1257,525,1316,501,1424,491,1504,486,1503,495,1424,520,1314,540,1255,566,1197,599,1143,641,1095,676,1073"/>
<area shape="poly" title=" " alt="" coords="659,1167,644,1178,609,1215,580,1257,555,1303,535,1349,508,1437,493,1504,488,1502,502,1436,530,1348,550,1301,575,1255,605,1212,641,1174,656,1163"/>
<area shape="poly" title=" " alt="" coords="675,1239,644,1257,615,1284,589,1316,546,1384,516,1451,497,1504,492,1502,511,1449,541,1382,584,1312,611,1281,641,1253,672,1234"/>
<area shape="poly" title=" " alt="" coords="652,1331,644,1335,598,1375,558,1421,526,1466,503,1504,499,1502,522,1463,554,1417,594,1371,641,1331,649,1326"/>
<area shape="poly" title=" " alt="" coords="666,1404,644,1414,574,1459,518,1505,514,1501,571,1455,641,1410,664,1400"/>
<area shape="poly" title=" " alt="" coords="666,1484,566,1511,565,1506,665,1479"/>
<area shape="poly" title=" " alt="" coords="662,1533,565,1533,565,1528,662,1528"/>
<area shape="poly" title=" " alt="" coords="673,1585,565,1555,566,1550,674,1580"/>
<area shape="poly" title=" " alt="" coords="657,1658,641,1650,572,1606,515,1560,518,1556,575,1602,644,1646,660,1653"/>
<area shape="poly" title=" " alt="" coords="668,1744,641,1729,594,1689,554,1643,522,1597,499,1559,504,1557,526,1594,558,1640,598,1685,644,1724,670,1739"/>
<area shape="poly" title=" " alt="" coords="653,1816,641,1807,611,1779,585,1748,542,1678,511,1612,492,1559,497,1557,516,1610,546,1676,589,1745,615,1776,644,1803,656,1812"/>
<area shape="poly" title=" " alt="" coords="660,1899,641,1886,605,1848,575,1806,551,1760,531,1713,503,1625,488,1559,494,1558,508,1624,536,1711,555,1757,580,1803,610,1845,644,1882,663,1895"/>
<area shape="poly" title=" " alt="" coords="661,1979,641,1965,600,1917,567,1863,540,1805,520,1747,496,1638,486,1559,491,1558,501,1637,526,1745,545,1803,571,1861,604,1914,644,1961,664,1975"/>
<area shape="poly" title=" " alt="" coords="643,2126,641,2123,611,2079,584,2014,560,1935,539,1848,506,1679,488,1559,493,1558,512,1678,544,1847,565,1933,589,2012,616,2076,645,2120,647,2122"/>
</map>
</div>

</div>
</div>
<a id="ad057a9748abb405fe69a58bbd7581b6b" name="ad057a9748abb405fe69a58bbd7581b6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad057a9748abb405fe69a58bbd7581b6b">&#9670;&#160;</a></span>registerBinaryOperation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType, typename TInput1 , typename TInput2 , typename TOutput &gt; <br />
requires ValidTensorTypes&lt;TInput1, TInput2&gt;&amp;&amp; ValidFloatTensorType&lt;TOutput&gt;</div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::OperationRegistry::registerBinaryOperation </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>operation_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1BinaryOperation.html">BinaryOperation</a>&lt; TDeviceType, TInput1, TInput2, TOutput &gt; &gt;(std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;, const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a> &amp;)&gt;&#160;</td>
          <td class="paramname"><em>creator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Register a binary operation creator for a specific device type. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TDeviceType</td><td>The device type for the operation (defaults to CUDA). </td></tr>
    <tr><td class="paramname">TInput1</td><td>The first input tensor element type. </td></tr>
    <tr><td class="paramname">TInput2</td><td>The second input tensor element type (defaults to TInput1). </td></tr>
    <tr><td class="paramname">TOutput</td><td>The output tensor element type (defaults to TInput2). </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation_name</td><td>The name of the operation. </td></tr>
    <tr><td class="paramname">creator</td><td>The function that creates the binary operation. </td></tr>
    <tr><td class="paramname">precision_policy</td><td>The compute precision policy to use (defaults to Auto). </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry_ad057a9748abb405fe69a58bbd7581b6b_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_ad057a9748abb405fe69a58bbd7581b6b_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_ad057a9748abb405fe69a58bbd7581b6b_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_ad057a9748abb405fe69a58bbd7581b6b_icgraph">
<area shape="rect" title="Register a binary operation creator for a specific device type." alt="" coords="860,84,1047,139"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuResidualOpRegistrar.html#a4b0d8316c349abf09cdbe2dbdfa8fb61" title="Registers the CpuResidualOp operation with the OperationRegistry." alt="" coords="604,5,792,60"/>
<area shape="poly" title=" " alt="" coords="850,82,787,63,788,58,852,77"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaResidualOpRegistrar.html#a43606bb268c5e9ae6e0a60498a9f4e3d" title="Registers the CudaResidualOp operation with the OperationRegistry." alt="" coords="600,84,796,139"/>
<area shape="poly" title=" " alt="" coords="846,114,796,114,796,109,846,109"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1FusedSoftmaxCrossEntropyOpRegistrar.html#a52d25759b0fbde1854c8212317c6d5aa" title="Registers the FusedSoftmaxCrossEntropyOp operation with the OperationRegistry." alt="" coords="584,163,812,217"/>
<area shape="poly" title=" " alt="" coords="852,145,788,165,787,160,850,140"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationsRegistrar.html#a8a24b4f953b5946b39d47eeb0f6d457b" title="Initialize the compute operations." alt="" coords="376,45,536,100"/>
<area shape="poly" title=" " alt="" coords="591,53,537,62,536,57,590,48"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationsRegistrar.html#ae14b3144cca6b6fb56bdcb1ba1eaed39" title="Get the singleton instance of OperationsRegistrar." alt="" coords="168,45,328,100"/>
<area shape="poly" title=" " alt="" coords="362,75,328,75,328,70,362,70"/>
<area shape="poly" title=" " alt="" coords="278,34,267,27,248,24,232,26,222,31,217,37,217,45,212,45,212,35,218,26,230,21,248,19,269,22,281,29"/>
<area shape="rect" href="namespaceMila.html#a6d5b9d6d5b8d5e040c23e931f807bf86" title="Initializes the Mila framework." alt="" coords="5,60,120,85"/>
<area shape="poly" title=" " alt="" coords="154,75,120,75,120,70,154,70"/>
<area shape="poly" title=" " alt="" coords="586,96,536,88,537,83,587,91"/>
</map>
</div>

</div>
</div>
<a id="aa911b14191b4358022447413a6a0260e" name="aa911b14191b4358022447413a6a0260e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa911b14191b4358022447413a6a0260e">&#9670;&#160;</a></span>registerFusedOperation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TOutput &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::OperationRegistry::registerFusedOperation </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#afe9b0f279fe9c233b4b5d795cb0ade11">OperationType</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>operation_types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fused_op_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>variant</em> = <code>&quot;Default&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Register a fused operation. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TOutput</td><td>The precision type of the operation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation_types</td><td>The sequence of operation types to fuse. </td></tr>
    <tr><td class="paramname">fused_op_name</td><td>The name of the fused operation. </td></tr>
    <tr><td class="paramname">variant</td><td>The variant of the operation (defaults to "Default"). </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry_aa911b14191b4358022447413a6a0260e_cgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_aa911b14191b4358022447413a6a0260e_cgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_aa911b14191b4358022447413a6a0260e_cgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_aa911b14191b4358022447413a6a0260e_cgraph">
<area shape="rect" title="Register a fused operation." alt="" coords="5,5,188,60"/>
<area shape="rect" href="namespaceMila_1_1Dnn_1_1Compute.html#a0fd8b0110b79e4bbc96ba4fbecb3fc96" title="Converts an operation type to its string representation." alt="" coords="236,13,411,53"/>
<area shape="poly" title=" " alt="" coords="188,30,222,30,222,35,188,35"/>
</map>
</div>

</div>
</div>
<a id="a9f6cf8041f25ce8339b221d28d4ef022" name="a9f6cf8041f25ce8339b221d28d4ef022"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f6cf8041f25ce8339b221d28d4ef022">&#9670;&#160;</a></span>registerUnaryOperation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html#a393d2d886886aa0215f25b307e4f71f4">DeviceType</a> TDeviceType = DeviceType::Cuda, typename TInput  = float, typename TOutput  = TInput&gt; <br />
requires ValidTensorType&lt;TInput&gt;&amp;&amp; ValidFloatTensorType&lt;TOutput&gt;</div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mila::Dnn::Compute::OperationRegistry::registerUnaryOperation </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>operation_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1UnaryOperation.html">UnaryOperation</a>&lt; TDeviceType, TInput, TOutput &gt; &gt;(std::shared_ptr&lt; <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1DeviceContext.html">DeviceContext</a> &gt;, const <a class="el" href="classMila_1_1Dnn_1_1ComponentConfig.html">ComponentConfig</a> &amp;)&gt;&#160;</td>
          <td class="paramname"><em>creator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Register a unary operation creator for a specific device type. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TDeviceType</td><td>The device type for the operation (defaults to CUDA). </td></tr>
    <tr><td class="paramname">TInput</td><td>The input tensor element type. </td></tr>
    <tr><td class="paramname">TOutput</td><td>The output tensor element type (defaults to TInput). </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation_name</td><td>The name of the operation. </td></tr>
    <tr><td class="paramname">creator</td><td>The function that creates the unary operation. </td></tr>
    <tr><td class="paramname">precision_policy</td><td>The compute precision policy to use (defaults to Auto). </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a9f6cf8041f25ce8339b221d28d4ef022_icgraph.png" border="0" usemap="#aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a9f6cf8041f25ce8339b221d28d4ef022_icgraph" alt=""/></div>
<map name="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a9f6cf8041f25ce8339b221d28d4ef022_icgraph" id="aclassMila_1_1Dnn_1_1Compute_1_1OperationRegistry_a9f6cf8041f25ce8339b221d28d4ef022_icgraph">
<area shape="rect" title="Register a unary operation creator for a specific device type." alt="" coords="891,477,1073,532"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuCrossEntropyOpRegistrar.html#ae884ceef79f28161784a86be5c634efd" title="Registers the CpuCrossEntropyOp operation with the OperationRegistry." alt="" coords="604,5,823,60"/>
<area shape="poly" title=" " alt="" coords="977,463,969,381,948,277,931,222,908,168,878,117,841,73,822,59,825,54,845,69,882,114,913,165,936,220,954,275,975,381,982,463"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuEncoderOpRegistrar.html#a8b726011718dc64c51779c47dbc217ee" title="Registers the CpuEncoderOp operation with the OperationRegistry." alt="" coords="621,84,805,139"/>
<area shape="poly" title=" " alt="" coords="974,464,962,396,938,312,920,268,899,226,872,187,841,152,824,139,804,130,807,125,827,135,844,148,877,183,903,223,925,266,943,310,967,395,979,463"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuGeluOpRegistrar.html#a7c19336fcafa55000c7b944692e59f7c" title="Registers the CpuGeluOp operation with the OperationRegistry." alt="" coords="632,163,795,217"/>
<area shape="poly" title=" " alt="" coords="969,465,952,411,926,348,890,285,867,256,841,231,819,216,794,206,796,201,821,211,844,227,871,252,894,282,931,346,957,410,974,463"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuLayerNormOpRegistrar.html#af28cfe56875726c1d731b947e24a5575" title="Registers the CpuLayerNormOp operation with the OperationRegistry." alt="" coords="611,241,815,296"/>
<area shape="poly" title=" " alt="" coords="961,466,941,429,914,386,880,345,841,309,814,294,817,290,844,305,884,341,918,383,945,426,965,464"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuLinearOpRegistrar.html#aaadc17d3d5a5ddfe5efc20ad8c1e1666" title="Registers the CpuLinearOp operation with the OperationRegistry." alt="" coords="627,320,799,375"/>
<area shape="poly" title=" " alt="" coords="944,469,897,427,841,388,799,370,801,365,844,384,901,423,948,465"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuMultiHeadAttentionOpRegistrar.html#a9bcf4f4316cc0912e78073e2137a46a0" title="Registers the CpuMultiHeadAttention operation with the OperationRegistry." alt="" coords="584,399,843,453"/>
<area shape="poly" title=" " alt="" coords="876,477,807,456,808,451,878,472"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CpuSoftmaxOpRegistrar.html#a4ad56aa913fb3608ff72ac8c12cd04c7" title="Registers the CpuSoftmaxOp operation with the OperationRegistry." alt="" coords="620,477,807,532"/>
<area shape="poly" title=" " alt="" coords="877,507,807,507,807,502,877,502"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaEncoderOpRegistrar.html#a76bdb404ec3dccc2711fb44030d1ea6a" title="Registers the CudaEncoderOp operation with the OperationRegistry." alt="" coords="617,556,809,611"/>
<area shape="poly" title=" " alt="" coords="878,538,808,558,807,553,876,533"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaGeluOpRegistrar.html#a0a5eb859f50e2df31f3dbdac4b01bdce" title="Registers the CudaGeluOp operation with the OperationRegistry." alt="" coords="628,635,799,689"/>
<area shape="poly" title=" " alt="" coords="947,543,901,585,844,624,800,643,798,639,841,620,897,581,944,539"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaLayerNormOpRegistrar.html#a54db614adb235692ddf32f60418df6cf" title="Registers the CudaLayerNormOp operation with the OperationRegistry." alt="" coords="607,713,819,768"/>
<area shape="poly" title=" " alt="" coords="965,546,945,583,918,625,884,667,844,703,821,717,818,712,841,699,880,663,913,622,940,580,960,543"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaLinearOpRegistrar.html#abf077739f35a65e85910de6e7ed133cc" title="Registers the CudaLinearOp operation with the OperationRegistry." alt="" coords="623,792,803,847"/>
<area shape="poly" title=" " alt="" coords="974,546,957,599,931,662,894,726,871,756,844,781,825,794,805,804,802,799,823,790,841,777,867,752,889,723,926,660,952,597,969,544"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaMultiHeadAttentionOpRegistrar.html#aea4ab7e93a215ddd19057ba143fb9039" title="Registers the CudaMultiHeadAttentionOp operation with the OperationRegistry." alt="" coords="608,871,819,925"/>
<area shape="poly" title=" " alt="" coords="979,546,966,614,942,698,925,742,903,785,876,825,844,860,821,877,818,872,841,856,872,821,898,782,920,740,937,696,961,613,974,545"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1CudaSoftmaxOpRegistrar.html#a2c9df32d01c008a0c819232d2d80c59e" title="Registers the CudaSoftmaxOp operation with the OperationRegistry." alt="" coords="616,949,811,1004"/>
<area shape="poly" title=" " alt="" coords="982,546,974,628,953,733,936,789,912,843,882,894,844,939,812,960,809,956,841,935,878,891,907,840,931,787,948,732,969,627,977,546"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationsRegistrar.html#a8a24b4f953b5946b39d47eeb0f6d457b" title="Initialize the compute operations." alt="" coords="376,517,536,572"/>
<area shape="poly" title=" " alt="" coords="610,135,586,152,551,194,522,242,501,294,485,347,467,445,461,517,455,517,461,444,480,345,496,292,518,240,546,191,582,148,607,130"/>
<area shape="rect" href="classMila_1_1Dnn_1_1Compute_1_1OperationsRegistrar.html#ae14b3144cca6b6fb56bdcb1ba1eaed39" title="Get the singleton instance of OperationsRegistrar." alt="" coords="168,517,328,572"/>
<area shape="poly" title=" " alt="" coords="362,547,328,547,328,542,362,542"/>
<area shape="poly" title=" " alt="" coords="278,506,267,499,248,496,232,498,222,503,217,509,217,517,212,517,212,507,218,498,230,493,248,491,269,494,281,501"/>
<area shape="rect" href="namespaceMila.html#a6d5b9d6d5b8d5e040c23e931f807bf86" title="Initializes the Mila framework." alt="" coords="5,532,120,557"/>
<area shape="poly" title=" " alt="" coords="154,547,120,547,120,542,154,542"/>
<area shape="poly" title=" " alt="" coords="620,209,586,231,556,263,531,300,511,340,495,381,474,458,463,517,458,516,468,457,490,379,506,338,527,297,552,260,582,227,617,205"/>
<area shape="poly" title=" " alt="" coords="601,299,586,309,562,332,540,358,506,416,482,472,467,518,462,516,477,470,501,414,536,355,558,329,582,305,597,295"/>
<area shape="poly" title=" " alt="" coords="616,372,585,388,550,418,519,453,475,518,470,515,515,449,546,414,583,384,613,368"/>
<area shape="poly" title=" " alt="" coords="600,461,585,467,538,492,497,519,494,515,536,488,583,462,598,456"/>
<area shape="poly" title=" " alt="" coords="606,524,537,535,536,530,606,519"/>
<area shape="poly" title=" " alt="" coords="604,570,536,559,537,554,604,564"/>
<area shape="poly" title=" " alt="" coords="614,637,583,624,537,600,495,574,498,570,539,596,585,620,616,632"/>
<area shape="poly" title=" " alt="" coords="593,710,582,703,547,673,515,639,471,574,475,571,520,635,550,669,586,698,596,705"/>
<area shape="poly" title=" " alt="" coords="609,798,582,781,558,758,537,732,502,674,477,618,462,573,467,571,482,616,507,672,541,729,562,755,586,777,612,794"/>
<area shape="poly" title=" " alt="" coords="594,870,582,860,552,827,527,790,507,750,491,709,469,632,458,573,463,572,474,631,496,707,512,748,532,787,556,824,586,856,598,865"/>
<area shape="poly" title=" " alt="" coords="602,953,582,939,547,896,518,847,497,796,480,743,462,645,455,573,461,572,467,644,486,742,502,794,523,845,551,893,586,935,605,949"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a0236156236cdf9972ba6ae141390be8b" name="a0236156236cdf9972ba6ae141390be8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0236156236cdf9972ba6ae141390be8b">&#9670;&#160;</a></span>fused_ops_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structMila_1_1Dnn_1_1Compute_1_1FusedOpMeta.html">FusedOpMeta</a>&gt; Mila::Dnn::Compute::OperationRegistry::fused_ops_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>List of registered fused operations. </p>

</div>
</div>
<a id="a271d82a0984be86df2b331f015f5f1f7" name="a271d82a0984be86df2b331f015f5f1f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a271d82a0984be86df2b331f015f5f1f7">&#9670;&#160;</a></span>registry_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;<a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationRegistry_1_1TypeID.html">TypeID</a>, std::unordered_map&lt;std::string, <a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html#af86abf3e657f9b2824aa4c3727507658">GenericCreator</a>&gt;, <a class="el" href="structMila_1_1Dnn_1_1Compute_1_1OperationRegistry_1_1TypeIDHash.html">TypeIDHash</a>&gt; Mila::Dnn::Compute::OperationRegistry::registry_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Registry mapping type info to operations. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/runner/work/Mila/Mila/Mila/Src/Dnn/Compute/Operations/<a class="el" href="OperationRegistry_8ixx.html">OperationRegistry.ixx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceMila.html">Mila</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn.html">Dnn</a></li><li class="navelem"><a class="el" href="namespaceMila_1_1Dnn_1_1Compute.html">Compute</a></li><li class="navelem"><a class="el" href="classMila_1_1Dnn_1_1Compute_1_1OperationRegistry.html">OperationRegistry</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
